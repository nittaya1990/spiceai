---
source: crates/runtime/benches/bench.rs
description: "Query: select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\nfrom(select *\n     from (select item_sk,rank() over (order by rank_col asc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\n                 from store_sales ss1\n                 where ss_store_sk = 6\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n                                                  from store_sales\n                                                  where ss_store_sk = 6\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V1)V11\n     where rnk  < 11) asceding,\n    (select *\n     from (select item_sk,rank() over (order by rank_col desc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\n                 from store_sales ss1\n                 where ss_store_sk = 6\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\n                                                  from store_sales\n                                                  where ss_store_sk = 6\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V2)V21\n     where rnk  < 11) descending,\nitem i1,\nitem i2\nwhere asceding.rnk = descending.rnk\n  and i1.i_item_sk=asceding.item_sk\n  and i2.i_item_sk=descending.item_sk\norder by asceding.rnk\n LIMIT 100;\n"
snapshot_kind: text
---
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Sort: asceding.rnk ASC NULLS LAST, fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |   Projection: asceding.rnk, i1.i_product_name AS best_performing, i2.i_product_name AS worst_performing                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |     Inner Join: descending.item_sk = i2.i_item_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |       Projection: asceding.rnk, descending.item_sk, i1.i_product_name                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |         Inner Join: asceding.item_sk = i1.i_item_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |           Projection: asceding.item_sk, asceding.rnk, descending.item_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |             Inner Join: asceding.rnk = descending.rnk                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |               SubqueryAlias: asceding                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                 SubqueryAlias: V11                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                   Projection: V1.item_sk, rank() ORDER BY [V1.rank_col ASC NULLS LAST] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW AS rnk                                                                                                                                                                                                                                                                                                                                                                                |
|               |                     Filter: rank() ORDER BY [V1.rank_col ASC NULLS LAST] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW < UInt64(11)                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                       Projection: V1.item_sk, rank() ORDER BY [V1.rank_col ASC NULLS LAST] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                         WindowAggr: windowExpr=[[rank() ORDER BY [V1.rank_col ASC NULLS LAST] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]                                                                                                                                                                                                                                                                                                                                                                              |
|               |                           SubqueryAlias: V1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                             Projection: ss1.ss_item_sk AS item_sk, avg(ss1.ss_net_profit) AS rank_col                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                               Filter: CAST(avg(ss1.ss_net_profit) AS Decimal128(30, 15)) > CAST(Float64(0.9) * __scalar_sq_1.rank_col AS Decimal128(30, 15))                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                 Left Join:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                   Aggregate: groupBy=[[ss1.ss_item_sk]], aggr=[[avg(ss1.ss_net_profit)]]                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                     SubqueryAlias: ss1                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                       Projection: store_sales.ss_item_sk, store_sales.ss_net_profit                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                         BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                           Filter: store_sales.ss_store_sk = Int32(6)                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                             TableScan: store_sales projection=[ss_item_sk, ss_store_sk, ss_net_profit]                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                   SubqueryAlias: __scalar_sq_1                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                     Projection: CAST(avg(store_sales.ss_net_profit) AS rank_col AS Float64)                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                       Aggregate: groupBy=[[store_sales.ss_store_sk]], aggr=[[avg(store_sales.ss_net_profit)]]                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                         Projection: store_sales.ss_store_sk, store_sales.ss_net_profit                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                           BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                             Filter: store_sales.ss_store_sk = Int32(6) AND store_sales.ss_hdemo_sk IS NULL                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                               TableScan: store_sales projection=[ss_hdemo_sk, ss_store_sk, ss_net_profit]                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |               SubqueryAlias: descending                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                 SubqueryAlias: V21                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                   Projection: V2.item_sk, rank() ORDER BY [V2.rank_col DESC NULLS FIRST] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW AS rnk                                                                                                                                                                                                                                                                                                                                                                              |
|               |                     Filter: rank() ORDER BY [V2.rank_col DESC NULLS FIRST] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW < UInt64(11)                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                       Projection: V2.item_sk, rank() ORDER BY [V2.rank_col DESC NULLS FIRST] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                         WindowAggr: windowExpr=[[rank() ORDER BY [V2.rank_col DESC NULLS FIRST] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]                                                                                                                                                                                                                                                                                                                                                                            |
|               |                           SubqueryAlias: V2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                             Projection: ss1.ss_item_sk AS item_sk, avg(ss1.ss_net_profit) AS rank_col                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                               Filter: CAST(avg(ss1.ss_net_profit) AS Decimal128(30, 15)) > CAST(Float64(0.9) * __scalar_sq_2.rank_col AS Decimal128(30, 15))                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                 Left Join:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                   Aggregate: groupBy=[[ss1.ss_item_sk]], aggr=[[avg(ss1.ss_net_profit)]]                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                     SubqueryAlias: ss1                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                       Projection: store_sales.ss_item_sk, store_sales.ss_net_profit                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                         BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                           Filter: store_sales.ss_store_sk = Int32(6)                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                             TableScan: store_sales projection=[ss_item_sk, ss_store_sk, ss_net_profit]                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                   SubqueryAlias: __scalar_sq_2                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                     Projection: CAST(avg(store_sales.ss_net_profit) AS rank_col AS Float64)                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                       Aggregate: groupBy=[[store_sales.ss_store_sk]], aggr=[[avg(store_sales.ss_net_profit)]]                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                         Projection: store_sales.ss_store_sk, store_sales.ss_net_profit                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                           BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                             Filter: store_sales.ss_store_sk = Int32(6) AND store_sales.ss_hdemo_sk IS NULL                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                               TableScan: store_sales projection=[ss_hdemo_sk, ss_store_sk, ss_net_profit]                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |           SubqueryAlias: i1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |             BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |               TableScan: item projection=[i_item_sk, i_product_name]                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |       SubqueryAlias: i2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |         BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |           TableScan: item projection=[i_item_sk, i_product_name]                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| physical_plan | SortPreservingMergeExec: [rnk@0 ASC NULLS LAST], fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |   SortExec: TopK(fetch=100), expr=[rnk@0 ASC NULLS LAST], preserve_partitioning=[true]                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |     ProjectionExec: expr=[rnk@0 as rnk, i_product_name@1 as best_performing, i_product_name@2 as worst_performing]                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(item_sk@1, i_item_sk@0)], projection=[rnk@0, i_product_name@2, i_product_name@4]                                                                                                                                                                                                                                                                                                                                                                                 |
|               |           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |             RepartitionExec: partitioning=Hash([item_sk@1], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                 HashJoinExec: mode=Partitioned, join_type=Inner, on=[(item_sk@0, i_item_sk@0)], projection=[rnk@1, item_sk@2, i_product_name@4]                                                                                                                                                                                                                                                                                                                                                                                |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                     RepartitionExec: partitioning=Hash([item_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(rnk@1, rnk@1)], projection=[item_sk@0, rnk@1, item_sk@2]                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                             RepartitionExec: partitioning=Hash([rnk@1], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                               ProjectionExec: expr=[item_sk@0 as item_sk, rank() ORDER BY [V1.rank_col ASC NULLS LAST] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@1 as rnk]                                                                                                                                                                                                                                                                                                                                             |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                   FilterExec: rank() ORDER BY [V1.rank_col ASC NULLS LAST] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@1 < 11                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                       ProjectionExec: expr=[item_sk@0 as item_sk, rank() ORDER BY [V1.rank_col ASC NULLS LAST] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@2 as rank() ORDER BY [V1.rank_col ASC NULLS LAST] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]                                                                                                                                                                                                                                          |
|               |                                         BoundedWindowAggExec: wdw=[rank() ORDER BY [V1.rank_col ASC NULLS LAST] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Ok(Field { name: "rank() ORDER BY [V1.rank_col ASC NULLS LAST] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW", data_type: UInt64, nullable: false, dict_id: 0, dict_is_ordered: false, metadata: {} }), frame: WindowFrame { units: Range, start_bound: Preceding(Decimal128(None,11,6)), end_bound: CurrentRow, is_causal: false }], mode=[Sorted]     |
|               |                                           SortPreservingMergeExec: [rank_col@1 ASC NULLS LAST]                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                             SortExec: expr=[rank_col@1 ASC NULLS LAST], preserve_partitioning=[true]                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                               ProjectionExec: expr=[ss_item_sk@0 as item_sk, avg(ss1.ss_net_profit)@1 as rank_col]                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                   FilterExec: CAST(avg(ss1.ss_net_profit)@1 AS Decimal128(30, 15)) > CAST(0.9 * rank_col@2 AS Decimal128(30, 15)), projection=[ss_item_sk@0, avg(ss1.ss_net_profit)@1]                                                                                                                                                                                                                                                                                                         |
|               |                                                     NestedLoopJoinExec: join_type=Left                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                       CoalescePartitionsExec                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                         AggregateExec: mode=FinalPartitioned, gby=[ss_item_sk@0 as ss_item_sk], aggr=[avg(ss1.ss_net_profit)]                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                             RepartitionExec: partitioning=Hash([ss_item_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                               AggregateExec: mode=Partial, gby=[ss_item_sk@0 as ss_item_sk], aggr=[avg(ss1.ss_net_profit)]                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                                 ProjectionExec: expr=[ss_item_sk@0 as ss_item_sk, ss_net_profit@2 as ss_net_profit]                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                                                   BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                                                       FilterExec: ss_store_sk@1 = 6                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                                                         SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                                           RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                                             MemoryExec: partitions=1, partition_sizes=[352]                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                       ProjectionExec: expr=[CAST(avg(store_sales.ss_net_profit)@1 AS Float64) as rank_col]                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                         AggregateExec: mode=FinalPartitioned, gby=[ss_store_sk@0 as ss_store_sk], aggr=[avg(store_sales.ss_net_profit)], ordering_mode=Sorted                                                                                                                                                                                                                                                                                                                                  |
|               |                                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                             RepartitionExec: partitioning=Hash([ss_store_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                               AggregateExec: mode=Partial, gby=[ss_store_sk@0 as ss_store_sk], aggr=[avg(store_sales.ss_net_profit)], ordering_mode=Sorted                                                                                                                                                                                                                                                                                                                                     |
|               |                                                                 ProjectionExec: expr=[ss_store_sk@1 as ss_store_sk, ss_net_profit@2 as ss_net_profit]                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                                   BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                                                       FilterExec: ss_store_sk@1 = 6 AND ss_hdemo_sk@0 IS NULL                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                                         SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                                           RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                                             MemoryExec: partitions=1, partition_sizes=[352]                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                             RepartitionExec: partitioning=Hash([rnk@1], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                               ProjectionExec: expr=[item_sk@0 as item_sk, rank() ORDER BY [V2.rank_col DESC NULLS FIRST] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@1 as rnk]                                                                                                                                                                                                                                                                                                                                           |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                   FilterExec: rank() ORDER BY [V2.rank_col DESC NULLS FIRST] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@1 < 11                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                       ProjectionExec: expr=[item_sk@0 as item_sk, rank() ORDER BY [V2.rank_col DESC NULLS FIRST] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@2 as rank() ORDER BY [V2.rank_col DESC NULLS FIRST] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]                                                                                                                                                                                                                                      |
|               |                                         BoundedWindowAggExec: wdw=[rank() ORDER BY [V2.rank_col DESC NULLS FIRST] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Ok(Field { name: "rank() ORDER BY [V2.rank_col DESC NULLS FIRST] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW", data_type: UInt64, nullable: false, dict_id: 0, dict_is_ordered: false, metadata: {} }), frame: WindowFrame { units: Range, start_bound: Preceding(Decimal128(None,11,6)), end_bound: CurrentRow, is_causal: false }], mode=[Sorted] |
|               |                                           SortPreservingMergeExec: [rank_col@1 DESC]                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                             SortExec: expr=[rank_col@1 DESC], preserve_partitioning=[true]                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                               ProjectionExec: expr=[ss_item_sk@0 as item_sk, avg(ss1.ss_net_profit)@1 as rank_col]                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                   FilterExec: CAST(avg(ss1.ss_net_profit)@1 AS Decimal128(30, 15)) > CAST(0.9 * rank_col@2 AS Decimal128(30, 15)), projection=[ss_item_sk@0, avg(ss1.ss_net_profit)@1]                                                                                                                                                                                                                                                                                                         |
|               |                                                     NestedLoopJoinExec: join_type=Left                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                       CoalescePartitionsExec                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                         AggregateExec: mode=FinalPartitioned, gby=[ss_item_sk@0 as ss_item_sk], aggr=[avg(ss1.ss_net_profit)]                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                             RepartitionExec: partitioning=Hash([ss_item_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                               AggregateExec: mode=Partial, gby=[ss_item_sk@0 as ss_item_sk], aggr=[avg(ss1.ss_net_profit)]                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                                 ProjectionExec: expr=[ss_item_sk@0 as ss_item_sk, ss_net_profit@2 as ss_net_profit]                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                                                   BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                                                       FilterExec: ss_store_sk@1 = 6                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                                                         SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                                           RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                                             MemoryExec: partitions=1, partition_sizes=[352]                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                       ProjectionExec: expr=[CAST(avg(store_sales.ss_net_profit)@1 AS Float64) as rank_col]                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                         AggregateExec: mode=FinalPartitioned, gby=[ss_store_sk@0 as ss_store_sk], aggr=[avg(store_sales.ss_net_profit)], ordering_mode=Sorted                                                                                                                                                                                                                                                                                                                                  |
|               |                                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                             RepartitionExec: partitioning=Hash([ss_store_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                               AggregateExec: mode=Partial, gby=[ss_store_sk@0 as ss_store_sk], aggr=[avg(store_sales.ss_net_profit)], ordering_mode=Sorted                                                                                                                                                                                                                                                                                                                                     |
|               |                                                                 ProjectionExec: expr=[ss_store_sk@1 as ss_store_sk, ss_net_profit@2 as ss_net_profit]                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                                   BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                                                       FilterExec: ss_store_sk@1 = 6 AND ss_hdemo_sk@0 IS NULL                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                                         SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                                           RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                                             MemoryExec: partitions=1, partition_sizes=[352]                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                     RepartitionExec: partitioning=Hash([i_item_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                       BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                         SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                           RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                             MemoryExec: partitions=1, partition_sizes=[3]                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |             RepartitionExec: partitioning=Hash([i_item_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |               BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                 SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                     MemoryExec: partitions=1, partition_sizes=[3]                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
