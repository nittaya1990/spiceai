---
source: crates/runtime/benches/bench.rs
description: "Query: with my_customers as (\n select distinct c_customer_sk\n        , c_current_addr_sk\n from\n        ( select cs_sold_date_sk sold_date_sk,\n                 cs_bill_customer_sk customer_sk,\n                 cs_item_sk item_sk\n          from   catalog_sales\n          union all\n          select ws_sold_date_sk sold_date_sk,\n                 ws_bill_customer_sk customer_sk,\n                 ws_item_sk item_sk\n          from   web_sales\n         ) cs_or_ws_sales,\n         item,\n         date_dim,\n         customer\n where   sold_date_sk = d_date_sk\n         and item_sk = i_item_sk\n         and i_category = 'Men'\n         and i_class = 'shirts'\n         and c_customer_sk = cs_or_ws_sales.customer_sk\n         and d_moy = 4\n         and d_year = 1998\n )\n , my_revenue as (\n select c_customer_sk,\n        sum(ss_ext_sales_price) as revenue\n from   my_customers,\n        store_sales,\n        customer_address,\n        store,\n        date_dim\n where  c_current_addr_sk = ca_address_sk\n        and ca_county = s_county\n        and ca_state = s_state\n        and ss_sold_date_sk = d_date_sk\n        and c_customer_sk = ss_customer_sk\n        and d_month_seq between (select distinct d_month_seq+1\n                                 from   date_dim where d_year = 1998 and d_moy = 4)\n                           and  (select distinct d_month_seq+3\n                                 from   date_dim where d_year = 1998 and d_moy = 4)\n group by c_customer_sk\n )\n , segments as\n (select cast((revenue/50) as int) as segment\n  from   my_revenue\n )\n  select  segment, count(*) as num_customers, segment*50 as segment_base\n from segments\n group by segment\n order by segment, num_customers\n  LIMIT 100;\n"
snapshot_kind: text
---
+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                |
+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Sort: segments.segment ASC NULLS LAST, num_customers ASC NULLS LAST, fetch=100                                                                                                                                                                      |
|               |   Projection: segments.segment, count(*) AS num_customers, CAST(segments.segment AS Int64) * Int64(50) AS segment_base                                                                                                                              |
|               |     Aggregate: groupBy=[[segments.segment]], aggr=[[count(Int64(1)) AS count(*)]]                                                                                                                                                                   |
|               |       SubqueryAlias: segments                                                                                                                                                                                                                       |
|               |         Projection: CAST(my_revenue.revenue / Decimal128(Some(50),20,0) AS Int32) AS segment                                                                                                                                                        |
|               |           SubqueryAlias: my_revenue                                                                                                                                                                                                                 |
|               |             Projection: sum(store_sales.ss_ext_sales_price) AS revenue                                                                                                                                                                              |
|               |               Aggregate: groupBy=[[my_customers.c_customer_sk]], aggr=[[sum(store_sales.ss_ext_sales_price)]]                                                                                                                                       |
|               |                 Projection: my_customers.c_customer_sk, store_sales.ss_ext_sales_price                                                                                                                                                              |
|               |                   Inner Join:  Filter: CAST(date_dim.d_month_seq AS Int64) <= __scalar_sq_2.date_dim.d_month_seq + Int64(3)                                                                                                                         |
|               |                     Projection: my_customers.c_customer_sk, store_sales.ss_ext_sales_price, date_dim.d_month_seq                                                                                                                                    |
|               |                       Inner Join:  Filter: CAST(date_dim.d_month_seq AS Int64) >= __scalar_sq_1.date_dim.d_month_seq + Int64(1)                                                                                                                     |
|               |                         Projection: my_customers.c_customer_sk, store_sales.ss_ext_sales_price, date_dim.d_month_seq                                                                                                                                |
|               |                           Inner Join: store_sales.ss_sold_date_sk = date_dim.d_date_sk                                                                                                                                                              |
|               |                             Projection: my_customers.c_customer_sk, store_sales.ss_sold_date_sk, store_sales.ss_ext_sales_price                                                                                                                     |
|               |                               Inner Join: customer_address.ca_county = store.s_county, customer_address.ca_state = store.s_state                                                                                                                    |
|               |                                 Projection: my_customers.c_customer_sk, store_sales.ss_sold_date_sk, store_sales.ss_ext_sales_price, customer_address.ca_county, customer_address.ca_state                                                          |
|               |                                   Inner Join: my_customers.c_current_addr_sk = customer_address.ca_address_sk                                                                                                                                       |
|               |                                     Projection: my_customers.c_customer_sk, my_customers.c_current_addr_sk, store_sales.ss_sold_date_sk, store_sales.ss_ext_sales_price                                                                             |
|               |                                       Inner Join: my_customers.c_customer_sk = store_sales.ss_customer_sk                                                                                                                                           |
|               |                                         SubqueryAlias: my_customers                                                                                                                                                                                 |
|               |                                           Aggregate: groupBy=[[customer.c_customer_sk, customer.c_current_addr_sk]], aggr=[[]]                                                                                                                      |
|               |                                             Projection: customer.c_customer_sk, customer.c_current_addr_sk                                                                                                                                          |
|               |                                               Inner Join: cs_or_ws_sales.customer_sk = customer.c_customer_sk                                                                                                                                       |
|               |                                                 Projection: cs_or_ws_sales.customer_sk                                                                                                                                                              |
|               |                                                   Inner Join: cs_or_ws_sales.sold_date_sk = date_dim.d_date_sk                                                                                                                                      |
|               |                                                     Projection: cs_or_ws_sales.sold_date_sk, cs_or_ws_sales.customer_sk                                                                                                                             |
|               |                                                       Inner Join: cs_or_ws_sales.item_sk = item.i_item_sk                                                                                                                                           |
|               |                                                         SubqueryAlias: cs_or_ws_sales                                                                                                                                                               |
|               |                                                           Union                                                                                                                                                                                     |
|               |                                                             Projection: catalog_sales.cs_sold_date_sk AS sold_date_sk, catalog_sales.cs_bill_customer_sk AS customer_sk, catalog_sales.cs_item_sk AS item_sk                                        |
|               |                                                               BytesProcessedNode                                                                                                                                                                    |
|               |                                                                 TableScan: catalog_sales projection=[cs_sold_date_sk, cs_bill_customer_sk, cs_item_sk]                                                                                              |
|               |                                                             Projection: web_sales.ws_sold_date_sk AS sold_date_sk, web_sales.ws_bill_customer_sk AS customer_sk, web_sales.ws_item_sk AS item_sk                                                    |
|               |                                                               BytesProcessedNode                                                                                                                                                                    |
|               |                                                                 TableScan: web_sales projection=[ws_sold_date_sk, ws_item_sk, ws_bill_customer_sk]                                                                                                  |
|               |                                                         Projection: item.i_item_sk                                                                                                                                                                  |
|               |                                                           BytesProcessedNode                                                                                                                                                                        |
|               |                                                             Filter: item.i_category = LargeUtf8("Men") AND item.i_class = LargeUtf8("shirts")                                                                                                       |
|               |                                                               TableScan: item projection=[i_item_sk, i_class, i_category]                                                                                                                           |
|               |                                                     Projection: date_dim.d_date_sk                                                                                                                                                                  |
|               |                                                       BytesProcessedNode                                                                                                                                                                            |
|               |                                                         Filter: date_dim.d_moy = Int32(4) AND date_dim.d_year = Int32(1998)                                                                                                                         |
|               |                                                           TableScan: date_dim projection=[d_date_sk, d_year, d_moy]                                                                                                                                 |
|               |                                                 BytesProcessedNode                                                                                                                                                                                  |
|               |                                                   TableScan: customer projection=[c_customer_sk, c_current_addr_sk]                                                                                                                                 |
|               |                                         BytesProcessedNode                                                                                                                                                                                          |
|               |                                           TableScan: store_sales projection=[ss_sold_date_sk, ss_customer_sk, ss_ext_sales_price]                                                                                                                   |
|               |                                     BytesProcessedNode                                                                                                                                                                                              |
|               |                                       TableScan: customer_address projection=[ca_address_sk, ca_county, ca_state]                                                                                                                                   |
|               |                                 BytesProcessedNode                                                                                                                                                                                                  |
|               |                                   TableScan: store projection=[s_county, s_state]                                                                                                                                                                   |
|               |                             BytesProcessedNode                                                                                                                                                                                                      |
|               |                               TableScan: date_dim projection=[d_date_sk, d_month_seq]                                                                                                                                                               |
|               |                         SubqueryAlias: __scalar_sq_1                                                                                                                                                                                                |
|               |                           Aggregate: groupBy=[[date_dim.d_month_seq + Int64(1)]], aggr=[[]]                                                                                                                                                         |
|               |                             Projection: CAST(date_dim.d_month_seq AS Int64) + Int64(1)                                                                                                                                                              |
|               |                               BytesProcessedNode                                                                                                                                                                                                    |
|               |                                 Filter: date_dim.d_year = Int32(1998) AND date_dim.d_moy = Int32(4)                                                                                                                                                 |
|               |                                   TableScan: date_dim projection=[d_month_seq, d_year, d_moy]                                                                                                                                                       |
|               |                     SubqueryAlias: __scalar_sq_2                                                                                                                                                                                                    |
|               |                       Aggregate: groupBy=[[date_dim.d_month_seq + Int64(3)]], aggr=[[]]                                                                                                                                                             |
|               |                         Projection: CAST(date_dim.d_month_seq AS Int64) + Int64(3)                                                                                                                                                                  |
|               |                           BytesProcessedNode                                                                                                                                                                                                        |
|               |                             Filter: date_dim.d_year = Int32(1998) AND date_dim.d_moy = Int32(4)                                                                                                                                                     |
|               |                               TableScan: date_dim projection=[d_month_seq, d_year, d_moy]                                                                                                                                                           |
| physical_plan | SortPreservingMergeExec: [segment@0 ASC NULLS LAST, num_customers@1 ASC NULLS LAST], fetch=100                                                                                                                                                      |
|               |   SortExec: TopK(fetch=100), expr=[segment@0 ASC NULLS LAST, num_customers@1 ASC NULLS LAST], preserve_partitioning=[true]                                                                                                                          |
|               |     ProjectionExec: expr=[segment@0 as segment, count(*)@1 as num_customers, CAST(segment@0 AS Int64) * 50 as segment_base]                                                                                                                         |
|               |       AggregateExec: mode=FinalPartitioned, gby=[segment@0 as segment], aggr=[count(*)]                                                                                                                                                             |
|               |         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                 |
|               |           RepartitionExec: partitioning=Hash([segment@0], 4), input_partitions=4                                                                                                                                                                    |
|               |             AggregateExec: mode=Partial, gby=[segment@0 as segment], aggr=[count(*)]                                                                                                                                                                |
|               |               ProjectionExec: expr=[CAST(sum(store_sales.ss_ext_sales_price)@1 / Some(50),20,0 AS Int32) as segment]                                                                                                                                |
|               |                 AggregateExec: mode=FinalPartitioned, gby=[c_customer_sk@0 as c_customer_sk], aggr=[sum(store_sales.ss_ext_sales_price)]                                                                                                            |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                       |
|               |                     RepartitionExec: partitioning=Hash([c_customer_sk@0], 4), input_partitions=4                                                                                                                                                    |
|               |                       AggregateExec: mode=Partial, gby=[c_customer_sk@0 as c_customer_sk], aggr=[sum(store_sales.ss_ext_sales_price)]                                                                                                               |
|               |                         ProjectionExec: expr=[c_customer_sk@0 as c_customer_sk, ss_ext_sales_price@1 as ss_ext_sales_price]                                                                                                                         |
|               |                           NestedLoopJoinExec: join_type=Inner, filter=CAST(d_month_seq@0 AS Int64) <= date_dim.d_month_seq + Int64(3)@1                                                                                                             |
|               |                             CoalescePartitionsExec                                                                                                                                                                                                  |
|               |                               ProjectionExec: expr=[c_customer_sk@0 as c_customer_sk, ss_ext_sales_price@1 as ss_ext_sales_price, d_month_seq@2 as d_month_seq]                                                                                     |
|               |                                 NestedLoopJoinExec: join_type=Inner, filter=CAST(d_month_seq@0 AS Int64) >= date_dim.d_month_seq + Int64(1)@1                                                                                                       |
|               |                                   CoalescePartitionsExec                                                                                                                                                                                            |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                     |
|               |                                       HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_sold_date_sk@1, d_date_sk@0)], projection=[c_customer_sk@0, ss_ext_sales_price@2, d_month_seq@4]                                                     |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                 |
|               |                                           RepartitionExec: partitioning=Hash([ss_sold_date_sk@1], 4), input_partitions=4                                                                                                                            |
|               |                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                             |
|               |                                               HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ca_county@3, s_county@0), (ca_state@4, s_state@1)], projection=[c_customer_sk@0, ss_sold_date_sk@1, ss_ext_sales_price@2]                       |
|               |                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                         |
|               |                                                   RepartitionExec: partitioning=Hash([ca_county@3, ca_state@4], 4), input_partitions=4                                                                                                              |
|               |                                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                     |
|               |                                                       HashJoinExec: mode=Partitioned, join_type=Inner, on=[(c_current_addr_sk@1, ca_address_sk@0)], projection=[c_customer_sk@0, ss_sold_date_sk@2, ss_ext_sales_price@3, ca_county@5, ca_state@6]  |
|               |                                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                 |
|               |                                                           RepartitionExec: partitioning=Hash([c_current_addr_sk@1], 4), input_partitions=4                                                                                                          |
|               |                                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                             |
|               |                                                               HashJoinExec: mode=Partitioned, join_type=Inner, on=[(c_customer_sk@0, ss_customer_sk@1)], projection=[c_customer_sk@0, c_current_addr_sk@1, ss_sold_date_sk@2, ss_ext_sales_price@4] |
|               |                                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                         |
|               |                                                                   RepartitionExec: partitioning=Hash([c_customer_sk@0], 4), input_partitions=4                                                                                                      |
|               |                                                                     AggregateExec: mode=FinalPartitioned, gby=[c_customer_sk@0 as c_customer_sk, c_current_addr_sk@1 as c_current_addr_sk], aggr=[]                                                 |
|               |                                                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                   |
|               |                                                                         RepartitionExec: partitioning=Hash([c_customer_sk@0, c_current_addr_sk@1], 4), input_partitions=4                                                                           |
|               |                                                                           AggregateExec: mode=Partial, gby=[c_customer_sk@0 as c_customer_sk, c_current_addr_sk@1 as c_current_addr_sk], aggr=[]                                                    |
|               |                                                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                             |
|               |                                                                               HashJoinExec: mode=Partitioned, join_type=Inner, on=[(customer_sk@0, c_customer_sk@0)], projection=[c_customer_sk@1, c_current_addr_sk@2]                             |
|               |                                                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                         |
|               |                                                                                   RepartitionExec: partitioning=Hash([customer_sk@0], 4), input_partitions=4                                                                                        |
|               |                                                                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                     |
|               |                                                                                       HashJoinExec: mode=Partitioned, join_type=Inner, on=[(sold_date_sk@0, d_date_sk@0)], projection=[customer_sk@1]                                               |
|               |                                                                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                 |
|               |                                                                                           RepartitionExec: partitioning=Hash([sold_date_sk@0], 4), input_partitions=4                                                                               |
|               |                                                                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                             |
|               |                                                                                               HashJoinExec: mode=Partitioned, join_type=Inner, on=[(item_sk@2, i_item_sk@0)], projection=[sold_date_sk@0, customer_sk@1]                            |
|               |                                                                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                         |
|               |                                                                                                   RepartitionExec: partitioning=Hash([item_sk@2], 4), input_partitions=8                                                                            |
|               |                                                                                                     UnionExec                                                                                                                                       |
|               |                                                                                                       ProjectionExec: expr=[cs_sold_date_sk@0 as sold_date_sk, cs_bill_customer_sk@1 as customer_sk, cs_item_sk@2 as item_sk]                       |
|               |                                                                                                         BytesProcessedExec                                                                                                                          |
|               |                                                                                                           SchemaCastScanExec                                                                                                                        |
|               |                                                                                                             RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                    |
|               |                                                                                                               MemoryExec: partitions=1, partition_sizes=[176]                                                                                       |
|               |                                                                                                       ProjectionExec: expr=[ws_sold_date_sk@0 as sold_date_sk, ws_bill_customer_sk@2 as customer_sk, ws_item_sk@1 as item_sk]                       |
|               |                                                                                                         BytesProcessedExec                                                                                                                          |
|               |                                                                                                           SchemaCastScanExec                                                                                                                        |
|               |                                                                                                             RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                    |
|               |                                                                                                               MemoryExec: partitions=1, partition_sizes=[88]                                                                                        |
|               |                                                                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                         |
|               |                                                                                                   RepartitionExec: partitioning=Hash([i_item_sk@0], 4), input_partitions=4                                                                          |
|               |                                                                                                     ProjectionExec: expr=[i_item_sk@0 as i_item_sk]                                                                                                 |
|               |                                                                                                       BytesProcessedExec                                                                                                                            |
|               |                                                                                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                 |
|               |                                                                                                           FilterExec: i_category@2 = Men AND i_class@1 = shirts                                                                                     |
|               |                                                                                                             SchemaCastScanExec                                                                                                                      |
|               |                                                                                                               RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                  |
|               |                                                                                                                 MemoryExec: partitions=1, partition_sizes=[3]                                                                                       |
|               |                                                                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                 |
|               |                                                                                           RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                  |
|               |                                                                                             ProjectionExec: expr=[d_date_sk@0 as d_date_sk]                                                                                                         |
|               |                                                                                               BytesProcessedExec                                                                                                                                    |
|               |                                                                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                         |
|               |                                                                                                   FilterExec: d_moy@2 = 4 AND d_year@1 = 1998                                                                                                       |
|               |                                                                                                     SchemaCastScanExec                                                                                                                              |
|               |                                                                                                       RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                          |
|               |                                                                                                         MemoryExec: partitions=1, partition_sizes=[9]                                                                                               |
|               |                                                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                         |
|               |                                                                                   RepartitionExec: partitioning=Hash([c_customer_sk@0], 4), input_partitions=4                                                                                      |
|               |                                                                                     BytesProcessedExec                                                                                                                                              |
|               |                                                                                       SchemaCastScanExec                                                                                                                                            |
|               |                                                                                         RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                        |
|               |                                                                                           MemoryExec: partitions=1, partition_sizes=[13]                                                                                                            |
|               |                                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                         |
|               |                                                                   RepartitionExec: partitioning=Hash([ss_customer_sk@1], 4), input_partitions=4                                                                                                     |
|               |                                                                     BytesProcessedExec                                                                                                                                                              |
|               |                                                                       SchemaCastScanExec                                                                                                                                                            |
|               |                                                                         RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                        |
|               |                                                                           MemoryExec: partitions=1, partition_sizes=[352]                                                                                                                           |
|               |                                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                 |
|               |                                                           RepartitionExec: partitioning=Hash([ca_address_sk@0], 4), input_partitions=4                                                                                                              |
|               |                                                             BytesProcessedExec                                                                                                                                                                      |
|               |                                                               SchemaCastScanExec                                                                                                                                                                    |
|               |                                                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                |
|               |                                                                   MemoryExec: partitions=1, partition_sizes=[7]                                                                                                                                     |
|               |                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                         |
|               |                                                   RepartitionExec: partitioning=Hash([s_county@0, s_state@1], 4), input_partitions=4                                                                                                                |
|               |                                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                            |
|               |                                                       BytesProcessedExec                                                                                                                                                                            |
|               |                                                         SchemaCastScanExec                                                                                                                                                                          |
|               |                                                           MemoryExec: partitions=1, partition_sizes=[1]                                                                                                                                             |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                 |
|               |                                           RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                  |
|               |                                             BytesProcessedExec                                                                                                                                                                                      |
|               |                                               SchemaCastScanExec                                                                                                                                                                                    |
|               |                                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                |
|               |                                                   MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                     |
|               |                                   AggregateExec: mode=FinalPartitioned, gby=[date_dim.d_month_seq + Int64(1)@0 as date_dim.d_month_seq + Int64(1)], aggr=[]                                                                                         |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                     |
|               |                                       RepartitionExec: partitioning=Hash([date_dim.d_month_seq + Int64(1)@0], 4), input_partitions=4                                                                                                                |
|               |                                         AggregateExec: mode=Partial, gby=[date_dim.d_month_seq + Int64(1)@0 as date_dim.d_month_seq + Int64(1)], aggr=[]                                                                                            |
|               |                                           ProjectionExec: expr=[CAST(d_month_seq@0 AS Int64) + 1 as date_dim.d_month_seq + Int64(1)]                                                                                                                |
|               |                                             BytesProcessedExec                                                                                                                                                                                      |
|               |                                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                           |
|               |                                                 FilterExec: d_year@1 = 1998 AND d_moy@2 = 4                                                                                                                                                         |
|               |                                                   SchemaCastScanExec                                                                                                                                                                                |
|               |                                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                            |
|               |                                                       MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                 |
|               |                             AggregateExec: mode=FinalPartitioned, gby=[date_dim.d_month_seq + Int64(3)@0 as date_dim.d_month_seq + Int64(3)], aggr=[]                                                                                               |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                           |
|               |                                 RepartitionExec: partitioning=Hash([date_dim.d_month_seq + Int64(3)@0], 4), input_partitions=4                                                                                                                      |
|               |                                   AggregateExec: mode=Partial, gby=[date_dim.d_month_seq + Int64(3)@0 as date_dim.d_month_seq + Int64(3)], aggr=[]                                                                                                  |
|               |                                     ProjectionExec: expr=[CAST(d_month_seq@0 AS Int64) + 3 as date_dim.d_month_seq + Int64(3)]                                                                                                                      |
|               |                                       BytesProcessedExec                                                                                                                                                                                            |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                 |
|               |                                           FilterExec: d_year@1 = 1998 AND d_moy@2 = 4                                                                                                                                                               |
|               |                                             SchemaCastScanExec                                                                                                                                                                                      |
|               |                                               RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                  |
|               |                                                 MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                       |
|               |                                                                                                                                                                                                                                                     |
+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
