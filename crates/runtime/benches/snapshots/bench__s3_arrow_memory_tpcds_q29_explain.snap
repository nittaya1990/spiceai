---
source: crates/runtime/benches/bench.rs
description: "Query: select\n     i_item_id\n    ,i_item_desc\n    ,s_store_id\n    ,s_store_name\n    ,stddev_samp(ss_quantity)        as store_sales_quantity\n    ,stddev_samp(sr_return_quantity) as store_returns_quantity\n    ,stddev_samp(cs_quantity)        as catalog_sales_quantity\n from\n    store_sales\n   ,store_returns\n   ,catalog_sales\n   ,date_dim             d1\n   ,date_dim             d2\n   ,date_dim             d3\n   ,store\n   ,item\n where\n     d1.d_moy               = 4\n and d1.d_year              = 1999\n and d1.d_date_sk           = ss_sold_date_sk\n and i_item_sk              = ss_item_sk\n and s_store_sk             = ss_store_sk\n and ss_customer_sk         = sr_customer_sk\n and ss_item_sk             = sr_item_sk\n and ss_ticket_number       = sr_ticket_number\n and sr_returned_date_sk    = d2.d_date_sk\n and d2.d_moy               between 4 and  4 + 3\n and d2.d_year              = 1999\n and sr_customer_sk         = cs_bill_customer_sk\n and sr_item_sk             = cs_item_sk\n and cs_sold_date_sk        = d3.d_date_sk\n and d3.d_year              in (1999,1999+1,1999+2)\n group by\n    i_item_id\n   ,i_item_desc\n   ,s_store_id\n   ,s_store_name\n order by\n    i_item_id\n   ,i_item_desc\n   ,s_store_id\n   ,s_store_name\n  LIMIT 100;\n"
snapshot_kind: text
---
+---------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                         |
+---------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Sort: item.i_item_id ASC NULLS LAST, item.i_item_desc ASC NULLS LAST, store.s_store_id ASC NULLS LAST, store.s_store_name ASC NULLS LAST, fetch=100                                                                                                                                                                                                                                          |
|               |   Projection: item.i_item_id, item.i_item_desc, store.s_store_id, store.s_store_name, stddev(store_sales.ss_quantity) AS store_sales_quantity, stddev(store_returns.sr_return_quantity) AS store_returns_quantity, stddev(catalog_sales.cs_quantity) AS catalog_sales_quantity                                                                                                               |
|               |     Aggregate: groupBy=[[item.i_item_id, item.i_item_desc, store.s_store_id, store.s_store_name]], aggr=[[stddev(CAST(store_sales.ss_quantity AS Float64)), stddev(CAST(store_returns.sr_return_quantity AS Float64)), stddev(CAST(catalog_sales.cs_quantity AS Float64))]]                                                                                                                  |
|               |       Projection: store_sales.ss_quantity, store_returns.sr_return_quantity, catalog_sales.cs_quantity, store.s_store_id, store.s_store_name, item.i_item_id, item.i_item_desc                                                                                                                                                                                                               |
|               |         Inner Join: store_sales.ss_item_sk = item.i_item_sk                                                                                                                                                                                                                                                                                                                                  |
|               |           Projection: store_sales.ss_item_sk, store_sales.ss_quantity, store_returns.sr_return_quantity, catalog_sales.cs_quantity, store.s_store_id, store.s_store_name                                                                                                                                                                                                                     |
|               |             Inner Join: store_sales.ss_store_sk = store.s_store_sk                                                                                                                                                                                                                                                                                                                           |
|               |               Projection: store_sales.ss_item_sk, store_sales.ss_store_sk, store_sales.ss_quantity, store_returns.sr_return_quantity, catalog_sales.cs_quantity                                                                                                                                                                                                                              |
|               |                 Inner Join: catalog_sales.cs_sold_date_sk = d3.d_date_sk                                                                                                                                                                                                                                                                                                                     |
|               |                   Projection: store_sales.ss_item_sk, store_sales.ss_store_sk, store_sales.ss_quantity, store_returns.sr_return_quantity, catalog_sales.cs_sold_date_sk, catalog_sales.cs_quantity                                                                                                                                                                                           |
|               |                     Inner Join: store_returns.sr_returned_date_sk = d2.d_date_sk                                                                                                                                                                                                                                                                                                             |
|               |                       Projection: store_sales.ss_item_sk, store_sales.ss_store_sk, store_sales.ss_quantity, store_returns.sr_returned_date_sk, store_returns.sr_return_quantity, catalog_sales.cs_sold_date_sk, catalog_sales.cs_quantity                                                                                                                                                    |
|               |                         Inner Join: store_sales.ss_sold_date_sk = d1.d_date_sk                                                                                                                                                                                                                                                                                                               |
|               |                           Projection: store_sales.ss_sold_date_sk, store_sales.ss_item_sk, store_sales.ss_store_sk, store_sales.ss_quantity, store_returns.sr_returned_date_sk, store_returns.sr_return_quantity, catalog_sales.cs_sold_date_sk, catalog_sales.cs_quantity                                                                                                                   |
|               |                             Inner Join: store_returns.sr_customer_sk = catalog_sales.cs_bill_customer_sk, store_returns.sr_item_sk = catalog_sales.cs_item_sk                                                                                                                                                                                                                                |
|               |                               Projection: store_sales.ss_sold_date_sk, store_sales.ss_item_sk, store_sales.ss_store_sk, store_sales.ss_quantity, store_returns.sr_returned_date_sk, store_returns.sr_item_sk, store_returns.sr_customer_sk, store_returns.sr_return_quantity                                                                                                                 |
|               |                                 Inner Join: store_sales.ss_customer_sk = store_returns.sr_customer_sk, store_sales.ss_item_sk = store_returns.sr_item_sk, store_sales.ss_ticket_number = store_returns.sr_ticket_number                                                                                                                                                                      |
|               |                                   BytesProcessedNode                                                                                                                                                                                                                                                                                                                                         |
|               |                                     TableScan: store_sales projection=[ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_store_sk, ss_ticket_number, ss_quantity]                                                                                                                                                                                                                              |
|               |                                   BytesProcessedNode                                                                                                                                                                                                                                                                                                                                         |
|               |                                     TableScan: store_returns projection=[sr_returned_date_sk, sr_item_sk, sr_customer_sk, sr_ticket_number, sr_return_quantity]                                                                                                                                                                                                                              |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                             |
|               |                                 TableScan: catalog_sales projection=[cs_sold_date_sk, cs_bill_customer_sk, cs_item_sk, cs_quantity]                                                                                                                                                                                                                                                          |
|               |                           SubqueryAlias: d1                                                                                                                                                                                                                                                                                                                                                  |
|               |                             Projection: date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                   |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                             |
|               |                                 Filter: date_dim.d_moy = Int32(4) AND date_dim.d_year = Int32(1999)                                                                                                                                                                                                                                                                                          |
|               |                                   TableScan: date_dim projection=[d_date_sk, d_year, d_moy]                                                                                                                                                                                                                                                                                                  |
|               |                       SubqueryAlias: d2                                                                                                                                                                                                                                                                                                                                                      |
|               |                         Projection: date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                       |
|               |                           BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                 |
|               |                             Filter: date_dim.d_moy >= Int32(4) AND date_dim.d_moy <= Int32(7) AND date_dim.d_year = Int32(1999)                                                                                                                                                                                                                                                              |
|               |                               TableScan: date_dim projection=[d_date_sk, d_year, d_moy]                                                                                                                                                                                                                                                                                                      |
|               |                   SubqueryAlias: d3                                                                                                                                                                                                                                                                                                                                                          |
|               |                     Projection: date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                           |
|               |                       BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                     |
|               |                         Filter: date_dim.d_year = Int32(1999) OR date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(2001)                                                                                                                                                                                                                                                              |
|               |                           TableScan: date_dim projection=[d_date_sk, d_year]                                                                                                                                                                                                                                                                                                                 |
|               |               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                             |
|               |                 TableScan: store projection=[s_store_sk, s_store_id, s_store_name]                                                                                                                                                                                                                                                                                                           |
|               |           BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                 |
|               |             TableScan: item projection=[i_item_sk, i_item_id, i_item_desc]                                                                                                                                                                                                                                                                                                                   |
| physical_plan | SortPreservingMergeExec: [i_item_id@0 ASC NULLS LAST, i_item_desc@1 ASC NULLS LAST, s_store_id@2 ASC NULLS LAST, s_store_name@3 ASC NULLS LAST], fetch=100                                                                                                                                                                                                                                   |
|               |   SortExec: TopK(fetch=100), expr=[i_item_id@0 ASC NULLS LAST, i_item_desc@1 ASC NULLS LAST, s_store_id@2 ASC NULLS LAST, s_store_name@3 ASC NULLS LAST], preserve_partitioning=[true]                                                                                                                                                                                                       |
|               |     ProjectionExec: expr=[i_item_id@0 as i_item_id, i_item_desc@1 as i_item_desc, s_store_id@2 as s_store_id, s_store_name@3 as s_store_name, stddev(store_sales.ss_quantity)@4 as store_sales_quantity, stddev(store_returns.sr_return_quantity)@5 as store_returns_quantity, stddev(catalog_sales.cs_quantity)@6 as catalog_sales_quantity]                                                |
|               |       AggregateExec: mode=FinalPartitioned, gby=[i_item_id@0 as i_item_id, i_item_desc@1 as i_item_desc, s_store_id@2 as s_store_id, s_store_name@3 as s_store_name], aggr=[stddev(store_sales.ss_quantity), stddev(store_returns.sr_return_quantity), stddev(catalog_sales.cs_quantity)]                                                                                                    |
|               |         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                          |
|               |           RepartitionExec: partitioning=Hash([i_item_id@0, i_item_desc@1, s_store_id@2, s_store_name@3], 4), input_partitions=4                                                                                                                                                                                                                                                              |
|               |             AggregateExec: mode=Partial, gby=[i_item_id@5 as i_item_id, i_item_desc@6 as i_item_desc, s_store_id@3 as s_store_id, s_store_name@4 as s_store_name], aggr=[stddev(store_sales.ss_quantity), stddev(store_returns.sr_return_quantity), stddev(catalog_sales.cs_quantity)]                                                                                                       |
|               |               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                    |
|               |                 HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_item_sk@0, i_item_sk@0)], projection=[ss_quantity@1, sr_return_quantity@2, cs_quantity@3, s_store_id@4, s_store_name@5, i_item_id@7, i_item_desc@8]                                                                                                                                                                 |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                |
|               |                     RepartitionExec: partitioning=Hash([ss_item_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                            |
|               |                         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_store_sk@1, s_store_sk@0)], projection=[ss_item_sk@0, ss_quantity@2, sr_return_quantity@3, cs_quantity@4, s_store_id@6, s_store_name@7]                                                                                                                                                                     |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                        |
|               |                             RepartitionExec: partitioning=Hash([ss_store_sk@1], 4), input_partitions=4                                                                                                                                                                                                                                                                                       |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                    |
|               |                                 HashJoinExec: mode=Partitioned, join_type=Inner, on=[(cs_sold_date_sk@4, d_date_sk@0)], projection=[ss_item_sk@0, ss_store_sk@1, ss_quantity@2, sr_return_quantity@3, cs_quantity@5]                                                                                                                                                                         |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                |
|               |                                     RepartitionExec: partitioning=Hash([cs_sold_date_sk@4], 4), input_partitions=4                                                                                                                                                                                                                                                                           |
|               |                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                            |
|               |                                         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(sr_returned_date_sk@3, d_date_sk@0)], projection=[ss_item_sk@0, ss_store_sk@1, ss_quantity@2, sr_return_quantity@4, cs_sold_date_sk@5, cs_quantity@6]                                                                                                                                          |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                        |
|               |                                             RepartitionExec: partitioning=Hash([sr_returned_date_sk@3], 4), input_partitions=4                                                                                                                                                                                                                                                               |
|               |                                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                    |
|               |                                                 HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_sold_date_sk@0, d_date_sk@0)], projection=[ss_item_sk@1, ss_store_sk@2, ss_quantity@3, sr_returned_date_sk@4, sr_return_quantity@5, cs_sold_date_sk@6, cs_quantity@7]                                                                                                               |
|               |                                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                |
|               |                                                     RepartitionExec: partitioning=Hash([ss_sold_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                           |
|               |                                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                            |
|               |                                                         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(sr_customer_sk@6, cs_bill_customer_sk@1), (sr_item_sk@5, cs_item_sk@2)], projection=[ss_sold_date_sk@0, ss_item_sk@1, ss_store_sk@2, ss_quantity@3, sr_returned_date_sk@4, sr_return_quantity@7, cs_sold_date_sk@8, cs_quantity@11]                                            |
|               |                                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                        |
|               |                                                             RepartitionExec: partitioning=Hash([sr_customer_sk@6, sr_item_sk@5], 4), input_partitions=4                                                                                                                                                                                                                                      |
|               |                                                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                    |
|               |                                                                 HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_customer_sk@2, sr_customer_sk@2), (ss_item_sk@1, sr_item_sk@1), (ss_ticket_number@4, sr_ticket_number@3)], projection=[ss_sold_date_sk@0, ss_item_sk@1, ss_store_sk@3, ss_quantity@5, sr_returned_date_sk@6, sr_item_sk@7, sr_customer_sk@8, sr_return_quantity@10] |
|               |                                                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                |
|               |                                                                     RepartitionExec: partitioning=Hash([ss_customer_sk@2, ss_item_sk@1, ss_ticket_number@4], 4), input_partitions=4                                                                                                                                                                                                          |
|               |                                                                       BytesProcessedExec                                                                                                                                                                                                                                                                                                     |
|               |                                                                         SchemaCastScanExec                                                                                                                                                                                                                                                                                                   |
|               |                                                                           RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                               |
|               |                                                                             MemoryExec: partitions=1, partition_sizes=[352]                                                                                                                                                                                                                                                                  |
|               |                                                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                |
|               |                                                                     RepartitionExec: partitioning=Hash([sr_customer_sk@2, sr_item_sk@1, sr_ticket_number@3], 4), input_partitions=4                                                                                                                                                                                                          |
|               |                                                                       BytesProcessedExec                                                                                                                                                                                                                                                                                                     |
|               |                                                                         SchemaCastScanExec                                                                                                                                                                                                                                                                                                   |
|               |                                                                           RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                               |
|               |                                                                             MemoryExec: partitions=1, partition_sizes=[36]                                                                                                                                                                                                                                                                   |
|               |                                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                        |
|               |                                                             RepartitionExec: partitioning=Hash([cs_bill_customer_sk@1, cs_item_sk@2], 4), input_partitions=4                                                                                                                                                                                                                                 |
|               |                                                               BytesProcessedExec                                                                                                                                                                                                                                                                                                             |
|               |                                                                 SchemaCastScanExec                                                                                                                                                                                                                                                                                                           |
|               |                                                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                       |
|               |                                                                     MemoryExec: partitions=1, partition_sizes=[176]                                                                                                                                                                                                                                                                          |
|               |                                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                |
|               |                                                     RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                 |
|               |                                                       ProjectionExec: expr=[d_date_sk@0 as d_date_sk]                                                                                                                                                                                                                                                                                        |
|               |                                                         BytesProcessedExec                                                                                                                                                                                                                                                                                                                   |
|               |                                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                        |
|               |                                                             FilterExec: d_moy@2 = 4 AND d_year@1 = 1999                                                                                                                                                                                                                                                                                      |
|               |                                                               SchemaCastScanExec                                                                                                                                                                                                                                                                                                             |
|               |                                                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                         |
|               |                                                                   MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                                                                                              |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                        |
|               |                                             RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                         |
|               |                                               ProjectionExec: expr=[d_date_sk@0 as d_date_sk]                                                                                                                                                                                                                                                                                                |
|               |                                                 BytesProcessedExec                                                                                                                                                                                                                                                                                                                           |
|               |                                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                |
|               |                                                     FilterExec: d_moy@2 >= 4 AND d_moy@2 <= 7 AND d_year@1 = 1999                                                                                                                                                                                                                                                                            |
|               |                                                       SchemaCastScanExec                                                                                                                                                                                                                                                                                                                     |
|               |                                                         RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                 |
|               |                                                           MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                                                                                                      |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                |
|               |                                     RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                 |
|               |                                       ProjectionExec: expr=[d_date_sk@0 as d_date_sk]                                                                                                                                                                                                                                                                                                        |
|               |                                         BytesProcessedExec                                                                                                                                                                                                                                                                                                                                   |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                        |
|               |                                             FilterExec: d_year@1 = 1999 OR d_year@1 = 2000 OR d_year@1 = 2001                                                                                                                                                                                                                                                                                |
|               |                                               SchemaCastScanExec                                                                                                                                                                                                                                                                                                                             |
|               |                                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                         |
|               |                                                   MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                                                                                                              |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                        |
|               |                             RepartitionExec: partitioning=Hash([s_store_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                        |
|               |                               RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                           |
|               |                                 BytesProcessedExec                                                                                                                                                                                                                                                                                                                                           |
|               |                                   SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                         |
|               |                                     MemoryExec: partitions=1, partition_sizes=[1]                                                                                                                                                                                                                                                                                                            |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                |
|               |                     RepartitionExec: partitioning=Hash([i_item_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                 |
|               |                       BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                     |
|               |                         SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                   |
|               |                           RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                               |
|               |                             MemoryExec: partitions=1, partition_sizes=[3]                                                                                                                                                                                                                                                                                                                    |
|               |                                                                                                                                                                                                                                                                                                                                                                                              |
+---------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
