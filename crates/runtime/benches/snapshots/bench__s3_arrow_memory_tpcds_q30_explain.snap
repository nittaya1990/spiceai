---
source: crates/runtime/benches/bench.rs
description: "Query: with customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state,\n \tsum(wr_return_amt) as ctr_total_return\n from web_returns\n     ,date_dim\n     ,customer_address\n where wr_returned_date_sk = d_date_sk\n   and d_year =2000\n   and wr_returning_addr_sk = ca_address_sk\n group by wr_returning_customer_sk\n         ,ca_state)\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n       ,c_last_review_date_sk,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'KS'\n       and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n                  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n                  ,c_last_review_date_sk,ctr_total_return\n LIMIT 100;\n"
snapshot_kind: text
---
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Sort: customer.c_customer_id ASC NULLS LAST, customer.c_salutation ASC NULLS LAST, customer.c_first_name ASC NULLS LAST, customer.c_last_name ASC NULLS LAST, customer.c_preferred_cust_flag ASC NULLS LAST, customer.c_birth_day ASC NULLS LAST, customer.c_birth_month ASC NULLS LAST, customer.c_birth_year ASC NULLS LAST, customer.c_birth_country ASC NULLS LAST, customer.c_login ASC NULLS LAST, customer.c_email_address ASC NULLS LAST, customer.c_last_review_date_sk ASC NULLS LAST, ctr1.ctr_total_return ASC NULLS LAST, fetch=100 |
|               |   Projection: customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, customer.c_preferred_cust_flag, customer.c_birth_day, customer.c_birth_month, customer.c_birth_year, customer.c_birth_country, customer.c_login, customer.c_email_address, customer.c_last_review_date_sk, ctr1.ctr_total_return                                                                                                                                                                                                       |
|               |     Inner Join: ctr1.ctr_state = __scalar_sq_1.ctr_state Filter: CAST(ctr1.ctr_total_return AS Decimal128(30, 15)) > __scalar_sq_1.avg(ctr2.ctr_total_return) * Float64(1.2)                                                                                                                                                                                                                                                                                                                                                                     |
|               |       Projection: ctr1.ctr_state, ctr1.ctr_total_return, customer.c_customer_id, customer.c_salutation, customer.c_first_name, customer.c_last_name, customer.c_preferred_cust_flag, customer.c_birth_day, customer.c_birth_month, customer.c_birth_year, customer.c_birth_country, customer.c_login, customer.c_email_address, customer.c_last_review_date_sk                                                                                                                                                                                   |
|               |         Inner Join: customer.c_current_addr_sk = customer_address.ca_address_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |           Projection: ctr1.ctr_state, ctr1.ctr_total_return, customer.c_customer_id, customer.c_current_addr_sk, customer.c_salutation, customer.c_first_name, customer.c_last_name, customer.c_preferred_cust_flag, customer.c_birth_day, customer.c_birth_month, customer.c_birth_year, customer.c_birth_country, customer.c_login, customer.c_email_address, customer.c_last_review_date_sk                                                                                                                                                   |
|               |             Inner Join: ctr1.ctr_customer_sk = customer.c_customer_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |               SubqueryAlias: ctr1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                 SubqueryAlias: customer_total_return                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                   Projection: web_returns.wr_returning_customer_sk AS ctr_customer_sk, customer_address.ca_state AS ctr_state, sum(web_returns.wr_return_amt) AS ctr_total_return                                                                                                                                                                                                                                                                                                                                                                |
|               |                     Aggregate: groupBy=[[web_returns.wr_returning_customer_sk, customer_address.ca_state]], aggr=[[sum(web_returns.wr_return_amt)]]                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                       Projection: web_returns.wr_returning_customer_sk, web_returns.wr_return_amt, customer_address.ca_state                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                         Inner Join: web_returns.wr_returning_addr_sk = customer_address.ca_address_sk                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                           Projection: web_returns.wr_returning_customer_sk, web_returns.wr_returning_addr_sk, web_returns.wr_return_amt                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                             Inner Join: web_returns.wr_returned_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                 TableScan: web_returns projection=[wr_returned_date_sk, wr_returning_customer_sk, wr_returning_addr_sk, wr_return_amt]                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                               Projection: date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                 BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                   Filter: date_dim.d_year = Int32(2000)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                     TableScan: date_dim projection=[d_date_sk, d_year]                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                           BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                             TableScan: customer_address projection=[ca_address_sk, ca_state]                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                 TableScan: customer projection=[c_customer_sk, c_customer_id, c_current_addr_sk, c_salutation, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_day, c_birth_month, c_birth_year, c_birth_country, c_login, c_email_address, c_last_review_date_sk]                                                                                                                                                                                                                                                                     |
|               |           Projection: customer_address.ca_address_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |             BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |               Filter: customer_address.ca_state = LargeUtf8("KS")                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                 TableScan: customer_address projection=[ca_address_sk, ca_state]                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |       SubqueryAlias: __scalar_sq_1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |         Projection: CAST(CAST(avg(ctr2.ctr_total_return) AS Float64) * Float64(1.2) AS Decimal128(30, 15)), ctr2.ctr_state                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |           Aggregate: groupBy=[[ctr2.ctr_state]], aggr=[[avg(ctr2.ctr_total_return)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |             SubqueryAlias: ctr2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |               SubqueryAlias: customer_total_return                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                 Projection: customer_address.ca_state AS ctr_state, sum(web_returns.wr_return_amt) AS ctr_total_return                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                   Aggregate: groupBy=[[web_returns.wr_returning_customer_sk, customer_address.ca_state]], aggr=[[sum(web_returns.wr_return_amt)]]                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                     Projection: web_returns.wr_returning_customer_sk, web_returns.wr_return_amt, customer_address.ca_state                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                       Inner Join: web_returns.wr_returning_addr_sk = customer_address.ca_address_sk                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                         Projection: web_returns.wr_returning_customer_sk, web_returns.wr_returning_addr_sk, web_returns.wr_return_amt                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                           Inner Join: web_returns.wr_returned_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                             BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                               TableScan: web_returns projection=[wr_returned_date_sk, wr_returning_customer_sk, wr_returning_addr_sk, wr_return_amt]                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                             Projection: date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                 Filter: date_dim.d_year = Int32(2000)                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                   TableScan: date_dim projection=[d_date_sk, d_year]                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                         BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                           TableScan: customer_address projection=[ca_address_sk, ca_state]                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| physical_plan | SortPreservingMergeExec: [c_customer_id@0 ASC NULLS LAST, c_salutation@1 ASC NULLS LAST, c_first_name@2 ASC NULLS LAST, c_last_name@3 ASC NULLS LAST, c_preferred_cust_flag@4 ASC NULLS LAST, c_birth_day@5 ASC NULLS LAST, c_birth_month@6 ASC NULLS LAST, c_birth_year@7 ASC NULLS LAST, c_birth_country@8 ASC NULLS LAST, c_login@9 ASC NULLS LAST, c_email_address@10 ASC NULLS LAST, c_last_review_date_sk@11 ASC NULLS LAST, ctr_total_return@12 ASC NULLS LAST], fetch=100                                                                |
|               |   SortExec: TopK(fetch=100), expr=[c_customer_id@0 ASC NULLS LAST, c_salutation@1 ASC NULLS LAST, c_first_name@2 ASC NULLS LAST, c_last_name@3 ASC NULLS LAST, c_preferred_cust_flag@4 ASC NULLS LAST, c_birth_day@5 ASC NULLS LAST, c_birth_month@6 ASC NULLS LAST, c_birth_year@7 ASC NULLS LAST, c_birth_country@8 ASC NULLS LAST, c_login@9 ASC NULLS LAST, c_email_address@10 ASC NULLS LAST, c_last_review_date_sk@11 ASC NULLS LAST, ctr_total_return@12 ASC NULLS LAST], preserve_partitioning=[true]                                    |
|               |     ProjectionExec: expr=[c_customer_id@1 as c_customer_id, c_salutation@2 as c_salutation, c_first_name@3 as c_first_name, c_last_name@4 as c_last_name, c_preferred_cust_flag@5 as c_preferred_cust_flag, c_birth_day@6 as c_birth_day, c_birth_month@7 as c_birth_month, c_birth_year@8 as c_birth_year, c_birth_country@9 as c_birth_country, c_login@10 as c_login, c_email_address@11 as c_email_address, c_last_review_date_sk@12 as c_last_review_date_sk, ctr_total_return@0 as ctr_total_return]                                       |
|               |       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ctr_state@0, ctr_state@1)], filter=CAST(ctr_total_return@0 AS Decimal128(30, 15)) > avg(ctr2.ctr_total_return) * Float64(1.2)@1, projection=[ctr_total_return@1, c_customer_id@2, c_salutation@3, c_first_name@4, c_last_name@5, c_preferred_cust_flag@6, c_birth_day@7, c_birth_month@8, c_birth_year@9, c_birth_country@10, c_login@11, c_email_address@12, c_last_review_date_sk@13]                                                                                            |
|               |           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |             RepartitionExec: partitioning=Hash([ctr_state@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                 HashJoinExec: mode=Partitioned, join_type=Inner, on=[(c_current_addr_sk@3, ca_address_sk@0)], projection=[ctr_state@0, ctr_total_return@1, c_customer_id@2, c_salutation@4, c_first_name@5, c_last_name@6, c_preferred_cust_flag@7, c_birth_day@8, c_birth_month@9, c_birth_year@10, c_birth_country@11, c_login@12, c_email_address@13, c_last_review_date_sk@14]                                                                                                                                                               |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                     RepartitionExec: partitioning=Hash([c_current_addr_sk@3], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ctr_customer_sk@0, c_customer_sk@0)], projection=[ctr_state@1, ctr_total_return@2, c_customer_id@4, c_current_addr_sk@5, c_salutation@6, c_first_name@7, c_last_name@8, c_preferred_cust_flag@9, c_birth_day@10, c_birth_month@11, c_birth_year@12, c_birth_country@13, c_login@14, c_email_address@15, c_last_review_date_sk@16]                                                                                                                                  |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                             RepartitionExec: partitioning=Hash([ctr_customer_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                               ProjectionExec: expr=[wr_returning_customer_sk@0 as ctr_customer_sk, ca_state@1 as ctr_state, sum(web_returns.wr_return_amt)@2 as ctr_total_return]                                                                                                                                                                                                                                                                                                                                                                |
|               |                                 AggregateExec: mode=FinalPartitioned, gby=[wr_returning_customer_sk@0 as wr_returning_customer_sk, ca_state@1 as ca_state], aggr=[sum(web_returns.wr_return_amt)]                                                                                                                                                                                                                                                                                                                                                |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                     RepartitionExec: partitioning=Hash([wr_returning_customer_sk@0, ca_state@1], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                       AggregateExec: mode=Partial, gby=[wr_returning_customer_sk@0 as wr_returning_customer_sk, ca_state@2 as ca_state], aggr=[sum(web_returns.wr_return_amt)]                                                                                                                                                                                                                                                                                                                                                   |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                           HashJoinExec: mode=Partitioned, join_type=Inner, on=[(wr_returning_addr_sk@1, ca_address_sk@0)], projection=[wr_returning_customer_sk@0, wr_return_amt@2, ca_state@4]                                                                                                                                                                                                                                                                                                                                  |
|               |                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                               RepartitionExec: partitioning=Hash([wr_returning_addr_sk@1], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                                   HashJoinExec: mode=Partitioned, join_type=Inner, on=[(wr_returned_date_sk@0, d_date_sk@0)], projection=[wr_returning_customer_sk@1, wr_returning_addr_sk@2, wr_return_amt@3]                                                                                                                                                                                                                                                                                                                   |
|               |                                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                       RepartitionExec: partitioning=Hash([wr_returned_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                         BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                           SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                             RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                               MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                       RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                         ProjectionExec: expr=[d_date_sk@0 as d_date_sk]                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                           BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                               FilterExec: d_year@1 = 2000                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                                                 SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                                     MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                               RepartitionExec: partitioning=Hash([ca_address_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                 BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                   SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                       MemoryExec: partitions=1, partition_sizes=[7]                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                             RepartitionExec: partitioning=Hash([c_customer_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                               BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                 SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                     MemoryExec: partitions=1, partition_sizes=[13]                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                     RepartitionExec: partitioning=Hash([ca_address_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                       ProjectionExec: expr=[ca_address_sk@0 as ca_address_sk]                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                         BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                             FilterExec: ca_state@1 = KS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                               SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                   MemoryExec: partitions=1, partition_sizes=[7]                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |           ProjectionExec: expr=[CAST(CAST(avg(ctr2.ctr_total_return)@1 AS Float64) * 1.2 AS Decimal128(30, 15)) as avg(ctr2.ctr_total_return) * Float64(1.2), ctr_state@0 as ctr_state]                                                                                                                                                                                                                                                                                                                                                          |
|               |             AggregateExec: mode=FinalPartitioned, gby=[ctr_state@0 as ctr_state], aggr=[avg(ctr2.ctr_total_return)]                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                 RepartitionExec: partitioning=Hash([ctr_state@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                   AggregateExec: mode=Partial, gby=[ctr_state@0 as ctr_state], aggr=[avg(ctr2.ctr_total_return)]                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                     ProjectionExec: expr=[ca_state@1 as ctr_state, sum(web_returns.wr_return_amt)@2 as ctr_total_return]                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                       AggregateExec: mode=FinalPartitioned, gby=[wr_returning_customer_sk@0 as wr_returning_customer_sk, ca_state@1 as ca_state], aggr=[sum(web_returns.wr_return_amt)]                                                                                                                                                                                                                                                                                                                                                          |
|               |                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                           RepartitionExec: partitioning=Hash([wr_returning_customer_sk@0, ca_state@1], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                             AggregateExec: mode=Partial, gby=[wr_returning_customer_sk@0 as wr_returning_customer_sk, ca_state@2 as ca_state], aggr=[sum(web_returns.wr_return_amt)]                                                                                                                                                                                                                                                                                                                                                             |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                 HashJoinExec: mode=Partitioned, join_type=Inner, on=[(wr_returning_addr_sk@1, ca_address_sk@0)], projection=[wr_returning_customer_sk@0, wr_return_amt@2, ca_state@4]                                                                                                                                                                                                                                                                                                                                            |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                     RepartitionExec: partitioning=Hash([wr_returning_addr_sk@1], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(wr_returned_date_sk@0, d_date_sk@0)], projection=[wr_returning_customer_sk@1, wr_returning_addr_sk@2, wr_return_amt@3]                                                                                                                                                                                                                                                                                                                             |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                             RepartitionExec: partitioning=Hash([wr_returned_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                               BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                 SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                     MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                             RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                               ProjectionExec: expr=[d_date_sk@0 as d_date_sk]                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                 BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                     FilterExec: d_year@1 = 2000                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                       SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                         RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                           MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                     RepartitionExec: partitioning=Hash([ca_address_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                       BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                         SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                           RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                             MemoryExec: partitions=1, partition_sizes=[7]                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
