---
source: crates/runtime/benches/bench.rs
description: "Query: with ssr as\n (select  s_store_id as store_id,\n          sum(ss_ext_sales_price) as sales,\n          sum(coalesce(sr_return_amt, 0)) as returns,\n          sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\n  from store_sales left outer join store_returns on\n         (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\n     date_dim,\n     store,\n     item,\n     promotion\n where ss_sold_date_sk = d_date_sk\n       and d_date between cast('2002-08-04' as date)\n                  and (cast('2002-08-04' as date) +  INTERVAL '30 days')\n       and ss_store_sk = s_store_sk\n       and ss_item_sk = i_item_sk\n       and i_current_price > 50\n       and ss_promo_sk = p_promo_sk\n       and p_channel_tv = 'N'\n group by s_store_id)\n ,\n csr as\n (select  cp_catalog_page_id as catalog_page_id,\n          sum(cs_ext_sales_price) as sales,\n          sum(coalesce(cr_return_amount, 0)) as returns,\n          sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\n  from catalog_sales left outer join catalog_returns on\n         (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\n     date_dim,\n     catalog_page,\n     item,\n     promotion\n where cs_sold_date_sk = d_date_sk\n       and d_date between cast('2002-08-04' as date)\n                  and (cast('2002-08-04' as date) +  INTERVAL '30 days')\n        and cs_catalog_page_sk = cp_catalog_page_sk\n       and cs_item_sk = i_item_sk\n       and i_current_price > 50\n       and cs_promo_sk = p_promo_sk\n       and p_channel_tv = 'N'\ngroup by cp_catalog_page_id)\n ,\n wsr as\n (select  web_site_id,\n          sum(ws_ext_sales_price) as sales,\n          sum(coalesce(wr_return_amt, 0)) as returns,\n          sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\n  from web_sales left outer join web_returns on\n         (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\n     date_dim,\n     web_site,\n     item,\n     promotion\n where ws_sold_date_sk = d_date_sk\n       and d_date between cast('2002-08-04' as date)\n                  and (cast('2002-08-04' as date) +  INTERVAL '30 days')\n        and ws_web_site_sk = web_site_sk\n       and ws_item_sk = i_item_sk\n       and i_current_price > 50\n       and ws_promo_sk = p_promo_sk\n       and p_channel_tv = 'N'\ngroup by web_site_id)\n  select  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from\n (select 'store channel' as channel\n        , 'store' || store_id as id\n        , sales\n        , returns\n        , profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || catalog_page_id as id\n        , sales\n        , returns\n        , profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , profit\n from   wsr\n ) x\n group by rollup (channel, id)\n order by channel\n         ,id\n  LIMIT 100;\n"
snapshot_kind: text
---
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Sort: x.channel ASC NULLS LAST, x.id ASC NULLS LAST, fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |   Projection: x.channel, x.id, sum(x.sales) AS sales, sum(x.returns) AS returns, sum(x.profit) AS profit                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |     Aggregate: groupBy=[[ROLLUP (x.channel, x.id)]], aggr=[[sum(x.sales), sum(x.returns), sum(x.profit)]]                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |       SubqueryAlias: x                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |         Union                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |           Projection: Utf8("store channel") AS channel, LargeUtf8("store") || ssr.store_id AS id, ssr.sales, ssr.returns, ssr.profit                                                                                                                                                                                                                                                                                                                                                                         |
|               |             SubqueryAlias: ssr                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |               Projection: store.s_store_id AS store_id, sum(store_sales.ss_ext_sales_price) AS sales, sum(coalesce(store_returns.sr_return_amt,Int64(0))) AS returns, sum(store_sales.ss_net_profit - coalesce(store_returns.sr_net_loss,Int64(0))) AS profit                                                                                                                                                                                                                                                |
|               |                 Aggregate: groupBy=[[store.s_store_id]], aggr=[[sum(store_sales.ss_ext_sales_price), sum(coalesce(CAST(store_returns.sr_return_amt AS Decimal128(22, 2)), Decimal128(Some(0),22,2))) AS sum(coalesce(store_returns.sr_return_amt,Int64(0))), sum(store_sales.ss_net_profit - coalesce(CAST(store_returns.sr_net_loss AS Decimal128(22, 2)), Decimal128(Some(0),22,2))) AS sum(store_sales.ss_net_profit - coalesce(store_returns.sr_net_loss,Int64(0)))]]                                    |
|               |                   Projection: store_sales.ss_ext_sales_price, store_sales.ss_net_profit, store_returns.sr_return_amt, store_returns.sr_net_loss, store.s_store_id                                                                                                                                                                                                                                                                                                                                            |
|               |                     Inner Join: store_sales.ss_promo_sk = promotion.p_promo_sk                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                       Projection: store_sales.ss_promo_sk, store_sales.ss_ext_sales_price, store_sales.ss_net_profit, store_returns.sr_return_amt, store_returns.sr_net_loss, store.s_store_id                                                                                                                                                                                                                                                                                                               |
|               |                         Inner Join: store_sales.ss_item_sk = item.i_item_sk                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                           Projection: store_sales.ss_item_sk, store_sales.ss_promo_sk, store_sales.ss_ext_sales_price, store_sales.ss_net_profit, store_returns.sr_return_amt, store_returns.sr_net_loss, store.s_store_id                                                                                                                                                                                                                                                                                   |
|               |                             Inner Join: store_sales.ss_store_sk = store.s_store_sk                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                               Projection: store_sales.ss_item_sk, store_sales.ss_store_sk, store_sales.ss_promo_sk, store_sales.ss_ext_sales_price, store_sales.ss_net_profit, store_returns.sr_return_amt, store_returns.sr_net_loss                                                                                                                                                                                                                                                                        |
|               |                                 Inner Join: store_sales.ss_sold_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                   Projection: store_sales.ss_sold_date_sk, store_sales.ss_item_sk, store_sales.ss_store_sk, store_sales.ss_promo_sk, store_sales.ss_ext_sales_price, store_sales.ss_net_profit, store_returns.sr_return_amt, store_returns.sr_net_loss                                                                                                                                                                                                                                       |
|               |                                     Left Join: store_sales.ss_item_sk = store_returns.sr_item_sk, store_sales.ss_ticket_number = store_returns.sr_ticket_number                                                                                                                                                                                                                                                                                                                                              |
|               |                                       BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                         TableScan: store_sales projection=[ss_sold_date_sk, ss_item_sk, ss_store_sk, ss_promo_sk, ss_ticket_number, ss_ext_sales_price, ss_net_profit]                                                                                                                                                                                                                                                                                                                       |
|               |                                       BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                         TableScan: store_returns projection=[sr_item_sk, sr_ticket_number, sr_return_amt, sr_net_loss]                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                   Projection: date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                     BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                       Filter: date_dim.d_date >= Date32("2002-08-04") AND date_dim.d_date <= Date32("2002-09-03")                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                         TableScan: date_dim projection=[d_date_sk, d_date]                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                 TableScan: store projection=[s_store_sk, s_store_id]                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                           Projection: item.i_item_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                             BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                               Filter: item.i_current_price > Decimal128(Some(5000),7,2)                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                 TableScan: item projection=[i_item_sk, i_current_price]                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                       Projection: promotion.p_promo_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                         BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                           Filter: promotion.p_channel_tv = LargeUtf8("N")                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                             TableScan: promotion projection=[p_promo_sk, p_channel_tv]                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |           Projection: Utf8("catalog channel") AS channel, LargeUtf8("catalog_page") || csr.catalog_page_id AS id, csr.sales, csr.returns, csr.profit                                                                                                                                                                                                                                                                                                                                                         |
|               |             SubqueryAlias: csr                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |               Projection: catalog_page.cp_catalog_page_id AS catalog_page_id, sum(catalog_sales.cs_ext_sales_price) AS sales, sum(coalesce(catalog_returns.cr_return_amount,Int64(0))) AS returns, sum(catalog_sales.cs_net_profit - coalesce(catalog_returns.cr_net_loss,Int64(0))) AS profit                                                                                                                                                                                                               |
|               |                 Aggregate: groupBy=[[catalog_page.cp_catalog_page_id]], aggr=[[sum(catalog_sales.cs_ext_sales_price), sum(coalesce(CAST(catalog_returns.cr_return_amount AS Decimal128(22, 2)), Decimal128(Some(0),22,2))) AS sum(coalesce(catalog_returns.cr_return_amount,Int64(0))), sum(catalog_sales.cs_net_profit - coalesce(CAST(catalog_returns.cr_net_loss AS Decimal128(22, 2)), Decimal128(Some(0),22,2))) AS sum(catalog_sales.cs_net_profit - coalesce(catalog_returns.cr_net_loss,Int64(0)))]] |
|               |                   Projection: catalog_sales.cs_ext_sales_price, catalog_sales.cs_net_profit, catalog_returns.cr_return_amount, catalog_returns.cr_net_loss, catalog_page.cp_catalog_page_id                                                                                                                                                                                                                                                                                                                  |
|               |                     Inner Join: catalog_sales.cs_promo_sk = promotion.p_promo_sk                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                       Projection: catalog_sales.cs_promo_sk, catalog_sales.cs_ext_sales_price, catalog_sales.cs_net_profit, catalog_returns.cr_return_amount, catalog_returns.cr_net_loss, catalog_page.cp_catalog_page_id                                                                                                                                                                                                                                                                                   |
|               |                         Inner Join: catalog_sales.cs_item_sk = item.i_item_sk                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                           Projection: catalog_sales.cs_item_sk, catalog_sales.cs_promo_sk, catalog_sales.cs_ext_sales_price, catalog_sales.cs_net_profit, catalog_returns.cr_return_amount, catalog_returns.cr_net_loss, catalog_page.cp_catalog_page_id                                                                                                                                                                                                                                                     |
|               |                             Inner Join: catalog_sales.cs_catalog_page_sk = catalog_page.cp_catalog_page_sk                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                               Projection: catalog_sales.cs_catalog_page_sk, catalog_sales.cs_item_sk, catalog_sales.cs_promo_sk, catalog_sales.cs_ext_sales_price, catalog_sales.cs_net_profit, catalog_returns.cr_return_amount, catalog_returns.cr_net_loss                                                                                                                                                                                                                                                |
|               |                                 Inner Join: catalog_sales.cs_sold_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                   Projection: catalog_sales.cs_sold_date_sk, catalog_sales.cs_catalog_page_sk, catalog_sales.cs_item_sk, catalog_sales.cs_promo_sk, catalog_sales.cs_ext_sales_price, catalog_sales.cs_net_profit, catalog_returns.cr_return_amount, catalog_returns.cr_net_loss                                                                                                                                                                                                             |
|               |                                     Left Join: catalog_sales.cs_item_sk = catalog_returns.cr_item_sk, catalog_sales.cs_order_number = catalog_returns.cr_order_number                                                                                                                                                                                                                                                                                                                                        |
|               |                                       BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                         TableScan: catalog_sales projection=[cs_sold_date_sk, cs_catalog_page_sk, cs_item_sk, cs_promo_sk, cs_order_number, cs_ext_sales_price, cs_net_profit]                                                                                                                                                                                                                                                                                                               |
|               |                                       BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                         TableScan: catalog_returns projection=[cr_item_sk, cr_order_number, cr_return_amount, cr_net_loss]                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                   Projection: date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                     BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                       Filter: date_dim.d_date >= Date32("2002-08-04") AND date_dim.d_date <= Date32("2002-09-03")                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                         TableScan: date_dim projection=[d_date_sk, d_date]                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                 TableScan: catalog_page projection=[cp_catalog_page_sk, cp_catalog_page_id]                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                           Projection: item.i_item_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                             BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                               Filter: item.i_current_price > Decimal128(Some(5000),7,2)                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                 TableScan: item projection=[i_item_sk, i_current_price]                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                       Projection: promotion.p_promo_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                         BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                           Filter: promotion.p_channel_tv = LargeUtf8("N")                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                             TableScan: promotion projection=[p_promo_sk, p_channel_tv]                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |           Projection: Utf8("web channel") AS channel, LargeUtf8("web_site") || wsr.web_site_id AS id, wsr.sales, wsr.returns, wsr.profit                                                                                                                                                                                                                                                                                                                                                                     |
|               |             SubqueryAlias: wsr                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |               Projection: web_site.web_site_id, sum(web_sales.ws_ext_sales_price) AS sales, sum(coalesce(web_returns.wr_return_amt,Int64(0))) AS returns, sum(web_sales.ws_net_profit - coalesce(web_returns.wr_net_loss,Int64(0))) AS profit                                                                                                                                                                                                                                                                |
|               |                 Aggregate: groupBy=[[web_site.web_site_id]], aggr=[[sum(web_sales.ws_ext_sales_price), sum(coalesce(CAST(web_returns.wr_return_amt AS Decimal128(22, 2)), Decimal128(Some(0),22,2))) AS sum(coalesce(web_returns.wr_return_amt,Int64(0))), sum(web_sales.ws_net_profit - coalesce(CAST(web_returns.wr_net_loss AS Decimal128(22, 2)), Decimal128(Some(0),22,2))) AS sum(web_sales.ws_net_profit - coalesce(web_returns.wr_net_loss,Int64(0)))]]                                              |
|               |                   Projection: web_sales.ws_ext_sales_price, web_sales.ws_net_profit, web_returns.wr_return_amt, web_returns.wr_net_loss, web_site.web_site_id                                                                                                                                                                                                                                                                                                                                                |
|               |                     Inner Join: web_sales.ws_promo_sk = promotion.p_promo_sk                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                       Projection: web_sales.ws_promo_sk, web_sales.ws_ext_sales_price, web_sales.ws_net_profit, web_returns.wr_return_amt, web_returns.wr_net_loss, web_site.web_site_id                                                                                                                                                                                                                                                                                                                     |
|               |                         Inner Join: web_sales.ws_item_sk = item.i_item_sk                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                           Projection: web_sales.ws_item_sk, web_sales.ws_promo_sk, web_sales.ws_ext_sales_price, web_sales.ws_net_profit, web_returns.wr_return_amt, web_returns.wr_net_loss, web_site.web_site_id                                                                                                                                                                                                                                                                                           |
|               |                             Inner Join: web_sales.ws_web_site_sk = web_site.web_site_sk                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                               Projection: web_sales.ws_item_sk, web_sales.ws_web_site_sk, web_sales.ws_promo_sk, web_sales.ws_ext_sales_price, web_sales.ws_net_profit, web_returns.wr_return_amt, web_returns.wr_net_loss                                                                                                                                                                                                                                                                                   |
|               |                                 Inner Join: web_sales.ws_sold_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                   Projection: web_sales.ws_sold_date_sk, web_sales.ws_item_sk, web_sales.ws_web_site_sk, web_sales.ws_promo_sk, web_sales.ws_ext_sales_price, web_sales.ws_net_profit, web_returns.wr_return_amt, web_returns.wr_net_loss                                                                                                                                                                                                                                                    |
|               |                                     Left Join: web_sales.ws_item_sk = web_returns.wr_item_sk, web_sales.ws_order_number = web_returns.wr_order_number                                                                                                                                                                                                                                                                                                                                                        |
|               |                                       BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                         TableScan: web_sales projection=[ws_sold_date_sk, ws_item_sk, ws_web_site_sk, ws_promo_sk, ws_order_number, ws_ext_sales_price, ws_net_profit]                                                                                                                                                                                                                                                                                                                       |
|               |                                       BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                         TableScan: web_returns projection=[wr_item_sk, wr_order_number, wr_return_amt, wr_net_loss]                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                   Projection: date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                     BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                       Filter: date_dim.d_date >= Date32("2002-08-04") AND date_dim.d_date <= Date32("2002-09-03")                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                         TableScan: date_dim projection=[d_date_sk, d_date]                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                 TableScan: web_site projection=[web_site_sk, web_site_id]                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                           Projection: item.i_item_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                             BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                               Filter: item.i_current_price > Decimal128(Some(5000),7,2)                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                 TableScan: item projection=[i_item_sk, i_current_price]                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                       Projection: promotion.p_promo_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                         BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                           Filter: promotion.p_channel_tv = LargeUtf8("N")                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                             TableScan: promotion projection=[p_promo_sk, p_channel_tv]                                                                                                                                                                                                                                                                                                                                                                                                                       |
| physical_plan | SortPreservingMergeExec: [channel@0 ASC NULLS LAST, id@1 ASC NULLS LAST], fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |   SortExec: TopK(fetch=100), expr=[channel@0 ASC NULLS LAST, id@1 ASC NULLS LAST], preserve_partitioning=[true]                                                                                                                                                                                                                                                                                                                                                                                              |
|               |     ProjectionExec: expr=[channel@0 as channel, id@1 as id, sum(x.sales)@3 as sales, sum(x.returns)@4 as returns, sum(x.profit)@5 as profit]                                                                                                                                                                                                                                                                                                                                                                 |
|               |       AggregateExec: mode=FinalPartitioned, gby=[channel@0 as channel, id@1 as id, __grouping_id@2 as __grouping_id], aggr=[sum(x.sales), sum(x.returns), sum(x.profit)]                                                                                                                                                                                                                                                                                                                                     |
|               |         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |           RepartitionExec: partitioning=Hash([channel@0, id@1, __grouping_id@2], 4), input_partitions=12                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |             AggregateExec: mode=Partial, gby=[(NULL as channel, NULL as id), (channel@0 as channel, NULL as id), (channel@0 as channel, id@1 as id)], aggr=[sum(x.sales), sum(x.returns), sum(x.profit)]                                                                                                                                                                                                                                                                                                     |
|               |               UnionExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                 ProjectionExec: expr=[store channel as channel, store || store_id@0 as id, sales@1 as sales, returns@2 as returns, profit@3 as profit]                                                                                                                                                                                                                                                                                                                                                       |
|               |                   ProjectionExec: expr=[s_store_id@0 as store_id, sum(store_sales.ss_ext_sales_price)@1 as sales, sum(coalesce(store_returns.sr_return_amt,Int64(0)))@2 as returns, sum(store_sales.ss_net_profit - coalesce(store_returns.sr_net_loss,Int64(0)))@3 as profit]                                                                                                                                                                                                                               |
|               |                     AggregateExec: mode=FinalPartitioned, gby=[s_store_id@0 as s_store_id], aggr=[sum(store_sales.ss_ext_sales_price), sum(coalesce(store_returns.sr_return_amt,Int64(0))), sum(store_sales.ss_net_profit - coalesce(store_returns.sr_net_loss,Int64(0)))]                                                                                                                                                                                                                                   |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                         RepartitionExec: partitioning=Hash([s_store_id@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                           AggregateExec: mode=Partial, gby=[s_store_id@4 as s_store_id], aggr=[sum(store_sales.ss_ext_sales_price), sum(coalesce(store_returns.sr_return_amt,Int64(0))), sum(store_sales.ss_net_profit - coalesce(store_returns.sr_net_loss,Int64(0)))]                                                                                                                                                                                                                                      |
|               |                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                               HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_promo_sk@0, p_promo_sk@0)], projection=[ss_ext_sales_price@1, ss_net_profit@2, sr_return_amt@3, sr_net_loss@4, s_store_id@5]                                                                                                                                                                                                                                                                                          |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                   RepartitionExec: partitioning=Hash([ss_promo_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                       HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_item_sk@0, i_item_sk@0)], projection=[ss_promo_sk@1, ss_ext_sales_price@2, ss_net_profit@3, sr_return_amt@4, sr_net_loss@5, s_store_id@6]                                                                                                                                                                                                                                                                     |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                           RepartitionExec: partitioning=Hash([ss_item_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                               HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_store_sk@1, s_store_sk@0)], projection=[ss_item_sk@0, ss_promo_sk@2, ss_ext_sales_price@3, ss_net_profit@4, sr_return_amt@5, sr_net_loss@6, s_store_id@8]                                                                                                                                                                                                                                             |
|               |                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                   RepartitionExec: partitioning=Hash([ss_store_sk@1], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                                       HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_sold_date_sk@0, d_date_sk@0)], projection=[ss_item_sk@1, ss_store_sk@2, ss_promo_sk@3, ss_ext_sales_price@4, ss_net_profit@5, sr_return_amt@6, sr_net_loss@7]                                                                                                                                                                                                                                 |
|               |                                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                           RepartitionExec: partitioning=Hash([ss_sold_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                                               HashJoinExec: mode=Partitioned, join_type=Left, on=[(ss_item_sk@1, sr_item_sk@0), (ss_ticket_number@4, sr_ticket_number@1)], projection=[ss_sold_date_sk@0, ss_item_sk@1, ss_store_sk@2, ss_promo_sk@3, ss_ext_sales_price@5, ss_net_profit@6, sr_return_amt@9, sr_net_loss@10]                                                                                                                                                                |
|               |                                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                                   RepartitionExec: partitioning=Hash([ss_item_sk@1, ss_ticket_number@4], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                              |
|               |                                                                     BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                                       SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                                         RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                                           MemoryExec: partitions=1, partition_sizes=[352]                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                                   RepartitionExec: partitioning=Hash([sr_item_sk@0, sr_ticket_number@1], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                              |
|               |                                                                     BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                                       SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                                         RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                                           MemoryExec: partitions=1, partition_sizes=[36]                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                           RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                             ProjectionExec: expr=[d_date_sk@0 as d_date_sk]                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                               BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                                   FilterExec: d_date@1 >= 2002-08-04 AND d_date@1 <= 2002-09-03                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                                                     SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                                       RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                                         MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                   RepartitionExec: partitioning=Hash([s_store_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                       BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                         SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                           MemoryExec: partitions=1, partition_sizes=[1]                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                           RepartitionExec: partitioning=Hash([i_item_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                             ProjectionExec: expr=[i_item_sk@0 as i_item_sk]                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                               BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                   FilterExec: i_current_price@1 > Some(5000),7,2                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                     SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                       RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                         MemoryExec: partitions=1, partition_sizes=[3]                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                   RepartitionExec: partitioning=Hash([p_promo_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                     ProjectionExec: expr=[p_promo_sk@0 as p_promo_sk]                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                       BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                           FilterExec: p_channel_tv@1 = N                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                             RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                               SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                 MemoryExec: partitions=1, partition_sizes=[1]                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                 ProjectionExec: expr=[catalog channel as channel, catalog_page || catalog_page_id@0 as id, sales@1 as sales, returns@2 as returns, profit@3 as profit]                                                                                                                                                                                                                                                                                                                                       |
|               |                   ProjectionExec: expr=[cp_catalog_page_id@0 as catalog_page_id, sum(catalog_sales.cs_ext_sales_price)@1 as sales, sum(coalesce(catalog_returns.cr_return_amount,Int64(0)))@2 as returns, sum(catalog_sales.cs_net_profit - coalesce(catalog_returns.cr_net_loss,Int64(0)))@3 as profit]                                                                                                                                                                                                     |
|               |                     AggregateExec: mode=FinalPartitioned, gby=[cp_catalog_page_id@0 as cp_catalog_page_id], aggr=[sum(catalog_sales.cs_ext_sales_price), sum(coalesce(catalog_returns.cr_return_amount,Int64(0))), sum(catalog_sales.cs_net_profit - coalesce(catalog_returns.cr_net_loss,Int64(0)))]                                                                                                                                                                                                        |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                         RepartitionExec: partitioning=Hash([cp_catalog_page_id@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                           AggregateExec: mode=Partial, gby=[cp_catalog_page_id@4 as cp_catalog_page_id], aggr=[sum(catalog_sales.cs_ext_sales_price), sum(coalesce(catalog_returns.cr_return_amount,Int64(0))), sum(catalog_sales.cs_net_profit - coalesce(catalog_returns.cr_net_loss,Int64(0)))]                                                                                                                                                                                                           |
|               |                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                               HashJoinExec: mode=Partitioned, join_type=Inner, on=[(cs_promo_sk@0, p_promo_sk@0)], projection=[cs_ext_sales_price@1, cs_net_profit@2, cr_return_amount@3, cr_net_loss@4, cp_catalog_page_id@5]                                                                                                                                                                                                                                                                               |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                   RepartitionExec: partitioning=Hash([cs_promo_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                       HashJoinExec: mode=Partitioned, join_type=Inner, on=[(cs_item_sk@0, i_item_sk@0)], projection=[cs_promo_sk@1, cs_ext_sales_price@2, cs_net_profit@3, cr_return_amount@4, cr_net_loss@5, cp_catalog_page_id@6]                                                                                                                                                                                                                                                          |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                           RepartitionExec: partitioning=Hash([cs_item_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                               HashJoinExec: mode=Partitioned, join_type=Inner, on=[(cs_catalog_page_sk@0, cp_catalog_page_sk@0)], projection=[cs_item_sk@1, cs_promo_sk@2, cs_ext_sales_price@3, cs_net_profit@4, cr_return_amount@5, cr_net_loss@6, cp_catalog_page_id@8]                                                                                                                                                                                                                   |
|               |                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                   RepartitionExec: partitioning=Hash([cs_catalog_page_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                                       HashJoinExec: mode=Partitioned, join_type=Inner, on=[(cs_sold_date_sk@0, d_date_sk@0)], projection=[cs_catalog_page_sk@1, cs_item_sk@2, cs_promo_sk@3, cs_ext_sales_price@4, cs_net_profit@5, cr_return_amount@6, cr_net_loss@7]                                                                                                                                                                                                                       |
|               |                                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                           RepartitionExec: partitioning=Hash([cs_sold_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                                               HashJoinExec: mode=Partitioned, join_type=Left, on=[(cs_item_sk@2, cr_item_sk@0), (cs_order_number@4, cr_order_number@1)], projection=[cs_sold_date_sk@0, cs_catalog_page_sk@1, cs_item_sk@2, cs_promo_sk@3, cs_ext_sales_price@5, cs_net_profit@6, cr_return_amount@9, cr_net_loss@10]                                                                                                                                                        |
|               |                                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                                   RepartitionExec: partitioning=Hash([cs_item_sk@2, cs_order_number@4], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                               |
|               |                                                                     BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                                       SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                                         RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                                           MemoryExec: partitions=1, partition_sizes=[176]                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                                   RepartitionExec: partitioning=Hash([cr_item_sk@0, cr_order_number@1], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                               |
|               |                                                                     BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                                       SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                                         RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                                           MemoryExec: partitions=1, partition_sizes=[18]                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                           RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                             ProjectionExec: expr=[d_date_sk@0 as d_date_sk]                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                               BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                                   FilterExec: d_date@1 >= 2002-08-04 AND d_date@1 <= 2002-09-03                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                                                     SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                                       RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                                         MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                   RepartitionExec: partitioning=Hash([cp_catalog_page_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                     BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                       SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                         RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                           MemoryExec: partitions=1, partition_sizes=[2]                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                           RepartitionExec: partitioning=Hash([i_item_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                             ProjectionExec: expr=[i_item_sk@0 as i_item_sk]                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                               BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                   FilterExec: i_current_price@1 > Some(5000),7,2                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                     SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                       RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                         MemoryExec: partitions=1, partition_sizes=[3]                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                   RepartitionExec: partitioning=Hash([p_promo_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                     ProjectionExec: expr=[p_promo_sk@0 as p_promo_sk]                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                       BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                           FilterExec: p_channel_tv@1 = N                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                             RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                               SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                 MemoryExec: partitions=1, partition_sizes=[1]                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                 ProjectionExec: expr=[web channel as channel, web_site || web_site_id@0 as id, sales@1 as sales, returns@2 as returns, profit@3 as profit]                                                                                                                                                                                                                                                                                                                                                   |
|               |                   ProjectionExec: expr=[web_site_id@0 as web_site_id, sum(web_sales.ws_ext_sales_price)@1 as sales, sum(coalesce(web_returns.wr_return_amt,Int64(0)))@2 as returns, sum(web_sales.ws_net_profit - coalesce(web_returns.wr_net_loss,Int64(0)))@3 as profit]                                                                                                                                                                                                                                   |
|               |                     AggregateExec: mode=FinalPartitioned, gby=[web_site_id@0 as web_site_id], aggr=[sum(web_sales.ws_ext_sales_price), sum(coalesce(web_returns.wr_return_amt,Int64(0))), sum(web_sales.ws_net_profit - coalesce(web_returns.wr_net_loss,Int64(0)))]                                                                                                                                                                                                                                         |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                         RepartitionExec: partitioning=Hash([web_site_id@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                           AggregateExec: mode=Partial, gby=[web_site_id@4 as web_site_id], aggr=[sum(web_sales.ws_ext_sales_price), sum(coalesce(web_returns.wr_return_amt,Int64(0))), sum(web_sales.ws_net_profit - coalesce(web_returns.wr_net_loss,Int64(0)))]                                                                                                                                                                                                                                            |
|               |                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                               HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ws_promo_sk@0, p_promo_sk@0)], projection=[ws_ext_sales_price@1, ws_net_profit@2, wr_return_amt@3, wr_net_loss@4, web_site_id@5]                                                                                                                                                                                                                                                                                         |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                   RepartitionExec: partitioning=Hash([ws_promo_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                       HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ws_item_sk@0, i_item_sk@0)], projection=[ws_promo_sk@1, ws_ext_sales_price@2, ws_net_profit@3, wr_return_amt@4, wr_net_loss@5, web_site_id@6]                                                                                                                                                                                                                                                                    |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                           RepartitionExec: partitioning=Hash([ws_item_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                               HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ws_web_site_sk@1, web_site_sk@0)], projection=[ws_item_sk@0, ws_promo_sk@2, ws_ext_sales_price@3, ws_net_profit@4, wr_return_amt@5, wr_net_loss@6, web_site_id@8]                                                                                                                                                                                                                                        |
|               |                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                   RepartitionExec: partitioning=Hash([ws_web_site_sk@1], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                                       HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ws_sold_date_sk@0, d_date_sk@0)], projection=[ws_item_sk@1, ws_web_site_sk@2, ws_promo_sk@3, ws_ext_sales_price@4, ws_net_profit@5, wr_return_amt@6, wr_net_loss@7]                                                                                                                                                                                                                              |
|               |                                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                           RepartitionExec: partitioning=Hash([ws_sold_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                                               HashJoinExec: mode=Partitioned, join_type=Left, on=[(ws_item_sk@1, wr_item_sk@0), (ws_order_number@4, wr_order_number@1)], projection=[ws_sold_date_sk@0, ws_item_sk@1, ws_web_site_sk@2, ws_promo_sk@3, ws_ext_sales_price@5, ws_net_profit@6, wr_return_amt@9, wr_net_loss@10]                                                                                                                                                               |
|               |                                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                                   RepartitionExec: partitioning=Hash([ws_item_sk@1, ws_order_number@4], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                               |
|               |                                                                     BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                                       SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                                         RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                                           MemoryExec: partitions=1, partition_sizes=[88]                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                                   RepartitionExec: partitioning=Hash([wr_item_sk@0, wr_order_number@1], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                               |
|               |                                                                     BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                                       SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                                         RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                                           MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                           RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                                             ProjectionExec: expr=[d_date_sk@0 as d_date_sk]                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                               BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                                   FilterExec: d_date@1 >= 2002-08-04 AND d_date@1 <= 2002-09-03                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                                                     SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                                       RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                                         MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                   RepartitionExec: partitioning=Hash([web_site_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                       BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                         SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                           MemoryExec: partitions=1, partition_sizes=[1]                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                           RepartitionExec: partitioning=Hash([i_item_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                             ProjectionExec: expr=[i_item_sk@0 as i_item_sk]                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                               BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                   FilterExec: i_current_price@1 > Some(5000),7,2                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                     SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                                       RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                                         MemoryExec: partitions=1, partition_sizes=[3]                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                   RepartitionExec: partitioning=Hash([p_promo_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                     ProjectionExec: expr=[p_promo_sk@0 as p_promo_sk]                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                       BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                           FilterExec: p_channel_tv@1 = N                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                             RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                               SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                                                 MemoryExec: partitions=1, partition_sizes=[1]                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
