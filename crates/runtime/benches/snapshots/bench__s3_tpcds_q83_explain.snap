---
source: crates/runtime/benches/bench.rs
description: "Query: with sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in\n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in\n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('2000-04-29','2000-09-09','2000-11-02')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in\n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in\n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('2000-04-29','2000-09-09','2000-11-02')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in\n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in\n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('2000-04-29','2000-09-09','2000-11-02')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n where sr_items.item_id=cr_items.item_id\n   and sr_items.item_id=wr_items.item_id\n order by sr_items.item_id\n         ,sr_item_qty\n  LIMIT 100;\n"
snapshot_kind: text
---
+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Sort: sr_items.item_id ASC NULLS LAST, sr_items.sr_item_qty ASC NULLS LAST, fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |   Projection: sr_items.item_id, sr_items.sr_item_qty, CAST(sr_items.sr_item_qty / __common_expr_7 AS Float64) / Float64(3) * Float64(100) AS sr_dev, cr_items.cr_item_qty, CAST(cr_items.cr_item_qty / __common_expr_7 AS Float64) / Float64(3) * Float64(100) AS cr_dev, wr_items.wr_item_qty, CAST(wr_items.wr_item_qty / __common_expr_7 AS Float64) / Float64(3) * Float64(100) AS wr_dev, CAST(__common_expr_7 AS Float64) / Float64(3) AS average                                                                                                                                                                                                                                                                                 |
|               |     Projection: sr_items.sr_item_qty + cr_items.cr_item_qty + wr_items.wr_item_qty AS __common_expr_7, sr_items.item_id, sr_items.sr_item_qty, cr_items.cr_item_qty, wr_items.wr_item_qty                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |       Inner Join: sr_items.item_id = wr_items.item_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |         Projection: sr_items.item_id, sr_items.sr_item_qty, cr_items.cr_item_qty                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |           Inner Join: sr_items.item_id = cr_items.item_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |             SubqueryAlias: sr_items                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |               Projection: item.i_item_id AS item_id, sum(store_returns.sr_return_quantity) AS sr_item_qty                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                 Aggregate: groupBy=[[item.i_item_id]], aggr=[[sum(CAST(store_returns.sr_return_quantity AS Int64))]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                   Projection: store_returns.sr_return_quantity, item.i_item_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                     LeftSemi Join: date_dim.d_date = __correlated_sq_2.d_date                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                       Projection: store_returns.sr_return_quantity, item.i_item_id, date_dim.d_date                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                         Inner Join: store_returns.sr_returned_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                           Projection: store_returns.sr_returned_date_sk, store_returns.sr_return_quantity, item.i_item_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                             Inner Join: store_returns.sr_item_sk = item.i_item_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                 TableScan: store_returns projection=[sr_returned_date_sk, sr_item_sk, sr_return_quantity]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                 TableScan: item projection=[i_item_sk, i_item_id]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                           BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                             TableScan: date_dim projection=[d_date_sk, d_date]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                       SubqueryAlias: __correlated_sq_2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                         Projection: date_dim.d_date                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                           LeftSemi Join: date_dim.d_week_seq = __correlated_sq_1.d_week_seq                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                             BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                               TableScan: date_dim projection=[d_date, d_week_seq]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                             SubqueryAlias: __correlated_sq_1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                 TableScan: date_dim projection=[d_week_seq], full_filters=[date_dim.d_date = Date32("2000-04-29") OR date_dim.d_date = Date32("2000-09-09") OR date_dim.d_date = Date32("2000-11-02")]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |             SubqueryAlias: cr_items                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |               Projection: item.i_item_id AS item_id, sum(catalog_returns.cr_return_quantity) AS cr_item_qty                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                 Aggregate: groupBy=[[item.i_item_id]], aggr=[[sum(CAST(catalog_returns.cr_return_quantity AS Int64))]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                   Projection: catalog_returns.cr_return_quantity, item.i_item_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                     LeftSemi Join: date_dim.d_date = __correlated_sq_4.d_date                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                       Projection: catalog_returns.cr_return_quantity, item.i_item_id, date_dim.d_date                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                         Inner Join: catalog_returns.cr_returned_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                           Projection: catalog_returns.cr_returned_date_sk, catalog_returns.cr_return_quantity, item.i_item_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                             Inner Join: catalog_returns.cr_item_sk = item.i_item_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                 TableScan: catalog_returns projection=[cr_returned_date_sk, cr_item_sk, cr_return_quantity]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                 TableScan: item projection=[i_item_sk, i_item_id]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                           BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                             TableScan: date_dim projection=[d_date_sk, d_date]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                       SubqueryAlias: __correlated_sq_4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                         Projection: date_dim.d_date                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                           LeftSemi Join: date_dim.d_week_seq = __correlated_sq_3.d_week_seq                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                             BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                               TableScan: date_dim projection=[d_date, d_week_seq]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                             SubqueryAlias: __correlated_sq_3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                 TableScan: date_dim projection=[d_week_seq], full_filters=[date_dim.d_date = Date32("2000-04-29") OR date_dim.d_date = Date32("2000-09-09") OR date_dim.d_date = Date32("2000-11-02")]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |         SubqueryAlias: wr_items                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |           Projection: item.i_item_id AS item_id, sum(web_returns.wr_return_quantity) AS wr_item_qty                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |             Aggregate: groupBy=[[item.i_item_id]], aggr=[[sum(CAST(web_returns.wr_return_quantity AS Int64))]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |               Projection: web_returns.wr_return_quantity, item.i_item_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                 LeftSemi Join: date_dim.d_date = __correlated_sq_6.d_date                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                   Projection: web_returns.wr_return_quantity, item.i_item_id, date_dim.d_date                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                     Inner Join: web_returns.wr_returned_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                       Projection: web_returns.wr_returned_date_sk, web_returns.wr_return_quantity, item.i_item_id                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                         Inner Join: web_returns.wr_item_sk = item.i_item_sk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                           BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                             TableScan: web_returns projection=[wr_returned_date_sk, wr_item_sk, wr_return_quantity]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                           BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                             TableScan: item projection=[i_item_sk, i_item_id]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                       BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                         TableScan: date_dim projection=[d_date_sk, d_date]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                   SubqueryAlias: __correlated_sq_6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                     Projection: date_dim.d_date                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                       LeftSemi Join: date_dim.d_week_seq = __correlated_sq_5.d_week_seq                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                         BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                           TableScan: date_dim projection=[d_date, d_week_seq]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                         SubqueryAlias: __correlated_sq_5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                           BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                             TableScan: date_dim projection=[d_week_seq], full_filters=[date_dim.d_date = Date32("2000-04-29") OR date_dim.d_date = Date32("2000-09-09") OR date_dim.d_date = Date32("2000-11-02")]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| physical_plan | SortPreservingMergeExec: [item_id@0 ASC NULLS LAST, sr_item_qty@1 ASC NULLS LAST], fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |   SortExec: TopK(fetch=100), expr=[item_id@0 ASC NULLS LAST, sr_item_qty@1 ASC NULLS LAST], preserve_partitioning=[true]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |     ProjectionExec: expr=[item_id@1 as item_id, sr_item_qty@2 as sr_item_qty, CAST(sr_item_qty@2 / __common_expr_7@0 AS Float64) / 3 * 100 as sr_dev, cr_item_qty@3 as cr_item_qty, CAST(cr_item_qty@3 / __common_expr_7@0 AS Float64) / 3 * 100 as cr_dev, wr_item_qty@4 as wr_item_qty, CAST(wr_item_qty@4 / __common_expr_7@0 AS Float64) / 3 * 100 as wr_dev, CAST(__common_expr_7@0 AS Float64) / 3 as average]                                                                                                                                                                                                                                                                                                                    |
|               |       ProjectionExec: expr=[sr_item_qty@1 + cr_item_qty@2 + wr_item_qty@3 as __common_expr_7, item_id@0 as item_id, sr_item_qty@1 as sr_item_qty, cr_item_qty@2 as cr_item_qty, wr_item_qty@3 as wr_item_qty]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |           HashJoinExec: mode=Partitioned, join_type=Inner, on=[(item_id@0, item_id@0)], projection=[item_id@0, sr_item_qty@1, cr_item_qty@2, wr_item_qty@4]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |               HashJoinExec: mode=Partitioned, join_type=Inner, on=[(item_id@0, item_id@0)], projection=[item_id@0, sr_item_qty@1, cr_item_qty@3]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                 ProjectionExec: expr=[i_item_id@0 as item_id, sum(store_returns.sr_return_quantity)@1 as sr_item_qty]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                   AggregateExec: mode=FinalPartitioned, gby=[i_item_id@0 as i_item_id], aggr=[sum(store_returns.sr_return_quantity)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                       RepartitionExec: partitioning=Hash([i_item_id@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                         AggregateExec: mode=Partial, gby=[i_item_id@1 as i_item_id], aggr=[sum(store_returns.sr_return_quantity)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                             HashJoinExec: mode=Partitioned, join_type=LeftSemi, on=[(d_date@2, d_date@0)], projection=[sr_return_quantity@0, i_item_id@1]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                 RepartitionExec: partitioning=Hash([d_date@2], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                     HashJoinExec: mode=Partitioned, join_type=Inner, on=[(sr_returned_date_sk@0, d_date_sk@0)], projection=[sr_return_quantity@1, i_item_id@2, d_date@4]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                         RepartitionExec: partitioning=Hash([sr_returned_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                             HashJoinExec: mode=Partitioned, join_type=Inner, on=[(sr_item_sk@1, i_item_sk@0)], projection=[sr_returned_date_sk@0, sr_return_quantity@2, i_item_id@4]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                 RepartitionExec: partitioning=Hash([sr_item_sk@1], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                   BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                     ParquetExec: file_groups={4 groups: [[tpcds_sf1/store_returns/store_returns.parquet:0..4882309], [tpcds_sf1/store_returns/store_returns.parquet:4882309..9764618], [tpcds_sf1/store_returns/store_returns.parquet:9764618..14646927], [tpcds_sf1/store_returns/store_returns.parquet:14646927..19529233]]}, projection=[sr_returned_date_sk, sr_item_sk, sr_return_quantity]                                                                                                                                                                                                                                                                                                        |
|               |                                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                 RepartitionExec: partitioning=Hash([i_item_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                     BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                       ParquetExec: file_groups={1 group: [[tpcds_sf1/item/item.parquet]]}, projection=[i_item_sk, i_item_id]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                         RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                           RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                             BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                               ParquetExec: file_groups={1 group: [[tpcds_sf1/date_dim/date_dim.parquet]]}, projection=[d_date_sk, d_date]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                 RepartitionExec: partitioning=Hash([d_date@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                     HashJoinExec: mode=Partitioned, join_type=LeftSemi, on=[(d_week_seq@1, d_week_seq@0)], projection=[d_date@0]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                         RepartitionExec: partitioning=Hash([d_week_seq@1], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                           RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                             BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                               ParquetExec: file_groups={1 group: [[tpcds_sf1/date_dim/date_dim.parquet]]}, projection=[d_date, d_week_seq]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                         RepartitionExec: partitioning=Hash([d_week_seq@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                           RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                             BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                               ParquetExec: file_groups={1 group: [[tpcds_sf1/date_dim/date_dim.parquet]]}, projection=[d_week_seq], predicate=d_date@2 = 2000-04-29 OR d_date@2 = 2000-09-09 OR d_date@2 = 2000-11-02, pruning_predicate=CASE WHEN d_date_null_count@2 = d_date_row_count@3 THEN false ELSE d_date_min@0 <= 2000-04-29 AND 2000-04-29 <= d_date_max@1 END OR CASE WHEN d_date_null_count@2 = d_date_row_count@3 THEN false ELSE d_date_min@0 <= 2000-09-09 AND 2000-09-09 <= d_date_max@1 END OR CASE WHEN d_date_null_count@2 = d_date_row_count@3 THEN false ELSE d_date_min@0 <= 2000-11-02 AND 2000-11-02 <= d_date_max@1 END, required_guarantees=[N] |
|               |                 ProjectionExec: expr=[i_item_id@0 as item_id, sum(catalog_returns.cr_return_quantity)@1 as cr_item_qty]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                   AggregateExec: mode=FinalPartitioned, gby=[i_item_id@0 as i_item_id], aggr=[sum(catalog_returns.cr_return_quantity)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                       RepartitionExec: partitioning=Hash([i_item_id@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                         AggregateExec: mode=Partial, gby=[i_item_id@1 as i_item_id], aggr=[sum(catalog_returns.cr_return_quantity)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                             HashJoinExec: mode=Partitioned, join_type=LeftSemi, on=[(d_date@2, d_date@0)], projection=[cr_return_quantity@0, i_item_id@1]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                 RepartitionExec: partitioning=Hash([d_date@2], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                     HashJoinExec: mode=Partitioned, join_type=Inner, on=[(cr_returned_date_sk@0, d_date_sk@0)], projection=[cr_return_quantity@1, i_item_id@2, d_date@4]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                         RepartitionExec: partitioning=Hash([cr_returned_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                             HashJoinExec: mode=Partitioned, join_type=Inner, on=[(cr_item_sk@1, i_item_sk@0)], projection=[cr_returned_date_sk@0, cr_return_quantity@2, i_item_id@4]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                 RepartitionExec: partitioning=Hash([cr_item_sk@1], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                   BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                     ParquetExec: file_groups={4 groups: [[tpcds_sf1/catalog_returns/catalog_returns.parquet:0..3106858], [tpcds_sf1/catalog_returns/catalog_returns.parquet:3106858..6213716], [tpcds_sf1/catalog_returns/catalog_returns.parquet:6213716..9320574], [tpcds_sf1/catalog_returns/catalog_returns.parquet:9320574..12427432]]}, projection=[cr_returned_date_sk, cr_item_sk, cr_return_quantity]                                                                                                                                                                                                                                                                                          |
|               |                                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                                 RepartitionExec: partitioning=Hash([i_item_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                     BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                       ParquetExec: file_groups={1 group: [[tpcds_sf1/item/item.parquet]]}, projection=[i_item_sk, i_item_id]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                         RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                           RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                             BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                               ParquetExec: file_groups={1 group: [[tpcds_sf1/date_dim/date_dim.parquet]]}, projection=[d_date_sk, d_date]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                 RepartitionExec: partitioning=Hash([d_date@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                     HashJoinExec: mode=Partitioned, join_type=LeftSemi, on=[(d_week_seq@1, d_week_seq@0)], projection=[d_date@0]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                         RepartitionExec: partitioning=Hash([d_week_seq@1], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                           RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                             BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                               ParquetExec: file_groups={1 group: [[tpcds_sf1/date_dim/date_dim.parquet]]}, projection=[d_date, d_week_seq]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                         RepartitionExec: partitioning=Hash([d_week_seq@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                           RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                             BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                               ParquetExec: file_groups={1 group: [[tpcds_sf1/date_dim/date_dim.parquet]]}, projection=[d_week_seq], predicate=d_date@2 = 2000-04-29 OR d_date@2 = 2000-09-09 OR d_date@2 = 2000-11-02, pruning_predicate=CASE WHEN d_date_null_count@2 = d_date_row_count@3 THEN false ELSE d_date_min@0 <= 2000-04-29 AND 2000-04-29 <= d_date_max@1 END OR CASE WHEN d_date_null_count@2 = d_date_row_count@3 THEN false ELSE d_date_min@0 <= 2000-09-09 AND 2000-09-09 <= d_date_max@1 END OR CASE WHEN d_date_null_count@2 = d_date_row_count@3 THEN false ELSE d_date_min@0 <= 2000-11-02 AND 2000-11-02 <= d_date_max@1 END, required_guarantees=[N] |
|               |             ProjectionExec: expr=[i_item_id@0 as item_id, sum(web_returns.wr_return_quantity)@1 as wr_item_qty]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |               AggregateExec: mode=FinalPartitioned, gby=[i_item_id@0 as i_item_id], aggr=[sum(web_returns.wr_return_quantity)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                   RepartitionExec: partitioning=Hash([i_item_id@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                     AggregateExec: mode=Partial, gby=[i_item_id@1 as i_item_id], aggr=[sum(web_returns.wr_return_quantity)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                         HashJoinExec: mode=Partitioned, join_type=LeftSemi, on=[(d_date@2, d_date@0)], projection=[wr_return_quantity@0, i_item_id@1]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                             RepartitionExec: partitioning=Hash([d_date@2], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                 HashJoinExec: mode=Partitioned, join_type=Inner, on=[(wr_returned_date_sk@0, d_date_sk@0)], projection=[wr_return_quantity@1, i_item_id@2, d_date@4]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                     RepartitionExec: partitioning=Hash([wr_returned_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(wr_item_sk@1, i_item_sk@0)], projection=[wr_returned_date_sk@0, wr_return_quantity@2, i_item_id@4]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                             RepartitionExec: partitioning=Hash([wr_item_sk@1], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                               RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                                 BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                                   ParquetExec: file_groups={1 group: [[tpcds_sf1/web_returns/web_returns.parquet]]}, projection=[wr_returned_date_sk, wr_item_sk, wr_return_quantity]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                             RepartitionExec: partitioning=Hash([i_item_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                               RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                                 BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                                   ParquetExec: file_groups={1 group: [[tpcds_sf1/item/item.parquet]]}, projection=[i_item_sk, i_item_id]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                     RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                       RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                         BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                           ParquetExec: file_groups={1 group: [[tpcds_sf1/date_dim/date_dim.parquet]]}, projection=[d_date_sk, d_date]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                             RepartitionExec: partitioning=Hash([d_date@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                 HashJoinExec: mode=Partitioned, join_type=LeftSemi, on=[(d_week_seq@1, d_week_seq@0)], projection=[d_date@0]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                     RepartitionExec: partitioning=Hash([d_week_seq@1], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                       RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                         BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                           ParquetExec: file_groups={1 group: [[tpcds_sf1/date_dim/date_dim.parquet]]}, projection=[d_date, d_week_seq]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                     RepartitionExec: partitioning=Hash([d_week_seq@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                       RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                         BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                           ParquetExec: file_groups={1 group: [[tpcds_sf1/date_dim/date_dim.parquet]]}, projection=[d_week_seq], predicate=d_date@2 = 2000-04-29 OR d_date@2 = 2000-09-09 OR d_date@2 = 2000-11-02, pruning_predicate=CASE WHEN d_date_null_count@2 = d_date_row_count@3 THEN false ELSE d_date_min@0 <= 2000-04-29 AND 2000-04-29 <= d_date_max@1 END OR CASE WHEN d_date_null_count@2 = d_date_row_count@3 THEN false ELSE d_date_min@0 <= 2000-09-09 AND 2000-09-09 <= d_date_max@1 END OR CASE WHEN d_date_null_count@2 = d_date_row_count@3 THEN false ELSE d_date_min@0 <= 2000-11-02 AND 2000-11-02 <= d_date_max@1 END, required_guarantees=[N]     |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
