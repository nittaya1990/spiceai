---
source: crates/runtime/benches/bench.rs
description: "Query: select\n        cc_call_center_id Call_Center,\n        cc_name Call_Center_Name,\n        cc_manager Manager,\n        sum(cr_net_loss) Returns_Loss\nfrom\n        call_center,\n        catalog_returns,\n        date_dim,\n        customer,\n        customer_address,\n        customer_demographics,\n        household_demographics\nwhere\n        cr_call_center_sk       = cc_call_center_sk\nand     cr_returned_date_sk     = d_date_sk\nand     cr_returning_customer_sk= c_customer_sk\nand     cd_demo_sk              = c_current_cdemo_sk\nand     hd_demo_sk              = c_current_hdemo_sk\nand     ca_address_sk           = c_current_addr_sk\nand     d_year                  = 2002\nand     d_moy                   = 11\nand     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')\n        or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))\nand     hd_buy_potential like 'Unknown%'\nand     ca_gmt_offset           = -6\ngroup by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\norder by sum(cr_net_loss) desc;\n"
snapshot_kind: text
---
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                             |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Projection: Call_Center, Call_Center_Name, Manager, Returns_Loss                                                                                                                                                                                                                                 |
|               |   Sort: sum(catalog_returns.cr_net_loss) AS Returns_Loss DESC NULLS FIRST                                                                                                                                                                                                                        |
|               |     Projection: call_center.cc_call_center_id AS Call_Center, call_center.cc_name AS Call_Center_Name, call_center.cc_manager AS Manager, sum(catalog_returns.cr_net_loss) AS Returns_Loss, sum(catalog_returns.cr_net_loss)                                                                     |
|               |       Aggregate: groupBy=[[call_center.cc_call_center_id, call_center.cc_name, call_center.cc_manager, customer_demographics.cd_marital_status, customer_demographics.cd_education_status]], aggr=[[sum(catalog_returns.cr_net_loss)]]                                                           |
|               |         Projection: call_center.cc_call_center_id, call_center.cc_name, call_center.cc_manager, catalog_returns.cr_net_loss, customer_demographics.cd_marital_status, customer_demographics.cd_education_status                                                                                  |
|               |           Inner Join: customer.c_current_hdemo_sk = household_demographics.hd_demo_sk                                                                                                                                                                                                            |
|               |             Projection: call_center.cc_call_center_id, call_center.cc_name, call_center.cc_manager, catalog_returns.cr_net_loss, customer.c_current_hdemo_sk, customer_demographics.cd_marital_status, customer_demographics.cd_education_status                                                 |
|               |               Inner Join: customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk                                                                                                                                                                                                         |
|               |                 Projection: call_center.cc_call_center_id, call_center.cc_name, call_center.cc_manager, catalog_returns.cr_net_loss, customer.c_current_cdemo_sk, customer.c_current_hdemo_sk                                                                                                    |
|               |                   Inner Join: customer.c_current_addr_sk = customer_address.ca_address_sk                                                                                                                                                                                                        |
|               |                     Projection: call_center.cc_call_center_id, call_center.cc_name, call_center.cc_manager, catalog_returns.cr_net_loss, customer.c_current_cdemo_sk, customer.c_current_hdemo_sk, customer.c_current_addr_sk                                                                    |
|               |                       Inner Join: catalog_returns.cr_returning_customer_sk = customer.c_customer_sk                                                                                                                                                                                              |
|               |                         Projection: call_center.cc_call_center_id, call_center.cc_name, call_center.cc_manager, catalog_returns.cr_returning_customer_sk, catalog_returns.cr_net_loss                                                                                                            |
|               |                           Inner Join: catalog_returns.cr_returned_date_sk = date_dim.d_date_sk                                                                                                                                                                                                   |
|               |                             Projection: call_center.cc_call_center_id, call_center.cc_name, call_center.cc_manager, catalog_returns.cr_returned_date_sk, catalog_returns.cr_returning_customer_sk, catalog_returns.cr_net_loss                                                                   |
|               |                               Inner Join: call_center.cc_call_center_sk = catalog_returns.cr_call_center_sk                                                                                                                                                                                      |
|               |                                 BytesProcessedNode                                                                                                                                                                                                                                               |
|               |                                   TableScan: call_center projection=[cc_call_center_sk, cc_call_center_id, cc_name, cc_manager]                                                                                                                                                                  |
|               |                                 BytesProcessedNode                                                                                                                                                                                                                                               |
|               |                                   TableScan: catalog_returns projection=[cr_returned_date_sk, cr_returning_customer_sk, cr_call_center_sk, cr_net_loss]                                                                                                                                          |
|               |                             Projection: date_dim.d_date_sk                                                                                                                                                                                                                                       |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                                 |
|               |                                 Filter: date_dim.d_year = Int32(2002) AND date_dim.d_moy = Int32(11)                                                                                                                                                                                             |
|               |                                   TableScan: date_dim projection=[d_date_sk, d_year, d_moy]                                                                                                                                                                                                      |
|               |                         BytesProcessedNode                                                                                                                                                                                                                                                       |
|               |                           TableScan: customer projection=[c_customer_sk, c_current_cdemo_sk, c_current_hdemo_sk, c_current_addr_sk]                                                                                                                                                              |
|               |                     Projection: customer_address.ca_address_sk                                                                                                                                                                                                                                   |
|               |                       BytesProcessedNode                                                                                                                                                                                                                                                         |
|               |                         Filter: customer_address.ca_gmt_offset = Decimal128(Some(-600),5,2)                                                                                                                                                                                                      |
|               |                           TableScan: customer_address projection=[ca_address_sk, ca_gmt_offset]                                                                                                                                                                                                  |
|               |                 BytesProcessedNode                                                                                                                                                                                                                                                               |
|               |                   Filter: customer_demographics.cd_marital_status = LargeUtf8("M") AND customer_demographics.cd_education_status = LargeUtf8("Unknown") OR customer_demographics.cd_marital_status = LargeUtf8("W") AND customer_demographics.cd_education_status = LargeUtf8("Advanced Degree") |
|               |                     TableScan: customer_demographics projection=[cd_demo_sk, cd_marital_status, cd_education_status]                                                                                                                                                                             |
|               |             Projection: household_demographics.hd_demo_sk                                                                                                                                                                                                                                        |
|               |               BytesProcessedNode                                                                                                                                                                                                                                                                 |
|               |                 Filter: household_demographics.hd_buy_potential LIKE LargeUtf8("Unknown%")                                                                                                                                                                                                       |
|               |                   TableScan: household_demographics projection=[hd_demo_sk, hd_buy_potential]                                                                                                                                                                                                    |
| physical_plan | ProjectionExec: expr=[Call_Center@0 as Call_Center, Call_Center_Name@1 as Call_Center_Name, Manager@2 as Manager, Returns_Loss@3 as Returns_Loss]                                                                                                                                                |
|               |   SortPreservingMergeExec: [sum(catalog_returns.cr_net_loss)@4 DESC]                                                                                                                                                                                                                             |
|               |     SortExec: expr=[sum(catalog_returns.cr_net_loss)@4 DESC], preserve_partitioning=[true]                                                                                                                                                                                                       |
|               |       ProjectionExec: expr=[cc_call_center_id@0 as Call_Center, cc_name@1 as Call_Center_Name, cc_manager@2 as Manager, sum(catalog_returns.cr_net_loss)@5 as Returns_Loss, sum(catalog_returns.cr_net_loss)@5 as sum(catalog_returns.cr_net_loss)]                                              |
|               |         AggregateExec: mode=FinalPartitioned, gby=[cc_call_center_id@0 as cc_call_center_id, cc_name@1 as cc_name, cc_manager@2 as cc_manager, cd_marital_status@3 as cd_marital_status, cd_education_status@4 as cd_education_status], aggr=[sum(catalog_returns.cr_net_loss)]                  |
|               |           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                            |
|               |             RepartitionExec: partitioning=Hash([cc_call_center_id@0, cc_name@1, cc_manager@2, cd_marital_status@3, cd_education_status@4], 4), input_partitions=4                                                                                                                                |
|               |               AggregateExec: mode=Partial, gby=[cc_call_center_id@0 as cc_call_center_id, cc_name@1 as cc_name, cc_manager@2 as cc_manager, cd_marital_status@4 as cd_marital_status, cd_education_status@5 as cd_education_status], aggr=[sum(catalog_returns.cr_net_loss)]                     |
|               |                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                      |
|               |                   HashJoinExec: mode=Partitioned, join_type=Inner, on=[(c_current_hdemo_sk@4, hd_demo_sk@0)], projection=[cc_call_center_id@0, cc_name@1, cc_manager@2, cr_net_loss@3, cd_marital_status@5, cd_education_status@6]                                                               |
|               |                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                  |
|               |                       RepartitionExec: partitioning=Hash([c_current_hdemo_sk@4], 4), input_partitions=4                                                                                                                                                                                          |
|               |                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                              |
|               |                           HashJoinExec: mode=Partitioned, join_type=Inner, on=[(c_current_cdemo_sk@4, cd_demo_sk@0)], projection=[cc_call_center_id@0, cc_name@1, cc_manager@2, cr_net_loss@3, c_current_hdemo_sk@5, cd_marital_status@7, cd_education_status@8]                                 |
|               |                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                          |
|               |                               RepartitionExec: partitioning=Hash([c_current_cdemo_sk@4], 4), input_partitions=4                                                                                                                                                                                  |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                      |
|               |                                   HashJoinExec: mode=Partitioned, join_type=Inner, on=[(c_current_addr_sk@6, ca_address_sk@0)], projection=[cc_call_center_id@0, cc_name@1, cc_manager@2, cr_net_loss@3, c_current_cdemo_sk@4, c_current_hdemo_sk@5]                                             |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                  |
|               |                                       RepartitionExec: partitioning=Hash([c_current_addr_sk@6], 4), input_partitions=4                                                                                                                                                                           |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                              |
|               |                                           HashJoinExec: mode=Partitioned, join_type=Inner, on=[(cr_returning_customer_sk@3, c_customer_sk@0)], projection=[cc_call_center_id@0, cc_name@1, cc_manager@2, cr_net_loss@4, c_current_cdemo_sk@6, c_current_hdemo_sk@7, c_current_addr_sk@8]         |
|               |                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                          |
|               |                                               RepartitionExec: partitioning=Hash([cr_returning_customer_sk@3], 4), input_partitions=4                                                                                                                                                            |
|               |                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                      |
|               |                                                   HashJoinExec: mode=Partitioned, join_type=Inner, on=[(cr_returned_date_sk@3, d_date_sk@0)], projection=[cc_call_center_id@0, cc_name@1, cc_manager@2, cr_returning_customer_sk@4, cr_net_loss@5]                                               |
|               |                                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                  |
|               |                                                       RepartitionExec: partitioning=Hash([cr_returned_date_sk@3], 4), input_partitions=4                                                                                                                                                         |
|               |                                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                              |
|               |                                                           HashJoinExec: mode=Partitioned, join_type=Inner, on=[(cc_call_center_sk@0, cr_call_center_sk@2)], projection=[cc_call_center_id@1, cc_name@2, cc_manager@3, cr_returned_date_sk@4, cr_returning_customer_sk@5, cr_net_loss@7]          |
|               |                                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                          |
|               |                                                               RepartitionExec: partitioning=Hash([cc_call_center_sk@0], 4), input_partitions=4                                                                                                                                                   |
|               |                                                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                             |
|               |                                                                   BytesProcessedExec                                                                                                                                                                                                             |
|               |                                                                     SchemaCastScanExec                                                                                                                                                                                                           |
|               |                                                                       MemoryExec: partitions=1, partition_sizes=[1]                                                                                                                                                                              |
|               |                                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                          |
|               |                                                               RepartitionExec: partitioning=Hash([cr_call_center_sk@2], 4), input_partitions=4                                                                                                                                                   |
|               |                                                                 BytesProcessedExec                                                                                                                                                                                                               |
|               |                                                                   SchemaCastScanExec                                                                                                                                                                                                             |
|               |                                                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                         |
|               |                                                                       MemoryExec: partitions=1, partition_sizes=[18]                                                                                                                                                                             |
|               |                                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                  |
|               |                                                       RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                   |
|               |                                                         ProjectionExec: expr=[d_date_sk@0 as d_date_sk]                                                                                                                                                                                          |
|               |                                                           BytesProcessedExec                                                                                                                                                                                                                     |
|               |                                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                          |
|               |                                                               FilterExec: d_year@1 = 2002 AND d_moy@2 = 11                                                                                                                                                                                       |
|               |                                                                 SchemaCastScanExec                                                                                                                                                                                                               |
|               |                                                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                           |
|               |                                                                     MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                |
|               |                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                          |
|               |                                               RepartitionExec: partitioning=Hash([c_customer_sk@0], 4), input_partitions=4                                                                                                                                                                       |
|               |                                                 BytesProcessedExec                                                                                                                                                                                                                               |
|               |                                                   SchemaCastScanExec                                                                                                                                                                                                                             |
|               |                                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                         |
|               |                                                       MemoryExec: partitions=1, partition_sizes=[13]                                                                                                                                                                                             |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                  |
|               |                                       RepartitionExec: partitioning=Hash([ca_address_sk@0], 4), input_partitions=4                                                                                                                                                                               |
|               |                                         ProjectionExec: expr=[ca_address_sk@0 as ca_address_sk]                                                                                                                                                                                                  |
|               |                                           BytesProcessedExec                                                                                                                                                                                                                                     |
|               |                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                          |
|               |                                               FilterExec: ca_gmt_offset@1 = Some(-600),5,2                                                                                                                                                                                                       |
|               |                                                 SchemaCastScanExec                                                                                                                                                                                                                               |
|               |                                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                           |
|               |                                                     MemoryExec: partitions=1, partition_sizes=[7]                                                                                                                                                                                                |
|               |                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                          |
|               |                               RepartitionExec: partitioning=Hash([cd_demo_sk@0], 4), input_partitions=4                                                                                                                                                                                          |
|               |                                 BytesProcessedExec                                                                                                                                                                                                                                               |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                    |
|               |                                     FilterExec: cd_marital_status@1 = M AND cd_education_status@2 = Unknown OR cd_marital_status@1 = W AND cd_education_status@2 = Advanced Degree                                                                                                               |
|               |                                       SchemaCastScanExec                                                                                                                                                                                                                                         |
|               |                                         RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                     |
|               |                                           MemoryExec: partitions=1, partition_sizes=[235]                                                                                                                                                                                                        |
|               |                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                  |
|               |                       RepartitionExec: partitioning=Hash([hd_demo_sk@0], 4), input_partitions=4                                                                                                                                                                                                  |
|               |                         ProjectionExec: expr=[hd_demo_sk@0 as hd_demo_sk]                                                                                                                                                                                                                        |
|               |                           BytesProcessedExec                                                                                                                                                                                                                                                     |
|               |                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                          |
|               |                               FilterExec: hd_buy_potential@1 LIKE Unknown%                                                                                                                                                                                                                       |
|               |                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                             |
|               |                                   SchemaCastScanExec                                                                                                                                                                                                                                             |
|               |                                     MemoryExec: partitions=1, partition_sizes=[1]                                                                                                                                                                                                                |
|               |                                                                                                                                                                                                                                                                                                  |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
