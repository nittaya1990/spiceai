---
source: crates/runtime/benches/bench.rs
description: "Query: with ssr as\n (select s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_sold_date_sk  as date_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from store_sales\n    union all\n    select sr_store_sk as store_sk,\n           sr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns\n   ) salesreturns,\n     date_dim,\n     store\n where date_sk = d_date_sk\n       and d_date between cast('2001-08-04' as date)\n                  and (cast('2001-08-04' as date) + INTERVAL '14 days')\n       and store_sk = s_store_sk\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_sold_date_sk  as date_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from catalog_sales\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns\n   ) salesreturns,\n     date_dim,\n     catalog_page\n where date_sk = d_date_sk\n       and d_date between cast('2001-08-04' as date)\n                  and (cast('2001-08-04' as date) + INTERVAL '14 days')\n       and page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_sold_date_sk  as date_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from web_sales\n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           wr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n   ) salesreturns,\n     date_dim,\n     web_site\n where date_sk = d_date_sk\n       and d_date between cast('2001-08-04' as date)\n                  and (cast('2001-08-04' as date) + INTERVAL '14 days')\n       and wsr_web_site_sk = web_site_sk\n group by web_site_id)\n  select  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from\n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\n group by rollup (channel, id)\n order by channel\n         ,id\n  LIMIT 100;\n"
snapshot_kind: text
---
+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Sort: x.channel ASC NULLS LAST, x.id ASC NULLS LAST, fetch=100                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |   Projection: x.channel, x.id, sum(x.sales) AS sales, sum(x.returns) AS returns, sum(x.profit) AS profit                                                                                                                                                                                                                                                                                                                                                            |
|               |     Aggregate: groupBy=[[ROLLUP (x.channel, x.id)]], aggr=[[sum(x.sales), sum(x.returns), sum(x.profit)]]                                                                                                                                                                                                                                                                                                                                                           |
|               |       SubqueryAlias: x                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |         Union                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |           Projection: Utf8("store channel") AS channel, LargeUtf8("store") || ssr.s_store_id AS id, ssr.sales, ssr.returns, ssr.profit - ssr.profit_loss AS profit                                                                                                                                                                                                                                                                                                  |
|               |             SubqueryAlias: ssr                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |               Projection: store.s_store_id, sum(salesreturns.sales_price) AS sales, sum(salesreturns.profit) AS profit, sum(salesreturns.return_amt) AS returns, sum(salesreturns.net_loss) AS profit_loss                                                                                                                                                                                                                                                          |
|               |                 Aggregate: groupBy=[[store.s_store_id]], aggr=[[sum(salesreturns.sales_price), sum(salesreturns.profit), sum(salesreturns.return_amt), sum(salesreturns.net_loss)]]                                                                                                                                                                                                                                                                                 |
|               |                   Projection: salesreturns.sales_price, salesreturns.profit, salesreturns.return_amt, salesreturns.net_loss, store.s_store_id                                                                                                                                                                                                                                                                                                                       |
|               |                     Inner Join: salesreturns.store_sk = store.s_store_sk                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                       Projection: salesreturns.store_sk, salesreturns.sales_price, salesreturns.profit, salesreturns.return_amt, salesreturns.net_loss                                                                                                                                                                                                                                                                                                              |
|               |                         Inner Join: salesreturns.date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                           SubqueryAlias: salesreturns                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                             Union                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                               Projection: store_sales.ss_store_sk AS store_sk, store_sales.ss_sold_date_sk AS date_sk, store_sales.ss_ext_sales_price AS sales_price, store_sales.ss_net_profit AS profit, Decimal128(Some(0),7,2) AS return_amt, Decimal128(Some(0),7,2) AS net_loss                                                                                                                                                                               |
|               |                                 BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                   TableScan: store_sales projection=[ss_sold_date_sk, ss_store_sk, ss_ext_sales_price, ss_net_profit]                                                                                                                                                                                                                                                                                                                               |
|               |                               Projection: store_returns.sr_store_sk AS store_sk, store_returns.sr_returned_date_sk AS date_sk, Decimal128(Some(0),7,2) AS sales_price, Decimal128(Some(0),7,2) AS profit, store_returns.sr_return_amt AS return_amt, store_returns.sr_net_loss AS net_loss                                                                                                                                                                          |
|               |                                 BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                   TableScan: store_returns projection=[sr_returned_date_sk, sr_store_sk, sr_return_amt, sr_net_loss]                                                                                                                                                                                                                                                                                                                                |
|               |                           BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                             TableScan: date_dim projection=[d_date_sk], full_filters=[date_dim.d_date >= Date32("2001-08-04"), date_dim.d_date <= Date32("2001-08-18")]                                                                                                                                                                                                                                                                                             |
|               |                       BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                         TableScan: store projection=[s_store_sk, s_store_id]                                                                                                                                                                                                                                                                                                                                                                                        |
|               |           Projection: Utf8("catalog channel") AS channel, LargeUtf8("catalog_page") || csr.cp_catalog_page_id AS id, csr.sales, csr.returns, csr.profit - csr.profit_loss AS profit                                                                                                                                                                                                                                                                                 |
|               |             SubqueryAlias: csr                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |               Projection: catalog_page.cp_catalog_page_id, sum(salesreturns.sales_price) AS sales, sum(salesreturns.profit) AS profit, sum(salesreturns.return_amt) AS returns, sum(salesreturns.net_loss) AS profit_loss                                                                                                                                                                                                                                           |
|               |                 Aggregate: groupBy=[[catalog_page.cp_catalog_page_id]], aggr=[[sum(salesreturns.sales_price), sum(salesreturns.profit), sum(salesreturns.return_amt), sum(salesreturns.net_loss)]]                                                                                                                                                                                                                                                                  |
|               |                   Projection: salesreturns.sales_price, salesreturns.profit, salesreturns.return_amt, salesreturns.net_loss, catalog_page.cp_catalog_page_id                                                                                                                                                                                                                                                                                                        |
|               |                     Inner Join: salesreturns.page_sk = catalog_page.cp_catalog_page_sk                                                                                                                                                                                                                                                                                                                                                                              |
|               |                       Projection: salesreturns.page_sk, salesreturns.sales_price, salesreturns.profit, salesreturns.return_amt, salesreturns.net_loss                                                                                                                                                                                                                                                                                                               |
|               |                         Inner Join: salesreturns.date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                           SubqueryAlias: salesreturns                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                             Union                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                               Projection: catalog_sales.cs_catalog_page_sk AS page_sk, catalog_sales.cs_sold_date_sk AS date_sk, catalog_sales.cs_ext_sales_price AS sales_price, catalog_sales.cs_net_profit AS profit, Decimal128(Some(0),7,2) AS return_amt, Decimal128(Some(0),7,2) AS net_loss                                                                                                                                                                 |
|               |                                 BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                   TableScan: catalog_sales projection=[cs_sold_date_sk, cs_catalog_page_sk, cs_ext_sales_price, cs_net_profit]                                                                                                                                                                                                                                                                                                                      |
|               |                               Projection: catalog_returns.cr_catalog_page_sk AS page_sk, catalog_returns.cr_returned_date_sk AS date_sk, Decimal128(Some(0),7,2) AS sales_price, Decimal128(Some(0),7,2) AS profit, catalog_returns.cr_return_amount AS return_amt, catalog_returns.cr_net_loss AS net_loss                                                                                                                                                         |
|               |                                 BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                   TableScan: catalog_returns projection=[cr_returned_date_sk, cr_catalog_page_sk, cr_return_amount, cr_net_loss]                                                                                                                                                                                                                                                                                                                    |
|               |                           BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                             TableScan: date_dim projection=[d_date_sk], full_filters=[date_dim.d_date >= Date32("2001-08-04"), date_dim.d_date <= Date32("2001-08-18")]                                                                                                                                                                                                                                                                                             |
|               |                       BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                         TableScan: catalog_page projection=[cp_catalog_page_sk, cp_catalog_page_id]                                                                                                                                                                                                                                                                                                                                                                 |
|               |           Projection: Utf8("web channel") AS channel, LargeUtf8("web_site") || wsr.web_site_id AS id, wsr.sales, wsr.returns, wsr.profit - wsr.profit_loss AS profit                                                                                                                                                                                                                                                                                                |
|               |             SubqueryAlias: wsr                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |               Projection: web_site.web_site_id, sum(salesreturns.sales_price) AS sales, sum(salesreturns.profit) AS profit, sum(salesreturns.return_amt) AS returns, sum(salesreturns.net_loss) AS profit_loss                                                                                                                                                                                                                                                      |
|               |                 Aggregate: groupBy=[[web_site.web_site_id]], aggr=[[sum(salesreturns.sales_price), sum(salesreturns.profit), sum(salesreturns.return_amt), sum(salesreturns.net_loss)]]                                                                                                                                                                                                                                                                             |
|               |                   Projection: salesreturns.sales_price, salesreturns.profit, salesreturns.return_amt, salesreturns.net_loss, web_site.web_site_id                                                                                                                                                                                                                                                                                                                   |
|               |                     Inner Join: salesreturns.wsr_web_site_sk = web_site.web_site_sk                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                       Projection: salesreturns.wsr_web_site_sk, salesreturns.sales_price, salesreturns.profit, salesreturns.return_amt, salesreturns.net_loss                                                                                                                                                                                                                                                                                                       |
|               |                         Inner Join: salesreturns.date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                           SubqueryAlias: salesreturns                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                             Union                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                               Projection: web_sales.ws_web_site_sk AS wsr_web_site_sk, web_sales.ws_sold_date_sk AS date_sk, web_sales.ws_ext_sales_price AS sales_price, web_sales.ws_net_profit AS profit, Decimal128(Some(0),7,2) AS return_amt, Decimal128(Some(0),7,2) AS net_loss                                                                                                                                                                             |
|               |                                 BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                   TableScan: web_sales projection=[ws_sold_date_sk, ws_web_site_sk, ws_ext_sales_price, ws_net_profit]                                                                                                                                                                                                                                                                                                                              |
|               |                               Projection: web_sales.ws_web_site_sk AS wsr_web_site_sk, web_returns.wr_returned_date_sk AS date_sk, Decimal128(Some(0),7,2) AS sales_price, Decimal128(Some(0),7,2) AS profit, web_returns.wr_return_amt AS return_amt, web_returns.wr_net_loss AS net_loss                                                                                                                                                                          |
|               |                                 Left Join: web_returns.wr_item_sk = web_sales.ws_item_sk, web_returns.wr_order_number = web_sales.ws_order_number                                                                                                                                                                                                                                                                                                                   |
|               |                                   BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                     TableScan: web_returns projection=[wr_returned_date_sk, wr_item_sk, wr_order_number, wr_return_amt, wr_net_loss]                                                                                                                                                                                                                                                                                                                |
|               |                                   BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                     TableScan: web_sales projection=[ws_item_sk, ws_web_site_sk, ws_order_number]                                                                                                                                                                                                                                                                                                                                                   |
|               |                           BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                             TableScan: date_dim projection=[d_date_sk], full_filters=[date_dim.d_date >= Date32("2001-08-04"), date_dim.d_date <= Date32("2001-08-18")]                                                                                                                                                                                                                                                                                             |
|               |                       BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                         TableScan: web_site projection=[web_site_sk, web_site_id]                                                                                                                                                                                                                                                                                                                                                                                   |
| physical_plan | SortPreservingMergeExec: [channel@0 ASC NULLS LAST, id@1 ASC NULLS LAST], fetch=100                                                                                                                                                                                                                                                                                                                                                                                 |
|               |   SortExec: TopK(fetch=100), expr=[channel@0 ASC NULLS LAST, id@1 ASC NULLS LAST], preserve_partitioning=[true]                                                                                                                                                                                                                                                                                                                                                     |
|               |     ProjectionExec: expr=[channel@0 as channel, id@1 as id, sum(x.sales)@3 as sales, sum(x.returns)@4 as returns, sum(x.profit)@5 as profit]                                                                                                                                                                                                                                                                                                                        |
|               |       AggregateExec: mode=FinalPartitioned, gby=[channel@0 as channel, id@1 as id, __grouping_id@2 as __grouping_id], aggr=[sum(x.sales), sum(x.returns), sum(x.profit)]                                                                                                                                                                                                                                                                                            |
|               |         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |           RepartitionExec: partitioning=Hash([channel@0, id@1, __grouping_id@2], 4), input_partitions=12                                                                                                                                                                                                                                                                                                                                                            |
|               |             AggregateExec: mode=Partial, gby=[(NULL as channel, NULL as id), (channel@0 as channel, NULL as id), (channel@0 as channel, id@1 as id)], aggr=[sum(x.sales), sum(x.returns), sum(x.profit)]                                                                                                                                                                                                                                                            |
|               |               UnionExec                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                 ProjectionExec: expr=[store channel as channel, store || s_store_id@0 as id, sales@1 as sales, returns@3 as returns, profit@2 - profit_loss@4 as profit]                                                                                                                                                                                                                                                                                            |
|               |                   ProjectionExec: expr=[s_store_id@0 as s_store_id, sum(salesreturns.sales_price)@1 as sales, sum(salesreturns.profit)@2 as profit, sum(salesreturns.return_amt)@3 as returns, sum(salesreturns.net_loss)@4 as profit_loss]                                                                                                                                                                                                                         |
|               |                     AggregateExec: mode=FinalPartitioned, gby=[s_store_id@0 as s_store_id], aggr=[sum(salesreturns.sales_price), sum(salesreturns.profit), sum(salesreturns.return_amt), sum(salesreturns.net_loss)]                                                                                                                                                                                                                                                |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                         RepartitionExec: partitioning=Hash([s_store_id@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                   |
|               |                           AggregateExec: mode=Partial, gby=[s_store_id@4 as s_store_id], aggr=[sum(salesreturns.sales_price), sum(salesreturns.profit), sum(salesreturns.return_amt), sum(salesreturns.net_loss)]                                                                                                                                                                                                                                                   |
|               |                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                               HashJoinExec: mode=Partitioned, join_type=Inner, on=[(store_sk@0, s_store_sk@0)], projection=[sales_price@1, profit@2, return_amt@3, net_loss@4, s_store_id@6]                                                                                                                                                                                                                                                                        |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                   RepartitionExec: partitioning=Hash([store_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                           |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                       HashJoinExec: mode=Partitioned, join_type=Inner, on=[(date_sk@1, d_date_sk@0)], projection=[store_sk@0, sales_price@2, profit@3, return_amt@4, net_loss@5]                                                                                                                                                                                                                                                                    |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                           RepartitionExec: partitioning=Hash([date_sk@1], 4), input_partitions=8                                                                                                                                                                                                                                                                                                                                                    |
|               |                                             UnionExec                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                               ProjectionExec: expr=[ss_store_sk@1 as store_sk, ss_sold_date_sk@0 as date_sk, ss_ext_sales_price@2 as sales_price, ss_net_profit@3 as profit, Some(0),7,2 as return_amt, Some(0),7,2 as net_loss]                                                                                                                                                                                                                    |
|               |                                                 BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                   ParquetExec: file_groups={4 groups: [[tpcds_sf1/store_sales/store_sales.parquet:0..38551918], [tpcds_sf1/store_sales/store_sales.parquet:38551918..77103836], [tpcds_sf1/store_sales/store_sales.parquet:77103836..115655754], [tpcds_sf1/store_sales/store_sales.parquet:115655754..154207672]]}, projection=[ss_sold_date_sk, ss_store_sk, ss_ext_sales_price, ss_net_profit]                                   |
|               |                                               ProjectionExec: expr=[sr_store_sk@1 as store_sk, sr_returned_date_sk@0 as date_sk, Some(0),7,2 as sales_price, Some(0),7,2 as profit, sr_return_amt@2 as return_amt, sr_net_loss@3 as net_loss]                                                                                                                                                                                                                       |
|               |                                                 BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                   ParquetExec: file_groups={4 groups: [[tpcds_sf1/store_returns/store_returns.parquet:0..4882309], [tpcds_sf1/store_returns/store_returns.parquet:4882309..9764618], [tpcds_sf1/store_returns/store_returns.parquet:9764618..14646927], [tpcds_sf1/store_returns/store_returns.parquet:14646927..19529233]]}, projection=[sr_returned_date_sk, sr_store_sk, sr_return_amt, sr_net_loss]                             |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                           RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                  |
|               |                                             RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                    |
|               |                                               BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                 ParquetExec: file_groups={1 group: [[tpcds_sf1/date_dim/date_dim.parquet]]}, projection=[d_date_sk], predicate=d_date@2 >= 2001-08-04 AND d_date@2 <= 2001-08-18, pruning_predicate=CASE WHEN d_date_null_count@1 = d_date_row_count@2 THEN false ELSE d_date_max@0 >= 2001-08-04 END AND CASE WHEN d_date_null_count@1 = d_date_row_count@2 THEN false ELSE d_date_min@3 <= 2001-08-18 END, required_guarantees=[N] |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                   RepartitionExec: partitioning=Hash([s_store_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                         |
|               |                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                            |
|               |                                       BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                         ParquetExec: file_groups={1 group: [[tpcds_sf1/store/store.parquet]]}, projection=[s_store_sk, s_store_id]                                                                                                                                                                                                                                                                                                                  |
|               |                 ProjectionExec: expr=[catalog channel as channel, catalog_page || cp_catalog_page_id@0 as id, sales@1 as sales, returns@3 as returns, profit@2 - profit_loss@4 as profit]                                                                                                                                                                                                                                                                           |
|               |                   ProjectionExec: expr=[cp_catalog_page_id@0 as cp_catalog_page_id, sum(salesreturns.sales_price)@1 as sales, sum(salesreturns.profit)@2 as profit, sum(salesreturns.return_amt)@3 as returns, sum(salesreturns.net_loss)@4 as profit_loss]                                                                                                                                                                                                         |
|               |                     AggregateExec: mode=FinalPartitioned, gby=[cp_catalog_page_id@0 as cp_catalog_page_id], aggr=[sum(salesreturns.sales_price), sum(salesreturns.profit), sum(salesreturns.return_amt), sum(salesreturns.net_loss)]                                                                                                                                                                                                                                |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                         RepartitionExec: partitioning=Hash([cp_catalog_page_id@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                           |
|               |                           AggregateExec: mode=Partial, gby=[cp_catalog_page_id@4 as cp_catalog_page_id], aggr=[sum(salesreturns.sales_price), sum(salesreturns.profit), sum(salesreturns.return_amt), sum(salesreturns.net_loss)]                                                                                                                                                                                                                                   |
|               |                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                               HashJoinExec: mode=Partitioned, join_type=Inner, on=[(page_sk@0, cp_catalog_page_sk@0)], projection=[sales_price@1, profit@2, return_amt@3, net_loss@4, cp_catalog_page_id@6]                                                                                                                                                                                                                                                         |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                   RepartitionExec: partitioning=Hash([page_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                            |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                       HashJoinExec: mode=Partitioned, join_type=Inner, on=[(date_sk@1, d_date_sk@0)], projection=[page_sk@0, sales_price@2, profit@3, return_amt@4, net_loss@5]                                                                                                                                                                                                                                                                     |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                           RepartitionExec: partitioning=Hash([date_sk@1], 4), input_partitions=8                                                                                                                                                                                                                                                                                                                                                    |
|               |                                             UnionExec                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                               ProjectionExec: expr=[cs_catalog_page_sk@1 as page_sk, cs_sold_date_sk@0 as date_sk, cs_ext_sales_price@2 as sales_price, cs_net_profit@3 as profit, Some(0),7,2 as return_amt, Some(0),7,2 as net_loss]                                                                                                                                                                                                              |
|               |                                                 BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                   ParquetExec: file_groups={4 groups: [[tpcds_sf1/catalog_sales/catalog_sales.parquet:0..28908415], [tpcds_sf1/catalog_sales/catalog_sales.parquet:28908415..57816830], [tpcds_sf1/catalog_sales/catalog_sales.parquet:57816830..86725245], [tpcds_sf1/catalog_sales/catalog_sales.parquet:86725245..115633658]]}, projection=[cs_sold_date_sk, cs_catalog_page_sk, cs_ext_sales_price, cs_net_profit]              |
|               |                                               ProjectionExec: expr=[cr_catalog_page_sk@1 as page_sk, cr_returned_date_sk@0 as date_sk, Some(0),7,2 as sales_price, Some(0),7,2 as profit, cr_return_amount@2 as return_amt, cr_net_loss@3 as net_loss]                                                                                                                                                                                                              |
|               |                                                 BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                   ParquetExec: file_groups={4 groups: [[tpcds_sf1/catalog_returns/catalog_returns.parquet:0..3106858], [tpcds_sf1/catalog_returns/catalog_returns.parquet:3106858..6213716], [tpcds_sf1/catalog_returns/catalog_returns.parquet:6213716..9320574], [tpcds_sf1/catalog_returns/catalog_returns.parquet:9320574..12427432]]}, projection=[cr_returned_date_sk, cr_catalog_page_sk, cr_return_amount, cr_net_loss]     |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                           RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                  |
|               |                                             RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                    |
|               |                                               BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                 ParquetExec: file_groups={1 group: [[tpcds_sf1/date_dim/date_dim.parquet]]}, projection=[d_date_sk], predicate=d_date@2 >= 2001-08-04 AND d_date@2 <= 2001-08-18, pruning_predicate=CASE WHEN d_date_null_count@1 = d_date_row_count@2 THEN false ELSE d_date_max@0 >= 2001-08-04 END AND CASE WHEN d_date_null_count@1 = d_date_row_count@2 THEN false ELSE d_date_min@3 <= 2001-08-18 END, required_guarantees=[N] |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                   RepartitionExec: partitioning=Hash([cp_catalog_page_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                 |
|               |                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                            |
|               |                                       BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                         ParquetExec: file_groups={1 group: [[tpcds_sf1/catalog_page/catalog_page.parquet]]}, projection=[cp_catalog_page_sk, cp_catalog_page_id]                                                                                                                                                                                                                                                                                    |
|               |                 ProjectionExec: expr=[web channel as channel, web_site || web_site_id@0 as id, sales@1 as sales, returns@3 as returns, profit@2 - profit_loss@4 as profit]                                                                                                                                                                                                                                                                                          |
|               |                   ProjectionExec: expr=[web_site_id@0 as web_site_id, sum(salesreturns.sales_price)@1 as sales, sum(salesreturns.profit)@2 as profit, sum(salesreturns.return_amt)@3 as returns, sum(salesreturns.net_loss)@4 as profit_loss]                                                                                                                                                                                                                       |
|               |                     AggregateExec: mode=FinalPartitioned, gby=[web_site_id@0 as web_site_id], aggr=[sum(salesreturns.sales_price), sum(salesreturns.profit), sum(salesreturns.return_amt), sum(salesreturns.net_loss)]                                                                                                                                                                                                                                              |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                         RepartitionExec: partitioning=Hash([web_site_id@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                  |
|               |                           AggregateExec: mode=Partial, gby=[web_site_id@4 as web_site_id], aggr=[sum(salesreturns.sales_price), sum(salesreturns.profit), sum(salesreturns.return_amt), sum(salesreturns.net_loss)]                                                                                                                                                                                                                                                 |
|               |                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                               HashJoinExec: mode=Partitioned, join_type=Inner, on=[(wsr_web_site_sk@0, web_site_sk@0)], projection=[sales_price@1, profit@2, return_amt@3, net_loss@4, web_site_id@6]                                                                                                                                                                                                                                                               |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                   RepartitionExec: partitioning=Hash([wsr_web_site_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                    |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                       HashJoinExec: mode=Partitioned, join_type=Inner, on=[(date_sk@1, d_date_sk@0)], projection=[wsr_web_site_sk@0, sales_price@2, profit@3, return_amt@4, net_loss@5]                                                                                                                                                                                                                                                             |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                           RepartitionExec: partitioning=Hash([date_sk@1], 4), input_partitions=8                                                                                                                                                                                                                                                                                                                                                    |
|               |                                             UnionExec                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                                               ProjectionExec: expr=[ws_web_site_sk@1 as wsr_web_site_sk, ws_sold_date_sk@0 as date_sk, ws_ext_sales_price@2 as sales_price, ws_net_profit@3 as profit, Some(0),7,2 as return_amt, Some(0),7,2 as net_loss]                                                                                                                                                                                                          |
|               |                                                 BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                                   ParquetExec: file_groups={4 groups: [[tpcds_sf1/web_sales/web_sales.parquet:0..14558527], [tpcds_sf1/web_sales/web_sales.parquet:14558527..29117054], [tpcds_sf1/web_sales/web_sales.parquet:29117054..43675581], [tpcds_sf1/web_sales/web_sales.parquet:43675581..58234107]]}, projection=[ws_sold_date_sk, ws_web_site_sk, ws_ext_sales_price, ws_net_profit]                                                   |
|               |                                               ProjectionExec: expr=[ws_web_site_sk@6 as wsr_web_site_sk, wr_returned_date_sk@0 as date_sk, Some(0),7,2 as sales_price, Some(0),7,2 as profit, wr_return_amt@3 as return_amt, wr_net_loss@4 as net_loss]                                                                                                                                                                                                             |
|               |                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                                   HashJoinExec: mode=Partitioned, join_type=Left, on=[(wr_item_sk@1, ws_item_sk@0), (wr_order_number@2, ws_order_number@2)]                                                                                                                                                                                                                                                                                         |
|               |                                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                       RepartitionExec: partitioning=Hash([wr_item_sk@1, wr_order_number@2], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                  |
|               |                                                         RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                        |
|               |                                                           BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                                             ParquetExec: file_groups={1 group: [[tpcds_sf1/web_returns/web_returns.parquet]]}, projection=[wr_returned_date_sk, wr_item_sk, wr_order_number, wr_return_amt, wr_net_loss]                                                                                                                                                                                                                            |
|               |                                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                                       RepartitionExec: partitioning=Hash([ws_item_sk@0, ws_order_number@2], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                  |
|               |                                                         BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                                           ParquetExec: file_groups={4 groups: [[tpcds_sf1/web_sales/web_sales.parquet:0..14558527], [tpcds_sf1/web_sales/web_sales.parquet:14558527..29117054], [tpcds_sf1/web_sales/web_sales.parquet:29117054..43675581], [tpcds_sf1/web_sales/web_sales.parquet:43675581..58234107]]}, projection=[ws_item_sk, ws_web_site_sk, ws_order_number]                                                                  |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                           RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                  |
|               |                                             RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                    |
|               |                                               BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                 ParquetExec: file_groups={1 group: [[tpcds_sf1/date_dim/date_dim.parquet]]}, projection=[d_date_sk], predicate=d_date@2 >= 2001-08-04 AND d_date@2 <= 2001-08-18, pruning_predicate=CASE WHEN d_date_null_count@1 = d_date_row_count@2 THEN false ELSE d_date_max@0 >= 2001-08-04 END AND CASE WHEN d_date_null_count@1 = d_date_row_count@2 THEN false ELSE d_date_min@3 <= 2001-08-18 END, required_guarantees=[N] |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                                   RepartitionExec: partitioning=Hash([web_site_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                        |
|               |                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                            |
|               |                                       BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                         ParquetExec: file_groups={1 group: [[tpcds_sf1/web_site/web_site.parquet]]}, projection=[web_site_sk, web_site_id]                                                                                                                                                                                                                                                                                                          |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
