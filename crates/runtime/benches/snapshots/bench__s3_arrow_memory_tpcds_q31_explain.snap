---
source: crates/runtime/benches/bench.rs
description: "Query: with ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select\n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1999\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1999\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1999\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1999\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1999\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1999\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end\n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n order by ss1.ca_county;\n"
snapshot_kind: text
---
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                 |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Sort: ss1.ca_county ASC NULLS LAST                                                                                                                                                                                                                                                                                                                                                   |
|               |   Projection: ss1.ca_county, ss1.d_year, ws2.web_sales / ws1.web_sales AS web_q1_q2_increase, ss2.store_sales / ss1.store_sales AS store_q1_q2_increase, ws3.web_sales / ws2.web_sales AS web_q2_q3_increase, ss3.store_sales / ss2.store_sales AS store_q2_q3_increase                                                                                                              |
|               |     Inner Join: ws1.ca_county = ws3.ca_county Filter: CASE WHEN ws2.web_sales > Decimal128(Some(0),17,2) THEN ws3.web_sales / ws2.web_sales ELSE Decimal128(None,23,6) END > CASE WHEN ss2.store_sales > Decimal128(Some(0),17,2) THEN ss3.store_sales / ss2.store_sales ELSE Decimal128(None,23,6) END                                                                              |
|               |       Projection: ss1.ca_county, ss1.d_year, ss1.store_sales, ss2.store_sales, ss3.store_sales, ws1.ca_county, ws1.web_sales, ws2.web_sales                                                                                                                                                                                                                                          |
|               |         Inner Join: ws1.ca_county = ws2.ca_county Filter: CASE WHEN ws1.web_sales > Decimal128(Some(0),17,2) THEN ws2.web_sales / ws1.web_sales ELSE Decimal128(None,23,6) END > CASE WHEN ss1.store_sales > Decimal128(Some(0),17,2) THEN ss2.store_sales / ss1.store_sales ELSE Decimal128(None,23,6) END                                                                          |
|               |           Inner Join: ss1.ca_county = ws1.ca_county                                                                                                                                                                                                                                                                                                                                  |
|               |             Projection: ss1.ca_county, ss1.d_year, ss1.store_sales, ss2.store_sales, ss3.store_sales                                                                                                                                                                                                                                                                                 |
|               |               Inner Join: ss2.ca_county = ss3.ca_county                                                                                                                                                                                                                                                                                                                              |
|               |                 Inner Join: ss1.ca_county = ss2.ca_county                                                                                                                                                                                                                                                                                                                            |
|               |                   SubqueryAlias: ss1                                                                                                                                                                                                                                                                                                                                                 |
|               |                     SubqueryAlias: ss                                                                                                                                                                                                                                                                                                                                                |
|               |                       Projection: customer_address.ca_county, date_dim.d_year, sum(store_sales.ss_ext_sales_price) AS store_sales                                                                                                                                                                                                                                                    |
|               |                         Aggregate: groupBy=[[customer_address.ca_county, date_dim.d_qoy, date_dim.d_year]], aggr=[[sum(store_sales.ss_ext_sales_price)]]                                                                                                                                                                                                                             |
|               |                           Projection: store_sales.ss_ext_sales_price, date_dim.d_year, date_dim.d_qoy, customer_address.ca_county                                                                                                                                                                                                                                                    |
|               |                             Inner Join: store_sales.ss_addr_sk = customer_address.ca_address_sk                                                                                                                                                                                                                                                                                      |
|               |                               Projection: store_sales.ss_addr_sk, store_sales.ss_ext_sales_price, date_dim.d_year, date_dim.d_qoy                                                                                                                                                                                                                                                    |
|               |                                 Inner Join: store_sales.ss_sold_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                                                         |
|               |                                   BytesProcessedNode                                                                                                                                                                                                                                                                                                                                 |
|               |                                     TableScan: store_sales projection=[ss_sold_date_sk, ss_addr_sk, ss_ext_sales_price]                                                                                                                                                                                                                                                              |
|               |                                   BytesProcessedNode                                                                                                                                                                                                                                                                                                                                 |
|               |                                     Filter: date_dim.d_qoy = Int32(1) AND date_dim.d_year = Int32(1999)                                                                                                                                                                                                                                                                              |
|               |                                       TableScan: date_dim projection=[d_date_sk, d_year, d_qoy]                                                                                                                                                                                                                                                                                      |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                     |
|               |                                 TableScan: customer_address projection=[ca_address_sk, ca_county]                                                                                                                                                                                                                                                                                    |
|               |                   SubqueryAlias: ss2                                                                                                                                                                                                                                                                                                                                                 |
|               |                     SubqueryAlias: ss                                                                                                                                                                                                                                                                                                                                                |
|               |                       Projection: customer_address.ca_county, sum(store_sales.ss_ext_sales_price) AS store_sales                                                                                                                                                                                                                                                                     |
|               |                         Aggregate: groupBy=[[customer_address.ca_county, date_dim.d_qoy, date_dim.d_year]], aggr=[[sum(store_sales.ss_ext_sales_price)]]                                                                                                                                                                                                                             |
|               |                           Projection: store_sales.ss_ext_sales_price, date_dim.d_year, date_dim.d_qoy, customer_address.ca_county                                                                                                                                                                                                                                                    |
|               |                             Inner Join: store_sales.ss_addr_sk = customer_address.ca_address_sk                                                                                                                                                                                                                                                                                      |
|               |                               Projection: store_sales.ss_addr_sk, store_sales.ss_ext_sales_price, date_dim.d_year, date_dim.d_qoy                                                                                                                                                                                                                                                    |
|               |                                 Inner Join: store_sales.ss_sold_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                                                         |
|               |                                   BytesProcessedNode                                                                                                                                                                                                                                                                                                                                 |
|               |                                     TableScan: store_sales projection=[ss_sold_date_sk, ss_addr_sk, ss_ext_sales_price]                                                                                                                                                                                                                                                              |
|               |                                   BytesProcessedNode                                                                                                                                                                                                                                                                                                                                 |
|               |                                     Filter: date_dim.d_qoy = Int32(2) AND date_dim.d_year = Int32(1999)                                                                                                                                                                                                                                                                              |
|               |                                       TableScan: date_dim projection=[d_date_sk, d_year, d_qoy]                                                                                                                                                                                                                                                                                      |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                     |
|               |                                 TableScan: customer_address projection=[ca_address_sk, ca_county]                                                                                                                                                                                                                                                                                    |
|               |                 SubqueryAlias: ss3                                                                                                                                                                                                                                                                                                                                                   |
|               |                   SubqueryAlias: ss                                                                                                                                                                                                                                                                                                                                                  |
|               |                     Projection: customer_address.ca_county, sum(store_sales.ss_ext_sales_price) AS store_sales                                                                                                                                                                                                                                                                       |
|               |                       Aggregate: groupBy=[[customer_address.ca_county, date_dim.d_qoy, date_dim.d_year]], aggr=[[sum(store_sales.ss_ext_sales_price)]]                                                                                                                                                                                                                               |
|               |                         Projection: store_sales.ss_ext_sales_price, date_dim.d_year, date_dim.d_qoy, customer_address.ca_county                                                                                                                                                                                                                                                      |
|               |                           Inner Join: store_sales.ss_addr_sk = customer_address.ca_address_sk                                                                                                                                                                                                                                                                                        |
|               |                             Projection: store_sales.ss_addr_sk, store_sales.ss_ext_sales_price, date_dim.d_year, date_dim.d_qoy                                                                                                                                                                                                                                                      |
|               |                               Inner Join: store_sales.ss_sold_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                                                           |
|               |                                 BytesProcessedNode                                                                                                                                                                                                                                                                                                                                   |
|               |                                   TableScan: store_sales projection=[ss_sold_date_sk, ss_addr_sk, ss_ext_sales_price]                                                                                                                                                                                                                                                                |
|               |                                 BytesProcessedNode                                                                                                                                                                                                                                                                                                                                   |
|               |                                   Filter: date_dim.d_qoy = Int32(3) AND date_dim.d_year = Int32(1999)                                                                                                                                                                                                                                                                                |
|               |                                     TableScan: date_dim projection=[d_date_sk, d_year, d_qoy]                                                                                                                                                                                                                                                                                        |
|               |                             BytesProcessedNode                                                                                                                                                                                                                                                                                                                                       |
|               |                               TableScan: customer_address projection=[ca_address_sk, ca_county]                                                                                                                                                                                                                                                                                      |
|               |             SubqueryAlias: ws1                                                                                                                                                                                                                                                                                                                                                       |
|               |               SubqueryAlias: ws                                                                                                                                                                                                                                                                                                                                                      |
|               |                 Projection: customer_address.ca_county, sum(web_sales.ws_ext_sales_price) AS web_sales                                                                                                                                                                                                                                                                               |
|               |                   Aggregate: groupBy=[[customer_address.ca_county, date_dim.d_qoy, date_dim.d_year]], aggr=[[sum(web_sales.ws_ext_sales_price)]]                                                                                                                                                                                                                                     |
|               |                     Projection: web_sales.ws_ext_sales_price, date_dim.d_year, date_dim.d_qoy, customer_address.ca_county                                                                                                                                                                                                                                                            |
|               |                       Inner Join: web_sales.ws_bill_addr_sk = customer_address.ca_address_sk                                                                                                                                                                                                                                                                                         |
|               |                         Projection: web_sales.ws_bill_addr_sk, web_sales.ws_ext_sales_price, date_dim.d_year, date_dim.d_qoy                                                                                                                                                                                                                                                         |
|               |                           Inner Join: web_sales.ws_sold_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                                                                 |
|               |                             BytesProcessedNode                                                                                                                                                                                                                                                                                                                                       |
|               |                               TableScan: web_sales projection=[ws_sold_date_sk, ws_bill_addr_sk, ws_ext_sales_price]                                                                                                                                                                                                                                                                 |
|               |                             BytesProcessedNode                                                                                                                                                                                                                                                                                                                                       |
|               |                               Filter: date_dim.d_qoy = Int32(1) AND date_dim.d_year = Int32(1999)                                                                                                                                                                                                                                                                                    |
|               |                                 TableScan: date_dim projection=[d_date_sk, d_year, d_qoy]                                                                                                                                                                                                                                                                                            |
|               |                         BytesProcessedNode                                                                                                                                                                                                                                                                                                                                           |
|               |                           TableScan: customer_address projection=[ca_address_sk, ca_county]                                                                                                                                                                                                                                                                                          |
|               |           SubqueryAlias: ws2                                                                                                                                                                                                                                                                                                                                                         |
|               |             SubqueryAlias: ws                                                                                                                                                                                                                                                                                                                                                        |
|               |               Projection: customer_address.ca_county, sum(web_sales.ws_ext_sales_price) AS web_sales                                                                                                                                                                                                                                                                                 |
|               |                 Aggregate: groupBy=[[customer_address.ca_county, date_dim.d_qoy, date_dim.d_year]], aggr=[[sum(web_sales.ws_ext_sales_price)]]                                                                                                                                                                                                                                       |
|               |                   Projection: web_sales.ws_ext_sales_price, date_dim.d_year, date_dim.d_qoy, customer_address.ca_county                                                                                                                                                                                                                                                              |
|               |                     Inner Join: web_sales.ws_bill_addr_sk = customer_address.ca_address_sk                                                                                                                                                                                                                                                                                           |
|               |                       Projection: web_sales.ws_bill_addr_sk, web_sales.ws_ext_sales_price, date_dim.d_year, date_dim.d_qoy                                                                                                                                                                                                                                                           |
|               |                         Inner Join: web_sales.ws_sold_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                                                                   |
|               |                           BytesProcessedNode                                                                                                                                                                                                                                                                                                                                         |
|               |                             TableScan: web_sales projection=[ws_sold_date_sk, ws_bill_addr_sk, ws_ext_sales_price]                                                                                                                                                                                                                                                                   |
|               |                           BytesProcessedNode                                                                                                                                                                                                                                                                                                                                         |
|               |                             Filter: date_dim.d_qoy = Int32(2) AND date_dim.d_year = Int32(1999)                                                                                                                                                                                                                                                                                      |
|               |                               TableScan: date_dim projection=[d_date_sk, d_year, d_qoy]                                                                                                                                                                                                                                                                                              |
|               |                       BytesProcessedNode                                                                                                                                                                                                                                                                                                                                             |
|               |                         TableScan: customer_address projection=[ca_address_sk, ca_county]                                                                                                                                                                                                                                                                                            |
|               |       SubqueryAlias: ws3                                                                                                                                                                                                                                                                                                                                                             |
|               |         SubqueryAlias: ws                                                                                                                                                                                                                                                                                                                                                            |
|               |           Projection: customer_address.ca_county, sum(web_sales.ws_ext_sales_price) AS web_sales                                                                                                                                                                                                                                                                                     |
|               |             Aggregate: groupBy=[[customer_address.ca_county, date_dim.d_qoy, date_dim.d_year]], aggr=[[sum(web_sales.ws_ext_sales_price)]]                                                                                                                                                                                                                                           |
|               |               Projection: web_sales.ws_ext_sales_price, date_dim.d_year, date_dim.d_qoy, customer_address.ca_county                                                                                                                                                                                                                                                                  |
|               |                 Inner Join: web_sales.ws_bill_addr_sk = customer_address.ca_address_sk                                                                                                                                                                                                                                                                                               |
|               |                   Projection: web_sales.ws_bill_addr_sk, web_sales.ws_ext_sales_price, date_dim.d_year, date_dim.d_qoy                                                                                                                                                                                                                                                               |
|               |                     Inner Join: web_sales.ws_sold_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                                                                       |
|               |                       BytesProcessedNode                                                                                                                                                                                                                                                                                                                                             |
|               |                         TableScan: web_sales projection=[ws_sold_date_sk, ws_bill_addr_sk, ws_ext_sales_price]                                                                                                                                                                                                                                                                       |
|               |                       BytesProcessedNode                                                                                                                                                                                                                                                                                                                                             |
|               |                         Filter: date_dim.d_qoy = Int32(3) AND date_dim.d_year = Int32(1999)                                                                                                                                                                                                                                                                                          |
|               |                           TableScan: date_dim projection=[d_date_sk, d_year, d_qoy]                                                                                                                                                                                                                                                                                                  |
|               |                   BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                 |
|               |                     TableScan: customer_address projection=[ca_address_sk, ca_county]                                                                                                                                                                                                                                                                                                |
| physical_plan | SortPreservingMergeExec: [ca_county@0 ASC NULLS LAST]                                                                                                                                                                                                                                                                                                                                |
|               |   SortExec: expr=[ca_county@0 ASC NULLS LAST], preserve_partitioning=[true]                                                                                                                                                                                                                                                                                                          |
|               |     ProjectionExec: expr=[ca_county@0 as ca_county, d_year@1 as d_year, web_sales@6 / web_sales@5 as web_q1_q2_increase, store_sales@3 / store_sales@2 as store_q1_q2_increase, web_sales@7 / web_sales@6 as web_q2_q3_increase, store_sales@4 / store_sales@3 as store_q2_q3_increase]                                                                                              |
|               |       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                    |
|               |         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ca_county@5, ca_county@0)], filter=CASE WHEN web_sales@2 > Some(0),17,2 THEN web_sales@3 / web_sales@2 END > CASE WHEN store_sales@0 > Some(0),17,2 THEN store_sales@1 / store_sales@0 END, projection=[ca_county@0, d_year@1, store_sales@2, store_sales@3, store_sales@4, web_sales@6, web_sales@7, web_sales@9]     |
|               |           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                |
|               |             HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ca_county@5, ca_county@0)], filter=CASE WHEN web_sales@2 > Some(0),17,2 THEN web_sales@3 / web_sales@2 END > CASE WHEN store_sales@0 > Some(0),17,2 THEN store_sales@1 / store_sales@0 END, projection=[ca_county@0, d_year@1, store_sales@2, store_sales@3, store_sales@4, ca_county@5, web_sales@6, web_sales@8] |
|               |               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                            |
|               |                 HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ca_county@0, ca_county@0)]                                                                                                                                                                                                                                                                                     |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                        |
|               |                     HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ca_county@3, ca_county@0)], projection=[ca_county@0, d_year@1, store_sales@2, store_sales@4, store_sales@6]                                                                                                                                                                                                |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                    |
|               |                         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ca_county@0, ca_county@0)]                                                                                                                                                                                                                                                                             |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                |
|               |                             RepartitionExec: partitioning=Hash([ca_county@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                 |
|               |                               ProjectionExec: expr=[ca_county@0 as ca_county, d_year@2 as d_year, sum(store_sales.ss_ext_sales_price)@3 as store_sales]                                                                                                                                                                                                                              |
|               |                                 AggregateExec: mode=FinalPartitioned, gby=[ca_county@0 as ca_county, d_qoy@1 as d_qoy, d_year@2 as d_year], aggr=[sum(store_sales.ss_ext_sales_price)]                                                                                                                                                                                               |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                        |
|               |                                     RepartitionExec: partitioning=Hash([ca_county@0, d_qoy@1, d_year@2], 4), input_partitions=4                                                                                                                                                                                                                                                      |
|               |                                       AggregateExec: mode=Partial, gby=[ca_county@3 as ca_county, d_qoy@2 as d_qoy, d_year@1 as d_year], aggr=[sum(store_sales.ss_ext_sales_price)]                                                                                                                                                                                                  |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                  |
|               |                                           HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_addr_sk@0, ca_address_sk@0)], projection=[ss_ext_sales_price@1, d_year@2, d_qoy@3, ca_county@5]                                                                                                                                                                                   |
|               |                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                              |
|               |                                               RepartitionExec: partitioning=Hash([ss_addr_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                              |
|               |                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                          |
|               |                                                   HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_sold_date_sk@0, d_date_sk@0)], projection=[ss_addr_sk@1, ss_ext_sales_price@2, d_year@4, d_qoy@5]                                                                                                                                                                         |
|               |                                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                      |
|               |                                                       RepartitionExec: partitioning=Hash([ss_sold_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                 |
|               |                                                         BytesProcessedExec                                                                                                                                                                                                                                                                                                           |
|               |                                                           SchemaCastScanExec                                                                                                                                                                                                                                                                                                         |
|               |                                                             RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                     |
|               |                                                               MemoryExec: partitions=1, partition_sizes=[352]                                                                                                                                                                                                                                                                        |
|               |                                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                      |
|               |                                                       RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                       |
|               |                                                         BytesProcessedExec                                                                                                                                                                                                                                                                                                           |
|               |                                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                |
|               |                                                             FilterExec: d_qoy@2 = 1 AND d_year@1 = 1999                                                                                                                                                                                                                                                                              |
|               |                                                               SchemaCastScanExec                                                                                                                                                                                                                                                                                                     |
|               |                                                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                 |
|               |                                                                   MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                                                                                      |
|               |                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                              |
|               |                                               RepartitionExec: partitioning=Hash([ca_address_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                           |
|               |                                                 BytesProcessedExec                                                                                                                                                                                                                                                                                                                   |
|               |                                                   SchemaCastScanExec                                                                                                                                                                                                                                                                                                                 |
|               |                                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                             |
|               |                                                       MemoryExec: partitions=1, partition_sizes=[7]                                                                                                                                                                                                                                                                                  |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                |
|               |                             RepartitionExec: partitioning=Hash([ca_county@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                 |
|               |                               ProjectionExec: expr=[ca_county@0 as ca_county, sum(store_sales.ss_ext_sales_price)@3 as store_sales]                                                                                                                                                                                                                                                  |
|               |                                 AggregateExec: mode=FinalPartitioned, gby=[ca_county@0 as ca_county, d_qoy@1 as d_qoy, d_year@2 as d_year], aggr=[sum(store_sales.ss_ext_sales_price)]                                                                                                                                                                                               |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                        |
|               |                                     RepartitionExec: partitioning=Hash([ca_county@0, d_qoy@1, d_year@2], 4), input_partitions=4                                                                                                                                                                                                                                                      |
|               |                                       AggregateExec: mode=Partial, gby=[ca_county@3 as ca_county, d_qoy@2 as d_qoy, d_year@1 as d_year], aggr=[sum(store_sales.ss_ext_sales_price)]                                                                                                                                                                                                  |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                  |
|               |                                           HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_addr_sk@0, ca_address_sk@0)], projection=[ss_ext_sales_price@1, d_year@2, d_qoy@3, ca_county@5]                                                                                                                                                                                   |
|               |                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                              |
|               |                                               RepartitionExec: partitioning=Hash([ss_addr_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                              |
|               |                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                          |
|               |                                                   HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_sold_date_sk@0, d_date_sk@0)], projection=[ss_addr_sk@1, ss_ext_sales_price@2, d_year@4, d_qoy@5]                                                                                                                                                                         |
|               |                                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                      |
|               |                                                       RepartitionExec: partitioning=Hash([ss_sold_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                 |
|               |                                                         BytesProcessedExec                                                                                                                                                                                                                                                                                                           |
|               |                                                           SchemaCastScanExec                                                                                                                                                                                                                                                                                                         |
|               |                                                             RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                     |
|               |                                                               MemoryExec: partitions=1, partition_sizes=[352]                                                                                                                                                                                                                                                                        |
|               |                                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                      |
|               |                                                       RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                       |
|               |                                                         BytesProcessedExec                                                                                                                                                                                                                                                                                                           |
|               |                                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                |
|               |                                                             FilterExec: d_qoy@2 = 2 AND d_year@1 = 1999                                                                                                                                                                                                                                                                              |
|               |                                                               SchemaCastScanExec                                                                                                                                                                                                                                                                                                     |
|               |                                                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                 |
|               |                                                                   MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                                                                                      |
|               |                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                              |
|               |                                               RepartitionExec: partitioning=Hash([ca_address_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                           |
|               |                                                 BytesProcessedExec                                                                                                                                                                                                                                                                                                                   |
|               |                                                   SchemaCastScanExec                                                                                                                                                                                                                                                                                                                 |
|               |                                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                             |
|               |                                                       MemoryExec: partitions=1, partition_sizes=[7]                                                                                                                                                                                                                                                                                  |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                    |
|               |                         RepartitionExec: partitioning=Hash([ca_county@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                     |
|               |                           ProjectionExec: expr=[ca_county@0 as ca_county, sum(store_sales.ss_ext_sales_price)@3 as store_sales]                                                                                                                                                                                                                                                      |
|               |                             AggregateExec: mode=FinalPartitioned, gby=[ca_county@0 as ca_county, d_qoy@1 as d_qoy, d_year@2 as d_year], aggr=[sum(store_sales.ss_ext_sales_price)]                                                                                                                                                                                                   |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                            |
|               |                                 RepartitionExec: partitioning=Hash([ca_county@0, d_qoy@1, d_year@2], 4), input_partitions=4                                                                                                                                                                                                                                                          |
|               |                                   AggregateExec: mode=Partial, gby=[ca_county@3 as ca_county, d_qoy@2 as d_qoy, d_year@1 as d_year], aggr=[sum(store_sales.ss_ext_sales_price)]                                                                                                                                                                                                      |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                      |
|               |                                       HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_addr_sk@0, ca_address_sk@0)], projection=[ss_ext_sales_price@1, d_year@2, d_qoy@3, ca_county@5]                                                                                                                                                                                       |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                  |
|               |                                           RepartitionExec: partitioning=Hash([ss_addr_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                  |
|               |                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                              |
|               |                                               HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_sold_date_sk@0, d_date_sk@0)], projection=[ss_addr_sk@1, ss_ext_sales_price@2, d_year@4, d_qoy@5]                                                                                                                                                                             |
|               |                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                          |
|               |                                                   RepartitionExec: partitioning=Hash([ss_sold_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                     |
|               |                                                     BytesProcessedExec                                                                                                                                                                                                                                                                                                               |
|               |                                                       SchemaCastScanExec                                                                                                                                                                                                                                                                                                             |
|               |                                                         RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                         |
|               |                                                           MemoryExec: partitions=1, partition_sizes=[352]                                                                                                                                                                                                                                                                            |
|               |                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                          |
|               |                                                   RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                           |
|               |                                                     BytesProcessedExec                                                                                                                                                                                                                                                                                                               |
|               |                                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                    |
|               |                                                         FilterExec: d_qoy@2 = 3 AND d_year@1 = 1999                                                                                                                                                                                                                                                                                  |
|               |                                                           SchemaCastScanExec                                                                                                                                                                                                                                                                                                         |
|               |                                                             RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                     |
|               |                                                               MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                                                                                          |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                  |
|               |                                           RepartitionExec: partitioning=Hash([ca_address_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                               |
|               |                                             BytesProcessedExec                                                                                                                                                                                                                                                                                                                       |
|               |                                               SchemaCastScanExec                                                                                                                                                                                                                                                                                                                     |
|               |                                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                 |
|               |                                                   MemoryExec: partitions=1, partition_sizes=[7]                                                                                                                                                                                                                                                                                      |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                        |
|               |                     RepartitionExec: partitioning=Hash([ca_county@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                         |
|               |                       ProjectionExec: expr=[ca_county@0 as ca_county, sum(web_sales.ws_ext_sales_price)@3 as web_sales]                                                                                                                                                                                                                                                              |
|               |                         AggregateExec: mode=FinalPartitioned, gby=[ca_county@0 as ca_county, d_qoy@1 as d_qoy, d_year@2 as d_year], aggr=[sum(web_sales.ws_ext_sales_price)]                                                                                                                                                                                                         |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                |
|               |                             RepartitionExec: partitioning=Hash([ca_county@0, d_qoy@1, d_year@2], 4), input_partitions=4                                                                                                                                                                                                                                                              |
|               |                               AggregateExec: mode=Partial, gby=[ca_county@3 as ca_county, d_qoy@2 as d_qoy, d_year@1 as d_year], aggr=[sum(web_sales.ws_ext_sales_price)]                                                                                                                                                                                                            |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                          |
|               |                                   HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ws_bill_addr_sk@0, ca_address_sk@0)], projection=[ws_ext_sales_price@1, d_year@2, d_qoy@3, ca_county@5]                                                                                                                                                                                      |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                      |
|               |                                       RepartitionExec: partitioning=Hash([ws_bill_addr_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                 |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                  |
|               |                                           HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ws_sold_date_sk@0, d_date_sk@0)], projection=[ws_bill_addr_sk@1, ws_ext_sales_price@2, d_year@4, d_qoy@5]                                                                                                                                                                            |
|               |                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                              |
|               |                                               RepartitionExec: partitioning=Hash([ws_sold_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                         |
|               |                                                 BytesProcessedExec                                                                                                                                                                                                                                                                                                                   |
|               |                                                   SchemaCastScanExec                                                                                                                                                                                                                                                                                                                 |
|               |                                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                             |
|               |                                                       MemoryExec: partitions=1, partition_sizes=[88]                                                                                                                                                                                                                                                                                 |
|               |                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                              |
|               |                                               RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                               |
|               |                                                 BytesProcessedExec                                                                                                                                                                                                                                                                                                                   |
|               |                                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                        |
|               |                                                     FilterExec: d_qoy@2 = 1 AND d_year@1 = 1999                                                                                                                                                                                                                                                                                      |
|               |                                                       SchemaCastScanExec                                                                                                                                                                                                                                                                                                             |
|               |                                                         RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                         |
|               |                                                           MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                                                                                              |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                      |
|               |                                       RepartitionExec: partitioning=Hash([ca_address_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                   |
|               |                                         BytesProcessedExec                                                                                                                                                                                                                                                                                                                           |
|               |                                           SchemaCastScanExec                                                                                                                                                                                                                                                                                                                         |
|               |                                             RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                     |
|               |                                               MemoryExec: partitions=1, partition_sizes=[7]                                                                                                                                                                                                                                                                                          |
|               |               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                            |
|               |                 RepartitionExec: partitioning=Hash([ca_county@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                             |
|               |                   ProjectionExec: expr=[ca_county@0 as ca_county, sum(web_sales.ws_ext_sales_price)@3 as web_sales]                                                                                                                                                                                                                                                                  |
|               |                     AggregateExec: mode=FinalPartitioned, gby=[ca_county@0 as ca_county, d_qoy@1 as d_qoy, d_year@2 as d_year], aggr=[sum(web_sales.ws_ext_sales_price)]                                                                                                                                                                                                             |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                    |
|               |                         RepartitionExec: partitioning=Hash([ca_county@0, d_qoy@1, d_year@2], 4), input_partitions=4                                                                                                                                                                                                                                                                  |
|               |                           AggregateExec: mode=Partial, gby=[ca_county@3 as ca_county, d_qoy@2 as d_qoy, d_year@1 as d_year], aggr=[sum(web_sales.ws_ext_sales_price)]                                                                                                                                                                                                                |
|               |                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                              |
|               |                               HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ws_bill_addr_sk@0, ca_address_sk@0)], projection=[ws_ext_sales_price@1, d_year@2, d_qoy@3, ca_county@5]                                                                                                                                                                                          |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                          |
|               |                                   RepartitionExec: partitioning=Hash([ws_bill_addr_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                     |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                      |
|               |                                       HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ws_sold_date_sk@0, d_date_sk@0)], projection=[ws_bill_addr_sk@1, ws_ext_sales_price@2, d_year@4, d_qoy@5]                                                                                                                                                                                |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                  |
|               |                                           RepartitionExec: partitioning=Hash([ws_sold_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                             |
|               |                                             BytesProcessedExec                                                                                                                                                                                                                                                                                                                       |
|               |                                               SchemaCastScanExec                                                                                                                                                                                                                                                                                                                     |
|               |                                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                 |
|               |                                                   MemoryExec: partitions=1, partition_sizes=[88]                                                                                                                                                                                                                                                                                     |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                  |
|               |                                           RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                   |
|               |                                             BytesProcessedExec                                                                                                                                                                                                                                                                                                                       |
|               |                                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                            |
|               |                                                 FilterExec: d_qoy@2 = 2 AND d_year@1 = 1999                                                                                                                                                                                                                                                                                          |
|               |                                                   SchemaCastScanExec                                                                                                                                                                                                                                                                                                                 |
|               |                                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                             |
|               |                                                       MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                                                                                                  |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                          |
|               |                                   RepartitionExec: partitioning=Hash([ca_address_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                       |
|               |                                     BytesProcessedExec                                                                                                                                                                                                                                                                                                                               |
|               |                                       SchemaCastScanExec                                                                                                                                                                                                                                                                                                                             |
|               |                                         RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                         |
|               |                                           MemoryExec: partitions=1, partition_sizes=[7]                                                                                                                                                                                                                                                                                              |
|               |           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                |
|               |             RepartitionExec: partitioning=Hash([ca_county@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                 |
|               |               ProjectionExec: expr=[ca_county@0 as ca_county, sum(web_sales.ws_ext_sales_price)@3 as web_sales]                                                                                                                                                                                                                                                                      |
|               |                 AggregateExec: mode=FinalPartitioned, gby=[ca_county@0 as ca_county, d_qoy@1 as d_qoy, d_year@2 as d_year], aggr=[sum(web_sales.ws_ext_sales_price)]                                                                                                                                                                                                                 |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                        |
|               |                     RepartitionExec: partitioning=Hash([ca_county@0, d_qoy@1, d_year@2], 4), input_partitions=4                                                                                                                                                                                                                                                                      |
|               |                       AggregateExec: mode=Partial, gby=[ca_county@3 as ca_county, d_qoy@2 as d_qoy, d_year@1 as d_year], aggr=[sum(web_sales.ws_ext_sales_price)]                                                                                                                                                                                                                    |
|               |                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                  |
|               |                           HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ws_bill_addr_sk@0, ca_address_sk@0)], projection=[ws_ext_sales_price@1, d_year@2, d_qoy@3, ca_county@5]                                                                                                                                                                                              |
|               |                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                              |
|               |                               RepartitionExec: partitioning=Hash([ws_bill_addr_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                         |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                          |
|               |                                   HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ws_sold_date_sk@0, d_date_sk@0)], projection=[ws_bill_addr_sk@1, ws_ext_sales_price@2, d_year@4, d_qoy@5]                                                                                                                                                                                    |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                      |
|               |                                       RepartitionExec: partitioning=Hash([ws_sold_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                 |
|               |                                         BytesProcessedExec                                                                                                                                                                                                                                                                                                                           |
|               |                                           SchemaCastScanExec                                                                                                                                                                                                                                                                                                                         |
|               |                                             RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                     |
|               |                                               MemoryExec: partitions=1, partition_sizes=[88]                                                                                                                                                                                                                                                                                         |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                      |
|               |                                       RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                       |
|               |                                         BytesProcessedExec                                                                                                                                                                                                                                                                                                                           |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                |
|               |                                             FilterExec: d_qoy@2 = 3 AND d_year@1 = 1999                                                                                                                                                                                                                                                                                              |
|               |                                               SchemaCastScanExec                                                                                                                                                                                                                                                                                                                     |
|               |                                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                 |
|               |                                                   MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                                                                                                      |
|               |                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                              |
|               |                               RepartitionExec: partitioning=Hash([ca_address_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                           |
|               |                                 BytesProcessedExec                                                                                                                                                                                                                                                                                                                                   |
|               |                                   SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                 |
|               |                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                             |
|               |                                       MemoryExec: partitions=1, partition_sizes=[7]                                                                                                                                                                                                                                                                                                  |
|               |                                                                                                                                                                                                                                                                                                                                                                                      |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
