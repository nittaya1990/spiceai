---
source: crates/runtime/benches/bench.rs
description: "Query: select  i_item_id\n       ,i_item_desc\n       ,i_current_price\n from item, inventory, date_dim, catalog_sales\n where i_current_price between 26 and 26 + 30\n and inv_item_sk = i_item_sk\n and d_date_sk=inv_date_sk\n and d_date between cast('2001-06-09' as date) and (cast('2001-06-09' as date) +  INTERVAL '60 days')\n and i_manufact_id in (744,884,722,693)\n and inv_quantity_on_hand between 100 and 500\n and cs_item_sk = i_item_sk\n group by i_item_id,i_item_desc,i_current_price\n order by i_item_id\n  LIMIT 100;\n"
snapshot_kind: text
---
+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                              |
+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Sort: item.i_item_id ASC NULLS LAST, fetch=100                                                                                                                                                                                                                                                    |
|               |   Aggregate: groupBy=[[item.i_item_id, item.i_item_desc, item.i_current_price]], aggr=[[]]                                                                                                                                                                                                        |
|               |     Projection: item.i_item_id, item.i_item_desc, item.i_current_price                                                                                                                                                                                                                            |
|               |       Inner Join: item.i_item_sk = catalog_sales.cs_item_sk                                                                                                                                                                                                                                       |
|               |         Projection: item.i_item_sk, item.i_item_id, item.i_item_desc, item.i_current_price                                                                                                                                                                                                        |
|               |           Inner Join: inventory.inv_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                  |
|               |             Projection: item.i_item_sk, item.i_item_id, item.i_item_desc, item.i_current_price, inventory.inv_date_sk                                                                                                                                                                             |
|               |               Inner Join: item.i_item_sk = inventory.inv_item_sk                                                                                                                                                                                                                                  |
|               |                 Projection: item.i_item_sk, item.i_item_id, item.i_item_desc, item.i_current_price                                                                                                                                                                                                |
|               |                   BytesProcessedNode                                                                                                                                                                                                                                                              |
|               |                     Filter: item.i_current_price >= Decimal128(Some(2600),7,2) AND item.i_current_price <= Decimal128(Some(5600),7,2) AND item.i_manufact_id IN ([Int32(744), Int32(884), Int32(722), Int32(693)])                                                                                |
|               |                       TableScan: item projection=[i_item_sk, i_item_id, i_item_desc, i_current_price, i_manufact_id]                                                                                                                                                                              |
|               |                 Projection: inventory.inv_date_sk, inventory.inv_item_sk                                                                                                                                                                                                                          |
|               |                   BytesProcessedNode                                                                                                                                                                                                                                                              |
|               |                     Filter: inventory.inv_quantity_on_hand >= Int32(100) AND inventory.inv_quantity_on_hand <= Int32(500)                                                                                                                                                                         |
|               |                       TableScan: inventory projection=[inv_date_sk, inv_item_sk, inv_quantity_on_hand]                                                                                                                                                                                            |
|               |             Projection: date_dim.d_date_sk                                                                                                                                                                                                                                                        |
|               |               BytesProcessedNode                                                                                                                                                                                                                                                                  |
|               |                 Filter: date_dim.d_date >= Date32("2001-06-09") AND date_dim.d_date <= Date32("2001-08-08")                                                                                                                                                                                       |
|               |                   TableScan: date_dim projection=[d_date_sk, d_date]                                                                                                                                                                                                                              |
|               |         BytesProcessedNode                                                                                                                                                                                                                                                                        |
|               |           TableScan: catalog_sales projection=[cs_item_sk]                                                                                                                                                                                                                                        |
| physical_plan | SortPreservingMergeExec: [i_item_id@0 ASC NULLS LAST], fetch=100                                                                                                                                                                                                                                  |
|               |   SortExec: TopK(fetch=100), expr=[i_item_id@0 ASC NULLS LAST], preserve_partitioning=[true]                                                                                                                                                                                                      |
|               |     AggregateExec: mode=FinalPartitioned, gby=[i_item_id@0 as i_item_id, i_item_desc@1 as i_item_desc, i_current_price@2 as i_current_price], aggr=[]                                                                                                                                             |
|               |       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                 |
|               |         RepartitionExec: partitioning=Hash([i_item_id@0, i_item_desc@1, i_current_price@2], 4), input_partitions=4                                                                                                                                                                                |
|               |           AggregateExec: mode=Partial, gby=[i_item_id@0 as i_item_id, i_item_desc@1 as i_item_desc, i_current_price@2 as i_current_price], aggr=[]                                                                                                                                                |
|               |             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                           |
|               |               HashJoinExec: mode=Partitioned, join_type=Inner, on=[(i_item_sk@0, cs_item_sk@0)], projection=[i_item_id@1, i_item_desc@2, i_current_price@3]                                                                                                                                       |
|               |                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                       |
|               |                   RepartitionExec: partitioning=Hash([i_item_sk@0], 4), input_partitions=4                                                                                                                                                                                                        |
|               |                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                   |
|               |                       HashJoinExec: mode=Partitioned, join_type=Inner, on=[(inv_date_sk@4, d_date_sk@0)], projection=[i_item_sk@0, i_item_id@1, i_item_desc@2, i_current_price@3]                                                                                                                 |
|               |                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                               |
|               |                           RepartitionExec: partitioning=Hash([inv_date_sk@4], 4), input_partitions=4                                                                                                                                                                                              |
|               |                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                           |
|               |                               HashJoinExec: mode=Partitioned, join_type=Inner, on=[(i_item_sk@0, inv_item_sk@1)], projection=[i_item_sk@0, i_item_id@1, i_item_desc@2, i_current_price@3, inv_date_sk@4]                                                                                          |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                       |
|               |                                   RepartitionExec: partitioning=Hash([i_item_sk@0], 4), input_partitions=4                                                                                                                                                                                        |
|               |                                     ProjectionExec: expr=[i_item_sk@0 as i_item_sk, i_item_id@1 as i_item_id, i_item_desc@2 as i_item_desc, i_current_price@3 as i_current_price]                                                                                                                 |
|               |                                       BytesProcessedExec                                                                                                                                                                                                                                          |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                               |
|               |                                           FilterExec: i_current_price@3 >= Some(2600),7,2 AND i_current_price@3 <= Some(5600),7,2 AND Use i_manufact_id@4 IN (SET) ([Literal { value: Int32(744) }, Literal { value: Int32(884) }, Literal { value: Int32(722) }, Literal { value: Int32(693) }]) |
|               |                                             SchemaCastScanExec                                                                                                                                                                                                                                    |
|               |                                               RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                |
|               |                                                 MemoryExec: partitions=1, partition_sizes=[3]                                                                                                                                                                                                     |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                       |
|               |                                   RepartitionExec: partitioning=Hash([inv_item_sk@1], 4), input_partitions=4                                                                                                                                                                                      |
|               |                                     ProjectionExec: expr=[inv_date_sk@0 as inv_date_sk, inv_item_sk@1 as inv_item_sk]                                                                                                                                                                             |
|               |                                       BytesProcessedExec                                                                                                                                                                                                                                          |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                               |
|               |                                           FilterExec: inv_quantity_on_hand@2 >= 100 AND inv_quantity_on_hand@2 <= 500                                                                                                                                                                             |
|               |                                             SchemaCastScanExec                                                                                                                                                                                                                                    |
|               |                                               RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                |
|               |                                                 MemoryExec: partitions=1, partition_sizes=[1434]                                                                                                                                                                                                  |
|               |                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                               |
|               |                           RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                |
|               |                             ProjectionExec: expr=[d_date_sk@0 as d_date_sk]                                                                                                                                                                                                                       |
|               |                               BytesProcessedExec                                                                                                                                                                                                                                                  |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                       |
|               |                                   FilterExec: d_date@1 >= 2001-06-09 AND d_date@1 <= 2001-08-08                                                                                                                                                                                                   |
|               |                                     SchemaCastScanExec                                                                                                                                                                                                                                            |
|               |                                       RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                        |
|               |                                         MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                             |
|               |                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                       |
|               |                   RepartitionExec: partitioning=Hash([cs_item_sk@0], 4), input_partitions=4                                                                                                                                                                                                       |
|               |                     BytesProcessedExec                                                                                                                                                                                                                                                            |
|               |                       SchemaCastScanExec                                                                                                                                                                                                                                                          |
|               |                         RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                      |
|               |                           MemoryExec: partitions=1, partition_sizes=[176]                                                                                                                                                                                                                         |
|               |                                                                                                                                                                                                                                                                                                   |
+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
