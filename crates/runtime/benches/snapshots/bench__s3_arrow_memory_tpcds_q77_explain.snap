---
source: crates/runtime/benches/bench.rs
description: "Query: with ss as\n (select s_store_sk,\n         sum(ss_ext_sales_price) as sales,\n         sum(ss_net_profit) as profit\n from store_sales,\n      date_dim,\n      store\n where ss_sold_date_sk = d_date_sk\n       and d_date between cast('2001-08-11' as date)\n                  and (cast('2001-08-11' as date) + INTERVAL '30 days')\n       and ss_store_sk = s_store_sk\n group by s_store_sk)\n ,\n sr as\n (select s_store_sk,\n         sum(sr_return_amt) as returns,\n         sum(sr_net_loss) as profit_loss\n from store_returns,\n      date_dim,\n      store\n where sr_returned_date_sk = d_date_sk\n       and d_date between cast('2001-08-11' as date)\n                  and (cast('2001-08-11' as date) +  INTERVAL '30 days')\n       and sr_store_sk = s_store_sk\n group by s_store_sk),\n cs as\n (select cs_call_center_sk,\n        sum(cs_ext_sales_price) as sales,\n        sum(cs_net_profit) as profit\n from catalog_sales,\n      date_dim\n where cs_sold_date_sk = d_date_sk\n       and d_date between cast('2001-08-11' as date)\n                  and (cast('2001-08-11' as date) +  INTERVAL '30 days')\n group by cs_call_center_sk\n ),\n cr as\n (select cr_call_center_sk,\n         sum(cr_return_amount) as returns,\n         sum(cr_net_loss) as profit_loss\n from catalog_returns,\n      date_dim\n where cr_returned_date_sk = d_date_sk\n       and d_date between cast('2001-08-11' as date)\n                  and (cast('2001-08-11' as date) +  INTERVAL '30 days')\n group by cr_call_center_sk\n ),\n ws as\n ( select wp_web_page_sk,\n        sum(ws_ext_sales_price) as sales,\n        sum(ws_net_profit) as profit\n from web_sales,\n      date_dim,\n      web_page\n where ws_sold_date_sk = d_date_sk\n       and d_date between cast('2001-08-11' as date)\n                  and (cast('2001-08-11' as date) +  INTERVAL '30 days')\n       and ws_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk),\n wr as\n (select wp_web_page_sk,\n        sum(wr_return_amt) as returns,\n        sum(wr_net_loss) as profit_loss\n from web_returns,\n      date_dim,\n      web_page\n where wr_returned_date_sk = d_date_sk\n       and d_date between cast('2001-08-11' as date)\n                  and (cast('2001-08-11' as date) +  INTERVAL '30 days')\n       and wr_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk)\n  select  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from\n (select 'store channel' as channel\n        , ss.s_store_sk as id\n        , sales\n        , coalesce(returns, 0) as returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ss left join sr\n        on  ss.s_store_sk = sr.s_store_sk\n union all\n select 'catalog channel' as channel\n        , cs_call_center_sk as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  cs\n       , cr\n union all\n select 'web channel' as channel\n        , ws.wp_web_page_sk as id\n        , sales\n        , coalesce(returns, 0) returns\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ws left join wr\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\n ) x\n group by rollup (channel, id)\n order by channel\n         ,id\n  LIMIT 100;\n"
snapshot_kind: text
---
+---------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                               |
+---------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Sort: x.channel ASC NULLS LAST, x.id ASC NULLS LAST, fetch=100                                                                                                                                                                                                                     |
|               |   Projection: x.channel, x.id, sum(x.sales) AS sales, sum(x.returns) AS returns, sum(x.profit) AS profit                                                                                                                                                                           |
|               |     Aggregate: groupBy=[[ROLLUP (x.channel, x.id)]], aggr=[[sum(x.sales), sum(x.returns), sum(x.profit)]]                                                                                                                                                                          |
|               |       SubqueryAlias: x                                                                                                                                                                                                                                                             |
|               |         Union                                                                                                                                                                                                                                                                      |
|               |           Projection: Utf8("store channel") AS channel, ss.s_store_sk AS id, ss.sales, coalesce(CAST(sr.returns AS Decimal128(22, 2)), Decimal128(Some(0),22,2)) AS returns, ss.profit - coalesce(CAST(sr.profit_loss AS Decimal128(22, 2)), Decimal128(Some(0),22,2)) AS profit   |
|               |             Left Join: ss.s_store_sk = sr.s_store_sk                                                                                                                                                                                                                               |
|               |               SubqueryAlias: ss                                                                                                                                                                                                                                                    |
|               |                 Projection: store.s_store_sk, sum(store_sales.ss_ext_sales_price) AS sales, sum(store_sales.ss_net_profit) AS profit                                                                                                                                               |
|               |                   Aggregate: groupBy=[[store.s_store_sk]], aggr=[[sum(store_sales.ss_ext_sales_price), sum(store_sales.ss_net_profit)]]                                                                                                                                            |
|               |                     Projection: store_sales.ss_ext_sales_price, store_sales.ss_net_profit, store.s_store_sk                                                                                                                                                                        |
|               |                       Inner Join: store_sales.ss_store_sk = store.s_store_sk                                                                                                                                                                                                       |
|               |                         Projection: store_sales.ss_store_sk, store_sales.ss_ext_sales_price, store_sales.ss_net_profit                                                                                                                                                             |
|               |                           Inner Join: store_sales.ss_sold_date_sk = date_dim.d_date_sk                                                                                                                                                                                             |
|               |                             BytesProcessedNode                                                                                                                                                                                                                                     |
|               |                               TableScan: store_sales projection=[ss_sold_date_sk, ss_store_sk, ss_ext_sales_price, ss_net_profit]                                                                                                                                                  |
|               |                             Projection: date_dim.d_date_sk                                                                                                                                                                                                                         |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                   |
|               |                                 Filter: date_dim.d_date >= Date32("2001-08-11") AND date_dim.d_date <= Date32("2001-09-10")                                                                                                                                                        |
|               |                                   TableScan: date_dim projection=[d_date_sk, d_date]                                                                                                                                                                                               |
|               |                         BytesProcessedNode                                                                                                                                                                                                                                         |
|               |                           TableScan: store projection=[s_store_sk]                                                                                                                                                                                                                 |
|               |               SubqueryAlias: sr                                                                                                                                                                                                                                                    |
|               |                 Projection: store.s_store_sk, sum(store_returns.sr_return_amt) AS returns, sum(store_returns.sr_net_loss) AS profit_loss                                                                                                                                           |
|               |                   Aggregate: groupBy=[[store.s_store_sk]], aggr=[[sum(store_returns.sr_return_amt), sum(store_returns.sr_net_loss)]]                                                                                                                                               |
|               |                     Projection: store_returns.sr_return_amt, store_returns.sr_net_loss, store.s_store_sk                                                                                                                                                                           |
|               |                       Inner Join: store_returns.sr_store_sk = store.s_store_sk                                                                                                                                                                                                     |
|               |                         Projection: store_returns.sr_store_sk, store_returns.sr_return_amt, store_returns.sr_net_loss                                                                                                                                                              |
|               |                           Inner Join: store_returns.sr_returned_date_sk = date_dim.d_date_sk                                                                                                                                                                                       |
|               |                             BytesProcessedNode                                                                                                                                                                                                                                     |
|               |                               TableScan: store_returns projection=[sr_returned_date_sk, sr_store_sk, sr_return_amt, sr_net_loss]                                                                                                                                                   |
|               |                             Projection: date_dim.d_date_sk                                                                                                                                                                                                                         |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                   |
|               |                                 Filter: date_dim.d_date >= Date32("2001-08-11") AND date_dim.d_date <= Date32("2001-09-10")                                                                                                                                                        |
|               |                                   TableScan: date_dim projection=[d_date_sk, d_date]                                                                                                                                                                                               |
|               |                         BytesProcessedNode                                                                                                                                                                                                                                         |
|               |                           TableScan: store projection=[s_store_sk]                                                                                                                                                                                                                 |
|               |           Projection: Utf8("catalog channel") AS channel, cs.cs_call_center_sk AS id, cs.sales, CAST(cr.returns AS Decimal128(22, 2)) AS returns, CAST(cs.profit - cr.profit_loss AS Decimal128(23, 2)) AS profit                                                                  |
|               |             Cross Join:                                                                                                                                                                                                                                                            |
|               |               SubqueryAlias: cs                                                                                                                                                                                                                                                    |
|               |                 Projection: catalog_sales.cs_call_center_sk, sum(catalog_sales.cs_ext_sales_price) AS sales, sum(catalog_sales.cs_net_profit) AS profit                                                                                                                            |
|               |                   Aggregate: groupBy=[[catalog_sales.cs_call_center_sk]], aggr=[[sum(catalog_sales.cs_ext_sales_price), sum(catalog_sales.cs_net_profit)]]                                                                                                                         |
|               |                     Projection: catalog_sales.cs_call_center_sk, catalog_sales.cs_ext_sales_price, catalog_sales.cs_net_profit                                                                                                                                                     |
|               |                       Inner Join: catalog_sales.cs_sold_date_sk = date_dim.d_date_sk                                                                                                                                                                                               |
|               |                         BytesProcessedNode                                                                                                                                                                                                                                         |
|               |                           TableScan: catalog_sales projection=[cs_sold_date_sk, cs_call_center_sk, cs_ext_sales_price, cs_net_profit]                                                                                                                                              |
|               |                         Projection: date_dim.d_date_sk                                                                                                                                                                                                                             |
|               |                           BytesProcessedNode                                                                                                                                                                                                                                       |
|               |                             Filter: date_dim.d_date >= Date32("2001-08-11") AND date_dim.d_date <= Date32("2001-09-10")                                                                                                                                                            |
|               |                               TableScan: date_dim projection=[d_date_sk, d_date]                                                                                                                                                                                                   |
|               |               SubqueryAlias: cr                                                                                                                                                                                                                                                    |
|               |                 Projection: sum(catalog_returns.cr_return_amount) AS returns, sum(catalog_returns.cr_net_loss) AS profit_loss                                                                                                                                                      |
|               |                   Aggregate: groupBy=[[catalog_returns.cr_call_center_sk]], aggr=[[sum(catalog_returns.cr_return_amount), sum(catalog_returns.cr_net_loss)]]                                                                                                                       |
|               |                     Projection: catalog_returns.cr_call_center_sk, catalog_returns.cr_return_amount, catalog_returns.cr_net_loss                                                                                                                                                   |
|               |                       Inner Join: catalog_returns.cr_returned_date_sk = date_dim.d_date_sk                                                                                                                                                                                         |
|               |                         BytesProcessedNode                                                                                                                                                                                                                                         |
|               |                           TableScan: catalog_returns projection=[cr_returned_date_sk, cr_call_center_sk, cr_return_amount, cr_net_loss]                                                                                                                                            |
|               |                         Projection: date_dim.d_date_sk                                                                                                                                                                                                                             |
|               |                           BytesProcessedNode                                                                                                                                                                                                                                       |
|               |                             Filter: date_dim.d_date >= Date32("2001-08-11") AND date_dim.d_date <= Date32("2001-09-10")                                                                                                                                                            |
|               |                               TableScan: date_dim projection=[d_date_sk, d_date]                                                                                                                                                                                                   |
|               |           Projection: Utf8("web channel") AS channel, ws.wp_web_page_sk AS id, ws.sales, coalesce(CAST(wr.returns AS Decimal128(22, 2)), Decimal128(Some(0),22,2)) AS returns, ws.profit - coalesce(CAST(wr.profit_loss AS Decimal128(22, 2)), Decimal128(Some(0),22,2)) AS profit |
|               |             Left Join: ws.wp_web_page_sk = wr.wp_web_page_sk                                                                                                                                                                                                                       |
|               |               SubqueryAlias: ws                                                                                                                                                                                                                                                    |
|               |                 Projection: web_page.wp_web_page_sk, sum(web_sales.ws_ext_sales_price) AS sales, sum(web_sales.ws_net_profit) AS profit                                                                                                                                            |
|               |                   Aggregate: groupBy=[[web_page.wp_web_page_sk]], aggr=[[sum(web_sales.ws_ext_sales_price), sum(web_sales.ws_net_profit)]]                                                                                                                                         |
|               |                     Projection: web_sales.ws_ext_sales_price, web_sales.ws_net_profit, web_page.wp_web_page_sk                                                                                                                                                                     |
|               |                       Inner Join: web_sales.ws_web_page_sk = web_page.wp_web_page_sk                                                                                                                                                                                               |
|               |                         Projection: web_sales.ws_web_page_sk, web_sales.ws_ext_sales_price, web_sales.ws_net_profit                                                                                                                                                                |
|               |                           Inner Join: web_sales.ws_sold_date_sk = date_dim.d_date_sk                                                                                                                                                                                               |
|               |                             BytesProcessedNode                                                                                                                                                                                                                                     |
|               |                               TableScan: web_sales projection=[ws_sold_date_sk, ws_web_page_sk, ws_ext_sales_price, ws_net_profit]                                                                                                                                                 |
|               |                             Projection: date_dim.d_date_sk                                                                                                                                                                                                                         |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                   |
|               |                                 Filter: date_dim.d_date >= Date32("2001-08-11") AND date_dim.d_date <= Date32("2001-09-10")                                                                                                                                                        |
|               |                                   TableScan: date_dim projection=[d_date_sk, d_date]                                                                                                                                                                                               |
|               |                         BytesProcessedNode                                                                                                                                                                                                                                         |
|               |                           TableScan: web_page projection=[wp_web_page_sk]                                                                                                                                                                                                          |
|               |               SubqueryAlias: wr                                                                                                                                                                                                                                                    |
|               |                 Projection: web_page.wp_web_page_sk, sum(web_returns.wr_return_amt) AS returns, sum(web_returns.wr_net_loss) AS profit_loss                                                                                                                                        |
|               |                   Aggregate: groupBy=[[web_page.wp_web_page_sk]], aggr=[[sum(web_returns.wr_return_amt), sum(web_returns.wr_net_loss)]]                                                                                                                                            |
|               |                     Projection: web_returns.wr_return_amt, web_returns.wr_net_loss, web_page.wp_web_page_sk                                                                                                                                                                        |
|               |                       Inner Join: web_returns.wr_web_page_sk = web_page.wp_web_page_sk                                                                                                                                                                                             |
|               |                         Projection: web_returns.wr_web_page_sk, web_returns.wr_return_amt, web_returns.wr_net_loss                                                                                                                                                                 |
|               |                           Inner Join: web_returns.wr_returned_date_sk = date_dim.d_date_sk                                                                                                                                                                                         |
|               |                             BytesProcessedNode                                                                                                                                                                                                                                     |
|               |                               TableScan: web_returns projection=[wr_returned_date_sk, wr_web_page_sk, wr_return_amt, wr_net_loss]                                                                                                                                                  |
|               |                             Projection: date_dim.d_date_sk                                                                                                                                                                                                                         |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                   |
|               |                                 Filter: date_dim.d_date >= Date32("2001-08-11") AND date_dim.d_date <= Date32("2001-09-10")                                                                                                                                                        |
|               |                                   TableScan: date_dim projection=[d_date_sk, d_date]                                                                                                                                                                                               |
|               |                         BytesProcessedNode                                                                                                                                                                                                                                         |
|               |                           TableScan: web_page projection=[wp_web_page_sk]                                                                                                                                                                                                          |
| physical_plan | SortPreservingMergeExec: [channel@0 ASC NULLS LAST, id@1 ASC NULLS LAST], fetch=100                                                                                                                                                                                                |
|               |   SortExec: TopK(fetch=100), expr=[channel@0 ASC NULLS LAST, id@1 ASC NULLS LAST], preserve_partitioning=[true]                                                                                                                                                                    |
|               |     ProjectionExec: expr=[channel@0 as channel, id@1 as id, sum(x.sales)@3 as sales, sum(x.returns)@4 as returns, sum(x.profit)@5 as profit]                                                                                                                                       |
|               |       AggregateExec: mode=FinalPartitioned, gby=[channel@0 as channel, id@1 as id, __grouping_id@2 as __grouping_id], aggr=[sum(x.sales), sum(x.returns), sum(x.profit)]                                                                                                           |
|               |         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                |
|               |           RepartitionExec: partitioning=Hash([channel@0, id@1, __grouping_id@2], 4), input_partitions=12                                                                                                                                                                           |
|               |             AggregateExec: mode=Partial, gby=[(NULL as channel, NULL as id), (channel@0 as channel, NULL as id), (channel@0 as channel, id@1 as id)], aggr=[sum(x.sales), sum(x.returns), sum(x.profit)]                                                                           |
|               |               UnionExec                                                                                                                                                                                                                                                            |
|               |                 ProjectionExec: expr=[store channel as channel, s_store_sk@0 as id, sales@1 as sales, coalesce(CAST(returns@4 AS Decimal128(22, 2)), Some(0),22,2) as returns, profit@2 - coalesce(CAST(profit_loss@5 AS Decimal128(22, 2)), Some(0),22,2) as profit]              |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                      |
|               |                     HashJoinExec: mode=Partitioned, join_type=Left, on=[(s_store_sk@0, s_store_sk@0)]                                                                                                                                                                              |
|               |                       ProjectionExec: expr=[s_store_sk@0 as s_store_sk, sum(store_sales.ss_ext_sales_price)@1 as sales, sum(store_sales.ss_net_profit)@2 as profit]                                                                                                                |
|               |                         AggregateExec: mode=SinglePartitioned, gby=[s_store_sk@2 as s_store_sk], aggr=[sum(store_sales.ss_ext_sales_price), sum(store_sales.ss_net_profit)]                                                                                                        |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                              |
|               |                             HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_store_sk@0, s_store_sk@0)], projection=[ss_ext_sales_price@1, ss_net_profit@2, s_store_sk@3]                                                                                                  |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                          |
|               |                                 RepartitionExec: partitioning=Hash([ss_store_sk@0], 4), input_partitions=4                                                                                                                                                                         |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                      |
|               |                                     HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_sold_date_sk@0, d_date_sk@0)], projection=[ss_store_sk@1, ss_ext_sales_price@2, ss_net_profit@3]                                                                                      |
|               |                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                  |
|               |                                         RepartitionExec: partitioning=Hash([ss_sold_date_sk@0], 4), input_partitions=4                                                                                                                                                             |
|               |                                           BytesProcessedExec                                                                                                                                                                                                                       |
|               |                                             SchemaCastScanExec                                                                                                                                                                                                                     |
|               |                                               RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                 |
|               |                                                 MemoryExec: partitions=1, partition_sizes=[352]                                                                                                                                                                                    |
|               |                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                  |
|               |                                         RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                   |
|               |                                           ProjectionExec: expr=[d_date_sk@0 as d_date_sk]                                                                                                                                                                                          |
|               |                                             BytesProcessedExec                                                                                                                                                                                                                     |
|               |                                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                          |
|               |                                                 FilterExec: d_date@1 >= 2001-08-11 AND d_date@1 <= 2001-09-10                                                                                                                                                                      |
|               |                                                   SchemaCastScanExec                                                                                                                                                                                                               |
|               |                                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                           |
|               |                                                       MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                          |
|               |                                 RepartitionExec: partitioning=Hash([s_store_sk@0], 4), input_partitions=4                                                                                                                                                                          |
|               |                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                             |
|               |                                     BytesProcessedExec                                                                                                                                                                                                                             |
|               |                                       SchemaCastScanExec                                                                                                                                                                                                                           |
|               |                                         MemoryExec: partitions=1, partition_sizes=[1]                                                                                                                                                                                              |
|               |                       ProjectionExec: expr=[s_store_sk@0 as s_store_sk, sum(store_returns.sr_return_amt)@1 as returns, sum(store_returns.sr_net_loss)@2 as profit_loss]                                                                                                            |
|               |                         AggregateExec: mode=SinglePartitioned, gby=[s_store_sk@2 as s_store_sk], aggr=[sum(store_returns.sr_return_amt), sum(store_returns.sr_net_loss)]                                                                                                           |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                              |
|               |                             HashJoinExec: mode=Partitioned, join_type=Inner, on=[(sr_store_sk@0, s_store_sk@0)], projection=[sr_return_amt@1, sr_net_loss@2, s_store_sk@3]                                                                                                         |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                          |
|               |                                 RepartitionExec: partitioning=Hash([sr_store_sk@0], 4), input_partitions=4                                                                                                                                                                         |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                      |
|               |                                     HashJoinExec: mode=Partitioned, join_type=Inner, on=[(sr_returned_date_sk@0, d_date_sk@0)], projection=[sr_store_sk@1, sr_return_amt@2, sr_net_loss@3]                                                                                         |
|               |                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                  |
|               |                                         RepartitionExec: partitioning=Hash([sr_returned_date_sk@0], 4), input_partitions=4                                                                                                                                                         |
|               |                                           BytesProcessedExec                                                                                                                                                                                                                       |
|               |                                             SchemaCastScanExec                                                                                                                                                                                                                     |
|               |                                               RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                 |
|               |                                                 MemoryExec: partitions=1, partition_sizes=[36]                                                                                                                                                                                     |
|               |                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                  |
|               |                                         RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                   |
|               |                                           ProjectionExec: expr=[d_date_sk@0 as d_date_sk]                                                                                                                                                                                          |
|               |                                             BytesProcessedExec                                                                                                                                                                                                                     |
|               |                                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                          |
|               |                                                 FilterExec: d_date@1 >= 2001-08-11 AND d_date@1 <= 2001-09-10                                                                                                                                                                      |
|               |                                                   SchemaCastScanExec                                                                                                                                                                                                               |
|               |                                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                           |
|               |                                                       MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                          |
|               |                                 RepartitionExec: partitioning=Hash([s_store_sk@0], 4), input_partitions=4                                                                                                                                                                          |
|               |                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                             |
|               |                                     BytesProcessedExec                                                                                                                                                                                                                             |
|               |                                       SchemaCastScanExec                                                                                                                                                                                                                           |
|               |                                         MemoryExec: partitions=1, partition_sizes=[1]                                                                                                                                                                                              |
|               |                 ProjectionExec: expr=[catalog channel as channel, cs_call_center_sk@0 as id, sales@1 as sales, CAST(returns@3 AS Decimal128(22, 2)) as returns, CAST(profit@2 - profit_loss@4 AS Decimal128(23, 2)) as profit]                                                     |
|               |                   CrossJoinExec                                                                                                                                                                                                                                                    |
|               |                     CoalescePartitionsExec                                                                                                                                                                                                                                         |
|               |                       ProjectionExec: expr=[cs_call_center_sk@0 as cs_call_center_sk, sum(catalog_sales.cs_ext_sales_price)@1 as sales, sum(catalog_sales.cs_net_profit)@2 as profit]                                                                                              |
|               |                         AggregateExec: mode=FinalPartitioned, gby=[cs_call_center_sk@0 as cs_call_center_sk], aggr=[sum(catalog_sales.cs_ext_sales_price), sum(catalog_sales.cs_net_profit)]                                                                                       |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                              |
|               |                             RepartitionExec: partitioning=Hash([cs_call_center_sk@0], 4), input_partitions=4                                                                                                                                                                       |
|               |                               AggregateExec: mode=Partial, gby=[cs_call_center_sk@0 as cs_call_center_sk], aggr=[sum(catalog_sales.cs_ext_sales_price), sum(catalog_sales.cs_net_profit)]                                                                                          |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                        |
|               |                                   HashJoinExec: mode=Partitioned, join_type=Inner, on=[(cs_sold_date_sk@0, d_date_sk@0)], projection=[cs_call_center_sk@1, cs_ext_sales_price@2, cs_net_profit@3]                                                                                  |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                    |
|               |                                       RepartitionExec: partitioning=Hash([cs_sold_date_sk@0], 4), input_partitions=4                                                                                                                                                               |
|               |                                         BytesProcessedExec                                                                                                                                                                                                                         |
|               |                                           SchemaCastScanExec                                                                                                                                                                                                                       |
|               |                                             RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                   |
|               |                                               MemoryExec: partitions=1, partition_sizes=[176]                                                                                                                                                                                      |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                    |
|               |                                       RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                     |
|               |                                         ProjectionExec: expr=[d_date_sk@0 as d_date_sk]                                                                                                                                                                                            |
|               |                                           BytesProcessedExec                                                                                                                                                                                                                       |
|               |                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                            |
|               |                                               FilterExec: d_date@1 >= 2001-08-11 AND d_date@1 <= 2001-09-10                                                                                                                                                                        |
|               |                                                 SchemaCastScanExec                                                                                                                                                                                                                 |
|               |                                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                             |
|               |                                                     MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                  |
|               |                     ProjectionExec: expr=[sum(catalog_returns.cr_return_amount)@1 as returns, sum(catalog_returns.cr_net_loss)@2 as profit_loss]                                                                                                                                   |
|               |                       AggregateExec: mode=FinalPartitioned, gby=[cr_call_center_sk@0 as cr_call_center_sk], aggr=[sum(catalog_returns.cr_return_amount), sum(catalog_returns.cr_net_loss)]                                                                                         |
|               |                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                |
|               |                           RepartitionExec: partitioning=Hash([cr_call_center_sk@0], 4), input_partitions=4                                                                                                                                                                         |
|               |                             AggregateExec: mode=Partial, gby=[cr_call_center_sk@0 as cr_call_center_sk], aggr=[sum(catalog_returns.cr_return_amount), sum(catalog_returns.cr_net_loss)]                                                                                            |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                          |
|               |                                 HashJoinExec: mode=Partitioned, join_type=Inner, on=[(cr_returned_date_sk@0, d_date_sk@0)], projection=[cr_call_center_sk@1, cr_return_amount@2, cr_net_loss@3]                                                                                    |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                      |
|               |                                     RepartitionExec: partitioning=Hash([cr_returned_date_sk@0], 4), input_partitions=4                                                                                                                                                             |
|               |                                       BytesProcessedExec                                                                                                                                                                                                                           |
|               |                                         SchemaCastScanExec                                                                                                                                                                                                                         |
|               |                                           RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                     |
|               |                                             MemoryExec: partitions=1, partition_sizes=[18]                                                                                                                                                                                         |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                      |
|               |                                     RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                       |
|               |                                       ProjectionExec: expr=[d_date_sk@0 as d_date_sk]                                                                                                                                                                                              |
|               |                                         BytesProcessedExec                                                                                                                                                                                                                         |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                              |
|               |                                             FilterExec: d_date@1 >= 2001-08-11 AND d_date@1 <= 2001-09-10                                                                                                                                                                          |
|               |                                               SchemaCastScanExec                                                                                                                                                                                                                   |
|               |                                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                               |
|               |                                                   MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                    |
|               |                 ProjectionExec: expr=[web channel as channel, wp_web_page_sk@0 as id, sales@1 as sales, coalesce(CAST(returns@4 AS Decimal128(22, 2)), Some(0),22,2) as returns, profit@2 - coalesce(CAST(profit_loss@5 AS Decimal128(22, 2)), Some(0),22,2) as profit]            |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                      |
|               |                     HashJoinExec: mode=Partitioned, join_type=Left, on=[(wp_web_page_sk@0, wp_web_page_sk@0)]                                                                                                                                                                      |
|               |                       ProjectionExec: expr=[wp_web_page_sk@0 as wp_web_page_sk, sum(web_sales.ws_ext_sales_price)@1 as sales, sum(web_sales.ws_net_profit)@2 as profit]                                                                                                            |
|               |                         AggregateExec: mode=SinglePartitioned, gby=[wp_web_page_sk@2 as wp_web_page_sk], aggr=[sum(web_sales.ws_ext_sales_price), sum(web_sales.ws_net_profit)]                                                                                                    |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                              |
|               |                             HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ws_web_page_sk@0, wp_web_page_sk@0)], projection=[ws_ext_sales_price@1, ws_net_profit@2, wp_web_page_sk@3]                                                                                       |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                          |
|               |                                 RepartitionExec: partitioning=Hash([ws_web_page_sk@0], 4), input_partitions=4                                                                                                                                                                      |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                      |
|               |                                     HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ws_sold_date_sk@0, d_date_sk@0)], projection=[ws_web_page_sk@1, ws_ext_sales_price@2, ws_net_profit@3]                                                                                   |
|               |                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                  |
|               |                                         RepartitionExec: partitioning=Hash([ws_sold_date_sk@0], 4), input_partitions=4                                                                                                                                                             |
|               |                                           BytesProcessedExec                                                                                                                                                                                                                       |
|               |                                             SchemaCastScanExec                                                                                                                                                                                                                     |
|               |                                               RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                 |
|               |                                                 MemoryExec: partitions=1, partition_sizes=[88]                                                                                                                                                                                     |
|               |                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                  |
|               |                                         RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                   |
|               |                                           ProjectionExec: expr=[d_date_sk@0 as d_date_sk]                                                                                                                                                                                          |
|               |                                             BytesProcessedExec                                                                                                                                                                                                                     |
|               |                                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                          |
|               |                                                 FilterExec: d_date@1 >= 2001-08-11 AND d_date@1 <= 2001-09-10                                                                                                                                                                      |
|               |                                                   SchemaCastScanExec                                                                                                                                                                                                               |
|               |                                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                           |
|               |                                                       MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                          |
|               |                                 RepartitionExec: partitioning=Hash([wp_web_page_sk@0], 4), input_partitions=4                                                                                                                                                                      |
|               |                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                             |
|               |                                     BytesProcessedExec                                                                                                                                                                                                                             |
|               |                                       SchemaCastScanExec                                                                                                                                                                                                                           |
|               |                                         MemoryExec: partitions=1, partition_sizes=[1]                                                                                                                                                                                              |
|               |                       ProjectionExec: expr=[wp_web_page_sk@0 as wp_web_page_sk, sum(web_returns.wr_return_amt)@1 as returns, sum(web_returns.wr_net_loss)@2 as profit_loss]                                                                                                        |
|               |                         AggregateExec: mode=SinglePartitioned, gby=[wp_web_page_sk@2 as wp_web_page_sk], aggr=[sum(web_returns.wr_return_amt), sum(web_returns.wr_net_loss)]                                                                                                       |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                              |
|               |                             HashJoinExec: mode=Partitioned, join_type=Inner, on=[(wr_web_page_sk@0, wp_web_page_sk@0)], projection=[wr_return_amt@1, wr_net_loss@2, wp_web_page_sk@3]                                                                                              |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                          |
|               |                                 RepartitionExec: partitioning=Hash([wr_web_page_sk@0], 4), input_partitions=4                                                                                                                                                                      |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                      |
|               |                                     HashJoinExec: mode=Partitioned, join_type=Inner, on=[(wr_returned_date_sk@0, d_date_sk@0)], projection=[wr_web_page_sk@1, wr_return_amt@2, wr_net_loss@3]                                                                                      |
|               |                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                  |
|               |                                         RepartitionExec: partitioning=Hash([wr_returned_date_sk@0], 4), input_partitions=4                                                                                                                                                         |
|               |                                           BytesProcessedExec                                                                                                                                                                                                                       |
|               |                                             SchemaCastScanExec                                                                                                                                                                                                                     |
|               |                                               RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                 |
|               |                                                 MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                      |
|               |                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                  |
|               |                                         RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                   |
|               |                                           ProjectionExec: expr=[d_date_sk@0 as d_date_sk]                                                                                                                                                                                          |
|               |                                             BytesProcessedExec                                                                                                                                                                                                                     |
|               |                                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                          |
|               |                                                 FilterExec: d_date@1 >= 2001-08-11 AND d_date@1 <= 2001-09-10                                                                                                                                                                      |
|               |                                                   SchemaCastScanExec                                                                                                                                                                                                               |
|               |                                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                           |
|               |                                                       MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                          |
|               |                                 RepartitionExec: partitioning=Hash([wp_web_page_sk@0], 4), input_partitions=4                                                                                                                                                                      |
|               |                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                             |
|               |                                     BytesProcessedExec                                                                                                                                                                                                                             |
|               |                                       SchemaCastScanExec                                                                                                                                                                                                                           |
|               |                                         MemoryExec: partitions=1, partition_sizes=[1]                                                                                                                                                                                              |
|               |                                                                                                                                                                                                                                                                                    |
+---------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
