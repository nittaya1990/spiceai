---
source: crates/runtime/benches/bench.rs
description: "Query: select  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity\n  and d3.d_date > d1.d_date + INTERVAL '5 days'\n  and hd_buy_potential = '501-1000'\n  and d1.d_year = 1999\n  and cd_marital_status = 'S'\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\n LIMIT 100;\n"
snapshot_kind: text
---
+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                      |
+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Sort: total_cnt DESC NULLS FIRST, item.i_item_desc ASC NULLS LAST, warehouse.w_warehouse_name ASC NULLS LAST, d1.d_week_seq ASC NULLS LAST, fetch=100                                                                                                                                                                                                                                                     |
|               |   Projection: item.i_item_desc, warehouse.w_warehouse_name, d1.d_week_seq, sum(CASE WHEN promotion.p_promo_sk IS NULL THEN Int64(1) ELSE Int64(0) END) AS no_promo, sum(CASE WHEN promotion.p_promo_sk IS NOT NULL THEN Int64(1) ELSE Int64(0) END) AS promo, count(*) AS total_cnt                                                                                                                       |
|               |     Aggregate: groupBy=[[item.i_item_desc, warehouse.w_warehouse_name, d1.d_week_seq]], aggr=[[sum(CASE WHEN promotion.p_promo_sk IS NULL THEN Int64(1) ELSE Int64(0) END), sum(CASE WHEN promotion.p_promo_sk IS NOT NULL THEN Int64(1) ELSE Int64(0) END), count(Int64(1)) AS count(*)]]                                                                                                                |
|               |       Projection: warehouse.w_warehouse_name, item.i_item_desc, d1.d_week_seq, promotion.p_promo_sk                                                                                                                                                                                                                                                                                                       |
|               |         Left Join: catalog_sales.cs_item_sk = catalog_returns.cr_item_sk, catalog_sales.cs_order_number = catalog_returns.cr_order_number                                                                                                                                                                                                                                                                 |
|               |           Projection: catalog_sales.cs_item_sk, catalog_sales.cs_order_number, warehouse.w_warehouse_name, item.i_item_desc, d1.d_week_seq, promotion.p_promo_sk                                                                                                                                                                                                                                          |
|               |             Left Join: catalog_sales.cs_promo_sk = promotion.p_promo_sk                                                                                                                                                                                                                                                                                                                                   |
|               |               Projection: catalog_sales.cs_item_sk, catalog_sales.cs_promo_sk, catalog_sales.cs_order_number, warehouse.w_warehouse_name, item.i_item_desc, d1.d_week_seq                                                                                                                                                                                                                                 |
|               |                 Inner Join: catalog_sales.cs_ship_date_sk = d3.d_date_sk Filter: d3.d_date > d1.d_date + IntervalMonthDayNano("IntervalMonthDayNano { months: 0, days: 5, nanoseconds: 0 }")                                                                                                                                                                                                              |
|               |                   Projection: catalog_sales.cs_ship_date_sk, catalog_sales.cs_item_sk, catalog_sales.cs_promo_sk, catalog_sales.cs_order_number, warehouse.w_warehouse_name, item.i_item_desc, d1.d_date, d1.d_week_seq                                                                                                                                                                                   |
|               |                     Inner Join: inventory.inv_date_sk = d2.d_date_sk, d1.d_week_seq = d2.d_week_seq                                                                                                                                                                                                                                                                                                       |
|               |                       Projection: catalog_sales.cs_ship_date_sk, catalog_sales.cs_item_sk, catalog_sales.cs_promo_sk, catalog_sales.cs_order_number, inventory.inv_date_sk, warehouse.w_warehouse_name, item.i_item_desc, d1.d_date, d1.d_week_seq                                                                                                                                                        |
|               |                         Inner Join: catalog_sales.cs_sold_date_sk = d1.d_date_sk                                                                                                                                                                                                                                                                                                                          |
|               |                           Projection: catalog_sales.cs_sold_date_sk, catalog_sales.cs_ship_date_sk, catalog_sales.cs_item_sk, catalog_sales.cs_promo_sk, catalog_sales.cs_order_number, inventory.inv_date_sk, warehouse.w_warehouse_name, item.i_item_desc                                                                                                                                               |
|               |                             Inner Join: catalog_sales.cs_bill_hdemo_sk = household_demographics.hd_demo_sk                                                                                                                                                                                                                                                                                                |
|               |                               Projection: catalog_sales.cs_sold_date_sk, catalog_sales.cs_ship_date_sk, catalog_sales.cs_bill_hdemo_sk, catalog_sales.cs_item_sk, catalog_sales.cs_promo_sk, catalog_sales.cs_order_number, inventory.inv_date_sk, warehouse.w_warehouse_name, item.i_item_desc                                                                                                           |
|               |                                 Inner Join: catalog_sales.cs_bill_cdemo_sk = customer_demographics.cd_demo_sk                                                                                                                                                                                                                                                                                             |
|               |                                   Projection: catalog_sales.cs_sold_date_sk, catalog_sales.cs_ship_date_sk, catalog_sales.cs_bill_cdemo_sk, catalog_sales.cs_bill_hdemo_sk, catalog_sales.cs_item_sk, catalog_sales.cs_promo_sk, catalog_sales.cs_order_number, inventory.inv_date_sk, warehouse.w_warehouse_name, item.i_item_desc                                                                       |
|               |                                     Inner Join: catalog_sales.cs_item_sk = item.i_item_sk                                                                                                                                                                                                                                                                                                                 |
|               |                                       Projection: catalog_sales.cs_sold_date_sk, catalog_sales.cs_ship_date_sk, catalog_sales.cs_bill_cdemo_sk, catalog_sales.cs_bill_hdemo_sk, catalog_sales.cs_item_sk, catalog_sales.cs_promo_sk, catalog_sales.cs_order_number, inventory.inv_date_sk, warehouse.w_warehouse_name                                                                                     |
|               |                                         Inner Join: inventory.inv_warehouse_sk = warehouse.w_warehouse_sk                                                                                                                                                                                                                                                                                                 |
|               |                                           Projection: catalog_sales.cs_sold_date_sk, catalog_sales.cs_ship_date_sk, catalog_sales.cs_bill_cdemo_sk, catalog_sales.cs_bill_hdemo_sk, catalog_sales.cs_item_sk, catalog_sales.cs_promo_sk, catalog_sales.cs_order_number, inventory.inv_date_sk, inventory.inv_warehouse_sk                                                                                 |
|               |                                             Inner Join: catalog_sales.cs_item_sk = inventory.inv_item_sk Filter: inventory.inv_quantity_on_hand < catalog_sales.cs_quantity                                                                                                                                                                                                                               |
|               |                                               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                          |
|               |                                                 TableScan: catalog_sales projection=[cs_sold_date_sk, cs_ship_date_sk, cs_bill_cdemo_sk, cs_bill_hdemo_sk, cs_item_sk, cs_promo_sk, cs_order_number, cs_quantity]                                                                                                                                                                                         |
|               |                                               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                          |
|               |                                                 TableScan: inventory projection=[inv_date_sk, inv_item_sk, inv_warehouse_sk, inv_quantity_on_hand]                                                                                                                                                                                                                                                        |
|               |                                           BytesProcessedNode                                                                                                                                                                                                                                                                                                                                              |
|               |                                             TableScan: warehouse projection=[w_warehouse_sk, w_warehouse_name]                                                                                                                                                                                                                                                                                            |
|               |                                       BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                  |
|               |                                         TableScan: item projection=[i_item_sk, i_item_desc]                                                                                                                                                                                                                                                                                                               |
|               |                                   Projection: customer_demographics.cd_demo_sk                                                                                                                                                                                                                                                                                                                            |
|               |                                     BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                    |
|               |                                       Filter: customer_demographics.cd_marital_status = LargeUtf8("S")                                                                                                                                                                                                                                                                                                    |
|               |                                         TableScan: customer_demographics projection=[cd_demo_sk, cd_marital_status]                                                                                                                                                                                                                                                                                       |
|               |                               Projection: household_demographics.hd_demo_sk                                                                                                                                                                                                                                                                                                                               |
|               |                                 BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                        |
|               |                                   Filter: household_demographics.hd_buy_potential = LargeUtf8("501-1000")                                                                                                                                                                                                                                                                                                 |
|               |                                     TableScan: household_demographics projection=[hd_demo_sk, hd_buy_potential]                                                                                                                                                                                                                                                                                           |
|               |                           SubqueryAlias: d1                                                                                                                                                                                                                                                                                                                                                               |
|               |                             Projection: date_dim.d_date_sk, date_dim.d_date, date_dim.d_week_seq                                                                                                                                                                                                                                                                                                          |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                          |
|               |                                 Filter: date_dim.d_year = Int32(1999)                                                                                                                                                                                                                                                                                                                                     |
|               |                                   TableScan: date_dim projection=[d_date_sk, d_date, d_week_seq, d_year]                                                                                                                                                                                                                                                                                                  |
|               |                       SubqueryAlias: d2                                                                                                                                                                                                                                                                                                                                                                   |
|               |                         BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                |
|               |                           TableScan: date_dim projection=[d_date_sk, d_week_seq]                                                                                                                                                                                                                                                                                                                          |
|               |                   SubqueryAlias: d3                                                                                                                                                                                                                                                                                                                                                                       |
|               |                     BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                    |
|               |                       TableScan: date_dim projection=[d_date_sk, d_date]                                                                                                                                                                                                                                                                                                                                  |
|               |               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                          |
|               |                 TableScan: promotion projection=[p_promo_sk]                                                                                                                                                                                                                                                                                                                                              |
|               |           BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                              |
|               |             TableScan: catalog_returns projection=[cr_item_sk, cr_order_number]                                                                                                                                                                                                                                                                                                                           |
| physical_plan | SortPreservingMergeExec: [total_cnt@5 DESC, i_item_desc@0 ASC NULLS LAST, w_warehouse_name@1 ASC NULLS LAST, d_week_seq@2 ASC NULLS LAST], fetch=100                                                                                                                                                                                                                                                      |
|               |   SortExec: TopK(fetch=100), expr=[total_cnt@5 DESC, i_item_desc@0 ASC NULLS LAST, w_warehouse_name@1 ASC NULLS LAST, d_week_seq@2 ASC NULLS LAST], preserve_partitioning=[true]                                                                                                                                                                                                                          |
|               |     ProjectionExec: expr=[i_item_desc@0 as i_item_desc, w_warehouse_name@1 as w_warehouse_name, d_week_seq@2 as d_week_seq, sum(CASE WHEN promotion.p_promo_sk IS NULL THEN Int64(1) ELSE Int64(0) END)@3 as no_promo, sum(CASE WHEN promotion.p_promo_sk IS NOT NULL THEN Int64(1) ELSE Int64(0) END)@4 as promo, count(*)@5 as total_cnt]                                                               |
|               |       AggregateExec: mode=FinalPartitioned, gby=[i_item_desc@0 as i_item_desc, w_warehouse_name@1 as w_warehouse_name, d_week_seq@2 as d_week_seq], aggr=[sum(CASE WHEN promotion.p_promo_sk IS NULL THEN Int64(1) ELSE Int64(0) END), sum(CASE WHEN promotion.p_promo_sk IS NOT NULL THEN Int64(1) ELSE Int64(0) END), count(*)]                                                                         |
|               |         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                       |
|               |           RepartitionExec: partitioning=Hash([i_item_desc@0, w_warehouse_name@1, d_week_seq@2], 4), input_partitions=4                                                                                                                                                                                                                                                                                    |
|               |             AggregateExec: mode=Partial, gby=[i_item_desc@1 as i_item_desc, w_warehouse_name@0 as w_warehouse_name, d_week_seq@2 as d_week_seq], aggr=[sum(CASE WHEN promotion.p_promo_sk IS NULL THEN Int64(1) ELSE Int64(0) END), sum(CASE WHEN promotion.p_promo_sk IS NOT NULL THEN Int64(1) ELSE Int64(0) END), count(*)]                                                                            |
|               |               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                 |
|               |                 HashJoinExec: mode=Partitioned, join_type=Left, on=[(cs_item_sk@0, cr_item_sk@0), (cs_order_number@1, cr_order_number@1)], projection=[w_warehouse_name@2, i_item_desc@3, d_week_seq@4, p_promo_sk@5]                                                                                                                                                                                     |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                             |
|               |                     RepartitionExec: partitioning=Hash([cs_item_sk@0, cs_order_number@1], 4), input_partitions=4                                                                                                                                                                                                                                                                                          |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                         |
|               |                         HashJoinExec: mode=Partitioned, join_type=Left, on=[(cs_promo_sk@1, p_promo_sk@0)], projection=[cs_item_sk@0, cs_order_number@2, w_warehouse_name@3, i_item_desc@4, d_week_seq@5, p_promo_sk@6]                                                                                                                                                                                   |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                     |
|               |                             RepartitionExec: partitioning=Hash([cs_promo_sk@1], 4), input_partitions=4                                                                                                                                                                                                                                                                                                    |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                 |
|               |                                 HashJoinExec: mode=Partitioned, join_type=Inner, on=[(cs_ship_date_sk@0, d_date_sk@0)], filter=d_date@1 > d_date@0 + IntervalMonthDayNano { months: 0, days: 5, nanoseconds: 0 }, projection=[cs_item_sk@1, cs_promo_sk@2, cs_order_number@3, w_warehouse_name@4, i_item_desc@5, d_week_seq@7]                                                                            |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                             |
|               |                                     RepartitionExec: partitioning=Hash([cs_ship_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                        |
|               |                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                         |
|               |                                         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(inv_date_sk@4, d_date_sk@0), (d_week_seq@8, d_week_seq@1)], projection=[cs_ship_date_sk@0, cs_item_sk@1, cs_promo_sk@2, cs_order_number@3, w_warehouse_name@5, i_item_desc@6, d_date@7, d_week_seq@8]                                                                                                       |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                     |
|               |                                             RepartitionExec: partitioning=Hash([inv_date_sk@4, d_week_seq@8], 4), input_partitions=4                                                                                                                                                                                                                                                                      |
|               |                                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                 |
|               |                                                 HashJoinExec: mode=Partitioned, join_type=Inner, on=[(cs_sold_date_sk@0, d_date_sk@0)], projection=[cs_ship_date_sk@1, cs_item_sk@2, cs_promo_sk@3, cs_order_number@4, inv_date_sk@5, w_warehouse_name@6, i_item_desc@7, d_date@9, d_week_seq@10]                                                                                                         |
|               |                                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                             |
|               |                                                     RepartitionExec: partitioning=Hash([cs_sold_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                        |
|               |                                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                         |
|               |                                                         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(cs_bill_hdemo_sk@2, hd_demo_sk@0)], projection=[cs_sold_date_sk@0, cs_ship_date_sk@1, cs_item_sk@3, cs_promo_sk@4, cs_order_number@5, inv_date_sk@6, w_warehouse_name@7, i_item_desc@8]                                                                                                     |
|               |                                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                     |
|               |                                                             RepartitionExec: partitioning=Hash([cs_bill_hdemo_sk@2], 4), input_partitions=4                                                                                                                                                                                                                                                               |
|               |                                                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                 |
|               |                                                                 HashJoinExec: mode=Partitioned, join_type=Inner, on=[(cs_bill_cdemo_sk@2, cd_demo_sk@0)], projection=[cs_sold_date_sk@0, cs_ship_date_sk@1, cs_bill_hdemo_sk@3, cs_item_sk@4, cs_promo_sk@5, cs_order_number@6, inv_date_sk@7, w_warehouse_name@8, i_item_desc@9]                                                                         |
|               |                                                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                             |
|               |                                                                     RepartitionExec: partitioning=Hash([cs_bill_cdemo_sk@2], 4), input_partitions=4                                                                                                                                                                                                                                                       |
|               |                                                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                         |
|               |                                                                         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(cs_item_sk@4, i_item_sk@0)], projection=[cs_sold_date_sk@0, cs_ship_date_sk@1, cs_bill_cdemo_sk@2, cs_bill_hdemo_sk@3, cs_item_sk@4, cs_promo_sk@5, cs_order_number@6, inv_date_sk@7, w_warehouse_name@8, i_item_desc@10]                                                   |
|               |                                                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                     |
|               |                                                                             RepartitionExec: partitioning=Hash([cs_item_sk@4], 4), input_partitions=4                                                                                                                                                                                                                                                     |
|               |                                                                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                 |
|               |                                                                                 HashJoinExec: mode=Partitioned, join_type=Inner, on=[(inv_warehouse_sk@8, w_warehouse_sk@0)], projection=[cs_sold_date_sk@0, cs_ship_date_sk@1, cs_bill_cdemo_sk@2, cs_bill_hdemo_sk@3, cs_item_sk@4, cs_promo_sk@5, cs_order_number@6, inv_date_sk@7, w_warehouse_name@10]                                               |
|               |                                                                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                             |
|               |                                                                                     RepartitionExec: partitioning=Hash([inv_warehouse_sk@8], 4), input_partitions=4                                                                                                                                                                                                                                       |
|               |                                                                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                         |
|               |                                                                                         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(cs_item_sk@4, inv_item_sk@1)], filter=inv_quantity_on_hand@1 < cs_quantity@0, projection=[cs_sold_date_sk@0, cs_ship_date_sk@1, cs_bill_cdemo_sk@2, cs_bill_hdemo_sk@3, cs_item_sk@4, cs_promo_sk@5, cs_order_number@6, inv_date_sk@8, inv_warehouse_sk@10] |
|               |                                                                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                     |
|               |                                                                                             RepartitionExec: partitioning=Hash([cs_item_sk@4], 4), input_partitions=4                                                                                                                                                                                                                                     |
|               |                                                                                               BytesProcessedExec                                                                                                                                                                                                                                                                                          |
|               |                                                                                                 SchemaCastScanExec                                                                                                                                                                                                                                                                                        |
|               |                                                                                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                    |
|               |                                                                                                     MemoryExec: partitions=1, partition_sizes=[176]                                                                                                                                                                                                                                                       |
|               |                                                                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                     |
|               |                                                                                             RepartitionExec: partitioning=Hash([inv_item_sk@1], 4), input_partitions=4                                                                                                                                                                                                                                    |
|               |                                                                                               BytesProcessedExec                                                                                                                                                                                                                                                                                          |
|               |                                                                                                 SchemaCastScanExec                                                                                                                                                                                                                                                                                        |
|               |                                                                                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                    |
|               |                                                                                                     MemoryExec: partitions=1, partition_sizes=[1434]                                                                                                                                                                                                                                                      |
|               |                                                                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                             |
|               |                                                                                     RepartitionExec: partitioning=Hash([w_warehouse_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                         |
|               |                                                                                       RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                |
|               |                                                                                         BytesProcessedExec                                                                                                                                                                                                                                                                                                |
|               |                                                                                           SchemaCastScanExec                                                                                                                                                                                                                                                                                              |
|               |                                                                                             MemoryExec: partitions=1, partition_sizes=[1]                                                                                                                                                                                                                                                                 |
|               |                                                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                     |
|               |                                                                             RepartitionExec: partitioning=Hash([i_item_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                      |
|               |                                                                               BytesProcessedExec                                                                                                                                                                                                                                                                                                          |
|               |                                                                                 SchemaCastScanExec                                                                                                                                                                                                                                                                                                        |
|               |                                                                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                    |
|               |                                                                                     MemoryExec: partitions=1, partition_sizes=[3]                                                                                                                                                                                                                                                                         |
|               |                                                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                             |
|               |                                                                     RepartitionExec: partitioning=Hash([cd_demo_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                             |
|               |                                                                       ProjectionExec: expr=[cd_demo_sk@0 as cd_demo_sk]                                                                                                                                                                                                                                                                                   |
|               |                                                                         BytesProcessedExec                                                                                                                                                                                                                                                                                                                |
|               |                                                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                     |
|               |                                                                             FilterExec: cd_marital_status@1 = S                                                                                                                                                                                                                                                                                           |
|               |                                                                               SchemaCastScanExec                                                                                                                                                                                                                                                                                                          |
|               |                                                                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                      |
|               |                                                                                   MemoryExec: partitions=1, partition_sizes=[235]                                                                                                                                                                                                                                                                         |
|               |                                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                     |
|               |                                                             RepartitionExec: partitioning=Hash([hd_demo_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                     |
|               |                                                               ProjectionExec: expr=[hd_demo_sk@0 as hd_demo_sk]                                                                                                                                                                                                                                                                                           |
|               |                                                                 BytesProcessedExec                                                                                                                                                                                                                                                                                                                        |
|               |                                                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                             |
|               |                                                                     FilterExec: hd_buy_potential@1 = 501-1000                                                                                                                                                                                                                                                                                             |
|               |                                                                       RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                |
|               |                                                                         SchemaCastScanExec                                                                                                                                                                                                                                                                                                                |
|               |                                                                           MemoryExec: partitions=1, partition_sizes=[1]                                                                                                                                                                                                                                                                                   |
|               |                                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                             |
|               |                                                     RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                              |
|               |                                                       ProjectionExec: expr=[d_date_sk@0 as d_date_sk, d_date@1 as d_date, d_week_seq@2 as d_week_seq]                                                                                                                                                                                                                                                     |
|               |                                                         BytesProcessedExec                                                                                                                                                                                                                                                                                                                                |
|               |                                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                     |
|               |                                                             FilterExec: d_year@3 = 1999                                                                                                                                                                                                                                                                                                                   |
|               |                                                               SchemaCastScanExec                                                                                                                                                                                                                                                                                                                          |
|               |                                                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                      |
|               |                                                                   MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                                                                                                           |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                     |
|               |                                             RepartitionExec: partitioning=Hash([d_date_sk@0, d_week_seq@1], 4), input_partitions=4                                                                                                                                                                                                                                                                        |
|               |                                               BytesProcessedExec                                                                                                                                                                                                                                                                                                                                          |
|               |                                                 SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                        |
|               |                                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                    |
|               |                                                     MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                                                                                                                         |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                             |
|               |                                     RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                              |
|               |                                       BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                  |
|               |                                         SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                |
|               |                                           RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                            |
|               |                                             MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                                                                                                                                 |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                     |
|               |                             RepartitionExec: partitioning=Hash([p_promo_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                     |
|               |                               RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                        |
|               |                                 BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                        |
|               |                                   SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                      |
|               |                                     MemoryExec: partitions=1, partition_sizes=[1]                                                                                                                                                                                                                                                                                                                         |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                             |
|               |                     RepartitionExec: partitioning=Hash([cr_item_sk@0, cr_order_number@1], 4), input_partitions=4                                                                                                                                                                                                                                                                                          |
|               |                       BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                  |
|               |                         SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                |
|               |                           RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                            |
|               |                             MemoryExec: partitions=1, partition_sizes=[18]                                                                                                                                                                                                                                                                                                                                |
|               |                                                                                                                                                                                                                                                                                                                                                                                                           |
+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
