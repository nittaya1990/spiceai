---
source: crates/runtime/benches/bench.rs
description: "Query: with year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,stddev_samp(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (2001,2001+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,stddev_samp(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (2001,2001+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select\n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 2001\n         and t_s_secyear.year = 2001+1\n         and t_w_firstyear.year = 2001\n         and t_w_secyear.year = 2001+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n order by 3,2,1\n LIMIT 100;\n"
snapshot_kind: text
---
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                      |
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Sort: t_s_secyear.customer_last_name ASC NULLS LAST, t_s_secyear.customer_first_name ASC NULLS LAST, t_s_secyear.customer_id ASC NULLS LAST, fetch=100                                                                                                                                                                                    |
|               |   Projection: t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name                                                                                                                                                                                                                                    |
|               |     Inner Join: t_s_firstyear.customer_id = t_w_secyear.customer_id Filter: CASE WHEN t_w_firstyear.year_total > Float64(0) THEN t_w_secyear.year_total / t_w_firstyear.year_total ELSE Float64(NULL) END > CASE WHEN t_s_firstyear.year_total > Float64(0) THEN t_s_secyear.year_total / t_s_firstyear.year_total ELSE Float64(NULL) END |
|               |       Projection: t_s_firstyear.customer_id, t_s_firstyear.year_total, t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.year_total, t_w_firstyear.year_total                                                                                                                         |
|               |         Inner Join: t_s_firstyear.customer_id = t_w_firstyear.customer_id                                                                                                                                                                                                                                                                 |
|               |           Inner Join: t_s_firstyear.customer_id = t_s_secyear.customer_id                                                                                                                                                                                                                                                                 |
|               |             SubqueryAlias: t_s_firstyear                                                                                                                                                                                                                                                                                                  |
|               |               SubqueryAlias: year_total                                                                                                                                                                                                                                                                                                   |
|               |                 Projection: customer.c_customer_id AS customer_id, stddev(store_sales.ss_net_paid) AS year_total                                                                                                                                                                                                                          |
|               |                   Filter: stddev(store_sales.ss_net_paid) > Float64(0)                                                                                                                                                                                                                                                                    |
|               |                     Projection: customer.c_customer_id, stddev(store_sales.ss_net_paid)                                                                                                                                                                                                                                                   |
|               |                       Aggregate: groupBy=[[customer.c_customer_id, customer.c_first_name, customer.c_last_name, date_dim.d_year]], aggr=[[stddev(CAST(store_sales.ss_net_paid AS Float64))]]                                                                                                                                              |
|               |                         Projection: customer.c_customer_id, customer.c_first_name, customer.c_last_name, store_sales.ss_net_paid, date_dim.d_year                                                                                                                                                                                         |
|               |                           Inner Join: store_sales.ss_sold_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                    |
|               |                             Projection: customer.c_customer_id, customer.c_first_name, customer.c_last_name, store_sales.ss_sold_date_sk, store_sales.ss_net_paid                                                                                                                                                                         |
|               |                               Inner Join: customer.c_customer_sk = store_sales.ss_customer_sk                                                                                                                                                                                                                                             |
|               |                                 BytesProcessedNode                                                                                                                                                                                                                                                                                        |
|               |                                   TableScan: customer projection=[c_customer_sk, c_customer_id, c_first_name, c_last_name]                                                                                                                                                                                                                |
|               |                                 BytesProcessedNode                                                                                                                                                                                                                                                                                        |
|               |                                   TableScan: store_sales projection=[ss_sold_date_sk, ss_customer_sk, ss_net_paid]                                                                                                                                                                                                                        |
|               |                             BytesProcessedNode                                                                                                                                                                                                                                                                                            |
|               |                               Filter: date_dim.d_year = Int32(2001)                                                                                                                                                                                                                                                                       |
|               |                                 TableScan: date_dim projection=[d_date_sk, d_year]                                                                                                                                                                                                                                                        |
|               |             SubqueryAlias: t_s_secyear                                                                                                                                                                                                                                                                                                    |
|               |               SubqueryAlias: year_total                                                                                                                                                                                                                                                                                                   |
|               |                 Projection: customer.c_customer_id AS customer_id, customer.c_first_name AS customer_first_name, customer.c_last_name AS customer_last_name, stddev(store_sales.ss_net_paid) AS year_total                                                                                                                                |
|               |                   Aggregate: groupBy=[[customer.c_customer_id, customer.c_first_name, customer.c_last_name, date_dim.d_year]], aggr=[[stddev(CAST(store_sales.ss_net_paid AS Float64))]]                                                                                                                                                  |
|               |                     Projection: customer.c_customer_id, customer.c_first_name, customer.c_last_name, store_sales.ss_net_paid, date_dim.d_year                                                                                                                                                                                             |
|               |                       Inner Join: store_sales.ss_sold_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                        |
|               |                         Projection: customer.c_customer_id, customer.c_first_name, customer.c_last_name, store_sales.ss_sold_date_sk, store_sales.ss_net_paid                                                                                                                                                                             |
|               |                           Inner Join: customer.c_customer_sk = store_sales.ss_customer_sk                                                                                                                                                                                                                                                 |
|               |                             BytesProcessedNode                                                                                                                                                                                                                                                                                            |
|               |                               TableScan: customer projection=[c_customer_sk, c_customer_id, c_first_name, c_last_name]                                                                                                                                                                                                                    |
|               |                             BytesProcessedNode                                                                                                                                                                                                                                                                                            |
|               |                               TableScan: store_sales projection=[ss_sold_date_sk, ss_customer_sk, ss_net_paid]                                                                                                                                                                                                                            |
|               |                         BytesProcessedNode                                                                                                                                                                                                                                                                                                |
|               |                           Filter: date_dim.d_year = Int32(2002)                                                                                                                                                                                                                                                                           |
|               |                             TableScan: date_dim projection=[d_date_sk, d_year]                                                                                                                                                                                                                                                            |
|               |           SubqueryAlias: t_w_firstyear                                                                                                                                                                                                                                                                                                    |
|               |             SubqueryAlias: year_total                                                                                                                                                                                                                                                                                                     |
|               |               Projection: customer.c_customer_id AS customer_id, stddev(web_sales.ws_net_paid) AS year_total                                                                                                                                                                                                                              |
|               |                 Filter: stddev(web_sales.ws_net_paid) > Float64(0)                                                                                                                                                                                                                                                                        |
|               |                   Projection: customer.c_customer_id, stddev(web_sales.ws_net_paid)                                                                                                                                                                                                                                                       |
|               |                     Aggregate: groupBy=[[customer.c_customer_id, customer.c_first_name, customer.c_last_name, date_dim.d_year]], aggr=[[stddev(CAST(web_sales.ws_net_paid AS Float64))]]                                                                                                                                                  |
|               |                       Projection: customer.c_customer_id, customer.c_first_name, customer.c_last_name, web_sales.ws_net_paid, date_dim.d_year                                                                                                                                                                                             |
|               |                         Inner Join: web_sales.ws_sold_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                        |
|               |                           Projection: customer.c_customer_id, customer.c_first_name, customer.c_last_name, web_sales.ws_sold_date_sk, web_sales.ws_net_paid                                                                                                                                                                               |
|               |                             Inner Join: customer.c_customer_sk = web_sales.ws_bill_customer_sk                                                                                                                                                                                                                                            |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                                                                          |
|               |                                 TableScan: customer projection=[c_customer_sk, c_customer_id, c_first_name, c_last_name]                                                                                                                                                                                                                  |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                                                                          |
|               |                                 TableScan: web_sales projection=[ws_sold_date_sk, ws_bill_customer_sk, ws_net_paid]                                                                                                                                                                                                                       |
|               |                           BytesProcessedNode                                                                                                                                                                                                                                                                                              |
|               |                             Filter: date_dim.d_year = Int32(2001)                                                                                                                                                                                                                                                                         |
|               |                               TableScan: date_dim projection=[d_date_sk, d_year]                                                                                                                                                                                                                                                          |
|               |       SubqueryAlias: t_w_secyear                                                                                                                                                                                                                                                                                                          |
|               |         SubqueryAlias: year_total                                                                                                                                                                                                                                                                                                         |
|               |           Projection: customer.c_customer_id AS customer_id, stddev(web_sales.ws_net_paid) AS year_total                                                                                                                                                                                                                                  |
|               |             Aggregate: groupBy=[[customer.c_customer_id, customer.c_first_name, customer.c_last_name, date_dim.d_year]], aggr=[[stddev(CAST(web_sales.ws_net_paid AS Float64))]]                                                                                                                                                          |
|               |               Projection: customer.c_customer_id, customer.c_first_name, customer.c_last_name, web_sales.ws_net_paid, date_dim.d_year                                                                                                                                                                                                     |
|               |                 Inner Join: web_sales.ws_sold_date_sk = date_dim.d_date_sk                                                                                                                                                                                                                                                                |
|               |                   Projection: customer.c_customer_id, customer.c_first_name, customer.c_last_name, web_sales.ws_sold_date_sk, web_sales.ws_net_paid                                                                                                                                                                                       |
|               |                     Inner Join: customer.c_customer_sk = web_sales.ws_bill_customer_sk                                                                                                                                                                                                                                                    |
|               |                       BytesProcessedNode                                                                                                                                                                                                                                                                                                  |
|               |                         TableScan: customer projection=[c_customer_sk, c_customer_id, c_first_name, c_last_name]                                                                                                                                                                                                                          |
|               |                       BytesProcessedNode                                                                                                                                                                                                                                                                                                  |
|               |                         TableScan: web_sales projection=[ws_sold_date_sk, ws_bill_customer_sk, ws_net_paid]                                                                                                                                                                                                                               |
|               |                   BytesProcessedNode                                                                                                                                                                                                                                                                                                      |
|               |                     Filter: date_dim.d_year = Int32(2002)                                                                                                                                                                                                                                                                                 |
|               |                       TableScan: date_dim projection=[d_date_sk, d_year]                                                                                                                                                                                                                                                                  |
| physical_plan | SortPreservingMergeExec: [customer_last_name@2 ASC NULLS LAST, customer_first_name@1 ASC NULLS LAST, customer_id@0 ASC NULLS LAST], fetch=100                                                                                                                                                                                             |
|               |   SortExec: TopK(fetch=100), expr=[customer_last_name@2 ASC NULLS LAST, customer_first_name@1 ASC NULLS LAST, customer_id@0 ASC NULLS LAST], preserve_partitioning=[true]                                                                                                                                                                 |
|               |     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                           |
|               |       HashJoinExec: mode=Partitioned, join_type=Inner, on=[(customer_id@0, customer_id@0)], filter=CASE WHEN year_total@2 > 0 THEN year_total@3 / year_total@2 END > CASE WHEN year_total@0 > 0 THEN year_total@1 / year_total@0 END, projection=[customer_id@2, customer_first_name@3, customer_last_name@4]                             |
|               |         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                       |
|               |           HashJoinExec: mode=Partitioned, join_type=Inner, on=[(customer_id@0, customer_id@0)], projection=[customer_id@0, year_total@1, customer_id@2, customer_first_name@3, customer_last_name@4, year_total@5, year_total@7]                                                                                                          |
|               |             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                   |
|               |               HashJoinExec: mode=Partitioned, join_type=Inner, on=[(customer_id@0, customer_id@0)]                                                                                                                                                                                                                                        |
|               |                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                               |
|               |                   RepartitionExec: partitioning=Hash([customer_id@0], 4), input_partitions=4                                                                                                                                                                                                                                              |
|               |                     ProjectionExec: expr=[c_customer_id@0 as customer_id, stddev(store_sales.ss_net_paid)@1 as year_total]                                                                                                                                                                                                                |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                         |
|               |                         FilterExec: stddev(store_sales.ss_net_paid)@1 > 0                                                                                                                                                                                                                                                                 |
|               |                           ProjectionExec: expr=[c_customer_id@0 as c_customer_id, stddev(store_sales.ss_net_paid)@4 as stddev(store_sales.ss_net_paid)]                                                                                                                                                                                   |
|               |                             AggregateExec: mode=FinalPartitioned, gby=[c_customer_id@0 as c_customer_id, c_first_name@1 as c_first_name, c_last_name@2 as c_last_name, d_year@3 as d_year], aggr=[stddev(store_sales.ss_net_paid)]                                                                                                        |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                 |
|               |                                 RepartitionExec: partitioning=Hash([c_customer_id@0, c_first_name@1, c_last_name@2, d_year@3], 4), input_partitions=4                                                                                                                                                                                     |
|               |                                   AggregateExec: mode=Partial, gby=[c_customer_id@0 as c_customer_id, c_first_name@1 as c_first_name, c_last_name@2 as c_last_name, d_year@4 as d_year], aggr=[stddev(store_sales.ss_net_paid)]                                                                                                           |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                           |
|               |                                       HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_sold_date_sk@3, d_date_sk@0)], projection=[c_customer_id@0, c_first_name@1, c_last_name@2, ss_net_paid@4, d_year@6]                                                                                                                        |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                       |
|               |                                           RepartitionExec: partitioning=Hash([ss_sold_date_sk@3], 4), input_partitions=4                                                                                                                                                                                                                  |
|               |                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                   |
|               |                                               HashJoinExec: mode=Partitioned, join_type=Inner, on=[(c_customer_sk@0, ss_customer_sk@1)], projection=[c_customer_id@1, c_first_name@2, c_last_name@3, ss_sold_date_sk@4, ss_net_paid@6]                                                                                                    |
|               |                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                               |
|               |                                                   RepartitionExec: partitioning=Hash([c_customer_sk@0], 4), input_partitions=4                                                                                                                                                                                                            |
|               |                                                     BytesProcessedExec                                                                                                                                                                                                                                                                    |
|               |                                                       SchemaCastScanExec                                                                                                                                                                                                                                                                  |
|               |                                                         RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                              |
|               |                                                           MemoryExec: partitions=1, partition_sizes=[13]                                                                                                                                                                                                                                  |
|               |                                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                               |
|               |                                                   RepartitionExec: partitioning=Hash([ss_customer_sk@1], 4), input_partitions=4                                                                                                                                                                                                           |
|               |                                                     BytesProcessedExec                                                                                                                                                                                                                                                                    |
|               |                                                       SchemaCastScanExec                                                                                                                                                                                                                                                                  |
|               |                                                         RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                              |
|               |                                                           MemoryExec: partitions=1, partition_sizes=[352]                                                                                                                                                                                                                                 |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                       |
|               |                                           RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                        |
|               |                                             BytesProcessedExec                                                                                                                                                                                                                                                                            |
|               |                                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                 |
|               |                                                 FilterExec: d_year@1 = 2001                                                                                                                                                                                                                                                               |
|               |                                                   SchemaCastScanExec                                                                                                                                                                                                                                                                      |
|               |                                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                  |
|               |                                                       MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                                                       |
|               |                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                               |
|               |                   RepartitionExec: partitioning=Hash([customer_id@0], 4), input_partitions=4                                                                                                                                                                                                                                              |
|               |                     ProjectionExec: expr=[c_customer_id@0 as customer_id, c_first_name@1 as customer_first_name, c_last_name@2 as customer_last_name, stddev(store_sales.ss_net_paid)@4 as year_total]                                                                                                                                    |
|               |                       AggregateExec: mode=FinalPartitioned, gby=[c_customer_id@0 as c_customer_id, c_first_name@1 as c_first_name, c_last_name@2 as c_last_name, d_year@3 as d_year], aggr=[stddev(store_sales.ss_net_paid)]                                                                                                              |
|               |                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                       |
|               |                           RepartitionExec: partitioning=Hash([c_customer_id@0, c_first_name@1, c_last_name@2, d_year@3], 4), input_partitions=4                                                                                                                                                                                           |
|               |                             AggregateExec: mode=Partial, gby=[c_customer_id@0 as c_customer_id, c_first_name@1 as c_first_name, c_last_name@2 as c_last_name, d_year@4 as d_year], aggr=[stddev(store_sales.ss_net_paid)]                                                                                                                 |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                 |
|               |                                 HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_sold_date_sk@3, d_date_sk@0)], projection=[c_customer_id@0, c_first_name@1, c_last_name@2, ss_net_paid@4, d_year@6]                                                                                                                              |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                             |
|               |                                     RepartitionExec: partitioning=Hash([ss_sold_date_sk@3], 4), input_partitions=4                                                                                                                                                                                                                        |
|               |                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                         |
|               |                                         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(c_customer_sk@0, ss_customer_sk@1)], projection=[c_customer_id@1, c_first_name@2, c_last_name@3, ss_sold_date_sk@4, ss_net_paid@6]                                                                                                          |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                     |
|               |                                             RepartitionExec: partitioning=Hash([c_customer_sk@0], 4), input_partitions=4                                                                                                                                                                                                                  |
|               |                                               BytesProcessedExec                                                                                                                                                                                                                                                                          |
|               |                                                 SchemaCastScanExec                                                                                                                                                                                                                                                                        |
|               |                                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                    |
|               |                                                     MemoryExec: partitions=1, partition_sizes=[13]                                                                                                                                                                                                                                        |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                     |
|               |                                             RepartitionExec: partitioning=Hash([ss_customer_sk@1], 4), input_partitions=4                                                                                                                                                                                                                 |
|               |                                               BytesProcessedExec                                                                                                                                                                                                                                                                          |
|               |                                                 SchemaCastScanExec                                                                                                                                                                                                                                                                        |
|               |                                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                    |
|               |                                                     MemoryExec: partitions=1, partition_sizes=[352]                                                                                                                                                                                                                                       |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                             |
|               |                                     RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                              |
|               |                                       BytesProcessedExec                                                                                                                                                                                                                                                                                  |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                       |
|               |                                           FilterExec: d_year@1 = 2002                                                                                                                                                                                                                                                                     |
|               |                                             SchemaCastScanExec                                                                                                                                                                                                                                                                            |
|               |                                               RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                        |
|               |                                                 MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                                                             |
|               |             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                   |
|               |               RepartitionExec: partitioning=Hash([customer_id@0], 4), input_partitions=4                                                                                                                                                                                                                                                  |
|               |                 ProjectionExec: expr=[c_customer_id@0 as customer_id, stddev(web_sales.ws_net_paid)@1 as year_total]                                                                                                                                                                                                                      |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                             |
|               |                     FilterExec: stddev(web_sales.ws_net_paid)@1 > 0                                                                                                                                                                                                                                                                       |
|               |                       ProjectionExec: expr=[c_customer_id@0 as c_customer_id, stddev(web_sales.ws_net_paid)@4 as stddev(web_sales.ws_net_paid)]                                                                                                                                                                                           |
|               |                         AggregateExec: mode=FinalPartitioned, gby=[c_customer_id@0 as c_customer_id, c_first_name@1 as c_first_name, c_last_name@2 as c_last_name, d_year@3 as d_year], aggr=[stddev(web_sales.ws_net_paid)]                                                                                                              |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                     |
|               |                             RepartitionExec: partitioning=Hash([c_customer_id@0, c_first_name@1, c_last_name@2, d_year@3], 4), input_partitions=4                                                                                                                                                                                         |
|               |                               AggregateExec: mode=Partial, gby=[c_customer_id@0 as c_customer_id, c_first_name@1 as c_first_name, c_last_name@2 as c_last_name, d_year@4 as d_year], aggr=[stddev(web_sales.ws_net_paid)]                                                                                                                 |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                               |
|               |                                   HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ws_sold_date_sk@3, d_date_sk@0)], projection=[c_customer_id@0, c_first_name@1, c_last_name@2, ws_net_paid@4, d_year@6]                                                                                                                            |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                           |
|               |                                       RepartitionExec: partitioning=Hash([ws_sold_date_sk@3], 4), input_partitions=4                                                                                                                                                                                                                      |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                       |
|               |                                           HashJoinExec: mode=Partitioned, join_type=Inner, on=[(c_customer_sk@0, ws_bill_customer_sk@1)], projection=[c_customer_id@1, c_first_name@2, c_last_name@3, ws_sold_date_sk@4, ws_net_paid@6]                                                                                                   |
|               |                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                   |
|               |                                               RepartitionExec: partitioning=Hash([c_customer_sk@0], 4), input_partitions=4                                                                                                                                                                                                                |
|               |                                                 BytesProcessedExec                                                                                                                                                                                                                                                                        |
|               |                                                   SchemaCastScanExec                                                                                                                                                                                                                                                                      |
|               |                                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                  |
|               |                                                       MemoryExec: partitions=1, partition_sizes=[13]                                                                                                                                                                                                                                      |
|               |                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                   |
|               |                                               RepartitionExec: partitioning=Hash([ws_bill_customer_sk@1], 4), input_partitions=4                                                                                                                                                                                                          |
|               |                                                 BytesProcessedExec                                                                                                                                                                                                                                                                        |
|               |                                                   SchemaCastScanExec                                                                                                                                                                                                                                                                      |
|               |                                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                  |
|               |                                                       MemoryExec: partitions=1, partition_sizes=[88]                                                                                                                                                                                                                                      |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                           |
|               |                                       RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                            |
|               |                                         BytesProcessedExec                                                                                                                                                                                                                                                                                |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                     |
|               |                                             FilterExec: d_year@1 = 2001                                                                                                                                                                                                                                                                   |
|               |                                               SchemaCastScanExec                                                                                                                                                                                                                                                                          |
|               |                                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                      |
|               |                                                   MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                                                           |
|               |         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                       |
|               |           RepartitionExec: partitioning=Hash([customer_id@0], 4), input_partitions=4                                                                                                                                                                                                                                                      |
|               |             ProjectionExec: expr=[c_customer_id@0 as customer_id, stddev(web_sales.ws_net_paid)@4 as year_total]                                                                                                                                                                                                                          |
|               |               AggregateExec: mode=FinalPartitioned, gby=[c_customer_id@0 as c_customer_id, c_first_name@1 as c_first_name, c_last_name@2 as c_last_name, d_year@3 as d_year], aggr=[stddev(web_sales.ws_net_paid)]                                                                                                                        |
|               |                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                               |
|               |                   RepartitionExec: partitioning=Hash([c_customer_id@0, c_first_name@1, c_last_name@2, d_year@3], 4), input_partitions=4                                                                                                                                                                                                   |
|               |                     AggregateExec: mode=Partial, gby=[c_customer_id@0 as c_customer_id, c_first_name@1 as c_first_name, c_last_name@2 as c_last_name, d_year@4 as d_year], aggr=[stddev(web_sales.ws_net_paid)]                                                                                                                           |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                         |
|               |                         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ws_sold_date_sk@3, d_date_sk@0)], projection=[c_customer_id@0, c_first_name@1, c_last_name@2, ws_net_paid@4, d_year@6]                                                                                                                                      |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                     |
|               |                             RepartitionExec: partitioning=Hash([ws_sold_date_sk@3], 4), input_partitions=4                                                                                                                                                                                                                                |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                 |
|               |                                 HashJoinExec: mode=Partitioned, join_type=Inner, on=[(c_customer_sk@0, ws_bill_customer_sk@1)], projection=[c_customer_id@1, c_first_name@2, c_last_name@3, ws_sold_date_sk@4, ws_net_paid@6]                                                                                                             |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                             |
|               |                                     RepartitionExec: partitioning=Hash([c_customer_sk@0], 4), input_partitions=4                                                                                                                                                                                                                          |
|               |                                       BytesProcessedExec                                                                                                                                                                                                                                                                                  |
|               |                                         SchemaCastScanExec                                                                                                                                                                                                                                                                                |
|               |                                           RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                            |
|               |                                             MemoryExec: partitions=1, partition_sizes=[13]                                                                                                                                                                                                                                                |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                             |
|               |                                     RepartitionExec: partitioning=Hash([ws_bill_customer_sk@1], 4), input_partitions=4                                                                                                                                                                                                                    |
|               |                                       BytesProcessedExec                                                                                                                                                                                                                                                                                  |
|               |                                         SchemaCastScanExec                                                                                                                                                                                                                                                                                |
|               |                                           RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                            |
|               |                                             MemoryExec: partitions=1, partition_sizes=[88]                                                                                                                                                                                                                                                |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                     |
|               |                             RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                      |
|               |                               BytesProcessedExec                                                                                                                                                                                                                                                                                          |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                               |
|               |                                   FilterExec: d_year@1 = 2002                                                                                                                                                                                                                                                                             |
|               |                                     SchemaCastScanExec                                                                                                                                                                                                                                                                                    |
|               |                                       RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                |
|               |                                         MemoryExec: partitions=1, partition_sizes=[9]                                                                                                                                                                                                                                                     |
|               |                                                                                                                                                                                                                                                                                                                                           |
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
