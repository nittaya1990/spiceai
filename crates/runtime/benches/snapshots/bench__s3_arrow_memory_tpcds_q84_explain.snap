---
source: crates/runtime/benches/bench.rs
description: "Query: select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from customer\n     ,customer_address\n     ,customer_demographics\n     ,household_demographics\n     ,income_band\n     ,store_returns\n where ca_city\t        =  'White Oak'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  45626\n   and ib_upper_bound   <=  45626 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n  LIMIT 100;\n"
snapshot_kind: text
---
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                            |
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Projection: customer_id, customername                                                                                                                                                                                                           |
|               |   Sort: customer.c_customer_id ASC NULLS LAST, fetch=100                                                                                                                                                                                        |
|               |     Projection: customer.c_customer_id AS customer_id, coalesce(customer.c_last_name, LargeUtf8("")) || LargeUtf8(", ") || coalesce(customer.c_first_name, LargeUtf8("")) AS customername, customer.c_customer_id                               |
|               |       Inner Join: customer_demographics.cd_demo_sk = store_returns.sr_cdemo_sk                                                                                                                                                                  |
|               |         Projection: customer.c_customer_id, customer.c_first_name, customer.c_last_name, customer_demographics.cd_demo_sk                                                                                                                       |
|               |           Inner Join: household_demographics.hd_income_band_sk = income_band.ib_income_band_sk                                                                                                                                                  |
|               |             Projection: customer.c_customer_id, customer.c_first_name, customer.c_last_name, customer_demographics.cd_demo_sk, household_demographics.hd_income_band_sk                                                                         |
|               |               Inner Join: customer.c_current_hdemo_sk = household_demographics.hd_demo_sk                                                                                                                                                       |
|               |                 Projection: customer.c_customer_id, customer.c_current_hdemo_sk, customer.c_first_name, customer.c_last_name, customer_demographics.cd_demo_sk                                                                                  |
|               |                   Inner Join: customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk                                                                                                                                                    |
|               |                     Projection: customer.c_customer_id, customer.c_current_cdemo_sk, customer.c_current_hdemo_sk, customer.c_first_name, customer.c_last_name                                                                                   |
|               |                       Inner Join: customer.c_current_addr_sk = customer_address.ca_address_sk                                                                                                                                                   |
|               |                         BytesProcessedNode                                                                                                                                                                                                      |
|               |                           TableScan: customer projection=[c_customer_id, c_current_cdemo_sk, c_current_hdemo_sk, c_current_addr_sk, c_first_name, c_last_name]                                                                                  |
|               |                         Projection: customer_address.ca_address_sk                                                                                                                                                                              |
|               |                           BytesProcessedNode                                                                                                                                                                                                    |
|               |                             Filter: customer_address.ca_city = LargeUtf8("White Oak")                                                                                                                                                           |
|               |                               TableScan: customer_address projection=[ca_address_sk, ca_city]                                                                                                                                                   |
|               |                     BytesProcessedNode                                                                                                                                                                                                          |
|               |                       TableScan: customer_demographics projection=[cd_demo_sk]                                                                                                                                                                  |
|               |                 BytesProcessedNode                                                                                                                                                                                                              |
|               |                   TableScan: household_demographics projection=[hd_demo_sk, hd_income_band_sk]                                                                                                                                                  |
|               |             Projection: income_band.ib_income_band_sk                                                                                                                                                                                           |
|               |               BytesProcessedNode                                                                                                                                                                                                                |
|               |                 Filter: income_band.ib_lower_bound >= Int32(45626) AND income_band.ib_upper_bound <= Int32(95626)                                                                                                                               |
|               |                   TableScan: income_band projection=[ib_income_band_sk, ib_lower_bound, ib_upper_bound]                                                                                                                                         |
|               |         BytesProcessedNode                                                                                                                                                                                                                      |
|               |           TableScan: store_returns projection=[sr_cdemo_sk]                                                                                                                                                                                     |
| physical_plan | ProjectionExec: expr=[customer_id@0 as customer_id, customername@1 as customername]                                                                                                                                                             |
|               |   SortPreservingMergeExec: [c_customer_id@2 ASC NULLS LAST], fetch=100                                                                                                                                                                          |
|               |     SortExec: TopK(fetch=100), expr=[c_customer_id@2 ASC NULLS LAST], preserve_partitioning=[true]                                                                                                                                              |
|               |       ProjectionExec: expr=[c_customer_id@0 as customer_id, coalesce(c_last_name@2, ) || ,  || coalesce(c_first_name@1, ) as customername, c_customer_id@0 as c_customer_id]                                                                    |
|               |         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                             |
|               |           HashJoinExec: mode=Partitioned, join_type=Inner, on=[(cd_demo_sk@3, sr_cdemo_sk@0)], projection=[c_customer_id@0, c_first_name@1, c_last_name@2]                                                                                      |
|               |             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                         |
|               |               RepartitionExec: partitioning=Hash([cd_demo_sk@3], 4), input_partitions=4                                                                                                                                                         |
|               |                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                     |
|               |                   HashJoinExec: mode=Partitioned, join_type=Inner, on=[(hd_income_band_sk@4, ib_income_band_sk@0)], projection=[c_customer_id@0, c_first_name@1, c_last_name@2, cd_demo_sk@3]                                                   |
|               |                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                 |
|               |                       RepartitionExec: partitioning=Hash([hd_income_band_sk@4], 4), input_partitions=4                                                                                                                                          |
|               |                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                             |
|               |                           HashJoinExec: mode=Partitioned, join_type=Inner, on=[(c_current_hdemo_sk@1, hd_demo_sk@0)], projection=[c_customer_id@0, c_first_name@2, c_last_name@3, cd_demo_sk@4, hd_income_band_sk@6]                            |
|               |                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                         |
|               |                               RepartitionExec: partitioning=Hash([c_current_hdemo_sk@1], 4), input_partitions=4                                                                                                                                 |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                     |
|               |                                   HashJoinExec: mode=Partitioned, join_type=Inner, on=[(c_current_cdemo_sk@1, cd_demo_sk@0)], projection=[c_customer_id@0, c_current_hdemo_sk@2, c_first_name@3, c_last_name@4, cd_demo_sk@5]                   |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                 |
|               |                                       RepartitionExec: partitioning=Hash([c_current_cdemo_sk@1], 4), input_partitions=4                                                                                                                         |
|               |                                         CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                             |
|               |                                           HashJoinExec: mode=Partitioned, join_type=Inner, on=[(c_current_addr_sk@3, ca_address_sk@0)], projection=[c_customer_id@0, c_current_cdemo_sk@1, c_current_hdemo_sk@2, c_first_name@4, c_last_name@5] |
|               |                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                         |
|               |                                               RepartitionExec: partitioning=Hash([c_current_addr_sk@3], 4), input_partitions=4                                                                                                                  |
|               |                                                 BytesProcessedExec                                                                                                                                                                              |
|               |                                                   SchemaCastScanExec                                                                                                                                                                            |
|               |                                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                        |
|               |                                                       MemoryExec: partitions=1, partition_sizes=[13]                                                                                                                                            |
|               |                                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                         |
|               |                                               RepartitionExec: partitioning=Hash([ca_address_sk@0], 4), input_partitions=4                                                                                                                      |
|               |                                                 ProjectionExec: expr=[ca_address_sk@0 as ca_address_sk]                                                                                                                                         |
|               |                                                   BytesProcessedExec                                                                                                                                                                            |
|               |                                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                 |
|               |                                                       FilterExec: ca_city@1 = White Oak                                                                                                                                                         |
|               |                                                         SchemaCastScanExec                                                                                                                                                                      |
|               |                                                           RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                  |
|               |                                                             MemoryExec: partitions=1, partition_sizes=[7]                                                                                                                                       |
|               |                                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                 |
|               |                                       RepartitionExec: partitioning=Hash([cd_demo_sk@0], 4), input_partitions=4                                                                                                                                 |
|               |                                         BytesProcessedExec                                                                                                                                                                                      |
|               |                                           SchemaCastScanExec                                                                                                                                                                                    |
|               |                                             RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                |
|               |                                               MemoryExec: partitions=1, partition_sizes=[235]                                                                                                                                                   |
|               |                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                         |
|               |                               RepartitionExec: partitioning=Hash([hd_demo_sk@0], 4), input_partitions=4                                                                                                                                         |
|               |                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                            |
|               |                                   BytesProcessedExec                                                                                                                                                                                            |
|               |                                     SchemaCastScanExec                                                                                                                                                                                          |
|               |                                       MemoryExec: partitions=1, partition_sizes=[1]                                                                                                                                                             |
|               |                     CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                 |
|               |                       RepartitionExec: partitioning=Hash([ib_income_band_sk@0], 4), input_partitions=4                                                                                                                                          |
|               |                         ProjectionExec: expr=[ib_income_band_sk@0 as ib_income_band_sk]                                                                                                                                                         |
|               |                           BytesProcessedExec                                                                                                                                                                                                    |
|               |                             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                         |
|               |                               FilterExec: ib_lower_bound@1 >= 45626 AND ib_upper_bound@2 <= 95626                                                                                                                                               |
|               |                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                            |
|               |                                   SchemaCastScanExec                                                                                                                                                                                            |
|               |                                     MemoryExec: partitions=1, partition_sizes=[1]                                                                                                                                                               |
|               |             CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                         |
|               |               RepartitionExec: partitioning=Hash([sr_cdemo_sk@0], 4), input_partitions=4                                                                                                                                                        |
|               |                 BytesProcessedExec                                                                                                                                                                                                              |
|               |                   SchemaCastScanExec                                                                                                                                                                                                            |
|               |                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                        |
|               |                       MemoryExec: partitions=1, partition_sizes=[36]                                                                                                                                                                            |
|               |                                                                                                                                                                                                                                                 |
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
