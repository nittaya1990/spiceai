---
source: crates/runtime/benches/bench.rs
description: "Query: with ss as (\n select\n          i_manufact_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_manufact_id in (select\n  i_manufact_id\nfrom\n item\nwhere i_category in ('Books'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 4\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -5\n group by i_manufact_id),\n cs as (\n select\n          i_manufact_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_manufact_id               in (select\n  i_manufact_id\nfrom\n item\nwhere i_category in ('Books'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 4\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -5\n group by i_manufact_id),\n ws as (\n select\n          i_manufact_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_manufact_id               in (select\n  i_manufact_id\nfrom\n item\nwhere i_category in ('Books'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 4\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -5\n group by i_manufact_id)\n  select  i_manufact_id ,sum(total_sales) total_sales\n from  (select * from ss\n        union all\n        select * from cs\n        union all\n        select * from ws) tmp1\n group by i_manufact_id\n order by total_sales\n LIMIT 100;\n"
snapshot_kind: text
---
+---------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                               |
+---------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Sort: total_sales ASC NULLS LAST, fetch=100                                                                                                                                                        |
|               |   Projection: tmp1.i_manufact_id, sum(tmp1.total_sales) AS total_sales                                                                                                                             |
|               |     Aggregate: groupBy=[[tmp1.i_manufact_id]], aggr=[[sum(tmp1.total_sales)]]                                                                                                                      |
|               |       SubqueryAlias: tmp1                                                                                                                                                                          |
|               |         Union                                                                                                                                                                                      |
|               |           SubqueryAlias: ss                                                                                                                                                                        |
|               |             Projection: item.i_manufact_id, sum(store_sales.ss_ext_sales_price) AS total_sales                                                                                                     |
|               |               Aggregate: groupBy=[[item.i_manufact_id]], aggr=[[sum(store_sales.ss_ext_sales_price)]]                                                                                              |
|               |                 LeftSemi Join: item.i_manufact_id = __correlated_sq_1.i_manufact_id                                                                                                                |
|               |                   Projection: store_sales.ss_ext_sales_price, item.i_manufact_id                                                                                                                   |
|               |                     Inner Join: store_sales.ss_item_sk = item.i_item_sk                                                                                                                            |
|               |                       Projection: store_sales.ss_item_sk, store_sales.ss_ext_sales_price                                                                                                           |
|               |                         Inner Join: store_sales.ss_addr_sk = customer_address.ca_address_sk                                                                                                        |
|               |                           Projection: store_sales.ss_item_sk, store_sales.ss_addr_sk, store_sales.ss_ext_sales_price                                                                               |
|               |                             Inner Join: store_sales.ss_sold_date_sk = date_dim.d_date_sk                                                                                                           |
|               |                               BytesProcessedNode                                                                                                                                                   |
|               |                                 TableScan: store_sales projection=[ss_sold_date_sk, ss_item_sk, ss_addr_sk, ss_ext_sales_price]                                                                    |
|               |                               Projection: date_dim.d_date_sk                                                                                                                                       |
|               |                                 BytesProcessedNode                                                                                                                                                 |
|               |                                   Filter: date_dim.d_year = Int32(1999) AND date_dim.d_moy = Int32(4)                                                                                              |
|               |                                     TableScan: date_dim projection=[d_date_sk, d_year, d_moy]                                                                                                      |
|               |                           Projection: customer_address.ca_address_sk                                                                                                                               |
|               |                             BytesProcessedNode                                                                                                                                                     |
|               |                               Filter: customer_address.ca_gmt_offset = Decimal128(Some(-500),5,2)                                                                                                  |
|               |                                 TableScan: customer_address projection=[ca_address_sk, ca_gmt_offset]                                                                                              |
|               |                       BytesProcessedNode                                                                                                                                                           |
|               |                         TableScan: item projection=[i_item_sk, i_manufact_id]                                                                                                                      |
|               |                   SubqueryAlias: __correlated_sq_1                                                                                                                                                 |
|               |                     Projection: item.i_manufact_id                                                                                                                                                 |
|               |                       BytesProcessedNode                                                                                                                                                           |
|               |                         Filter: item.i_category = LargeUtf8("Books")                                                                                                                               |
|               |                           TableScan: item projection=[i_category, i_manufact_id]                                                                                                                   |
|               |           SubqueryAlias: cs                                                                                                                                                                        |
|               |             Projection: item.i_manufact_id, sum(catalog_sales.cs_ext_sales_price) AS total_sales                                                                                                   |
|               |               Aggregate: groupBy=[[item.i_manufact_id]], aggr=[[sum(catalog_sales.cs_ext_sales_price)]]                                                                                            |
|               |                 LeftSemi Join: item.i_manufact_id = __correlated_sq_2.i_manufact_id                                                                                                                |
|               |                   Projection: catalog_sales.cs_ext_sales_price, item.i_manufact_id                                                                                                                 |
|               |                     Inner Join: catalog_sales.cs_item_sk = item.i_item_sk                                                                                                                          |
|               |                       Projection: catalog_sales.cs_item_sk, catalog_sales.cs_ext_sales_price                                                                                                       |
|               |                         Inner Join: catalog_sales.cs_bill_addr_sk = customer_address.ca_address_sk                                                                                                 |
|               |                           Projection: catalog_sales.cs_bill_addr_sk, catalog_sales.cs_item_sk, catalog_sales.cs_ext_sales_price                                                                    |
|               |                             Inner Join: catalog_sales.cs_sold_date_sk = date_dim.d_date_sk                                                                                                         |
|               |                               BytesProcessedNode                                                                                                                                                   |
|               |                                 TableScan: catalog_sales projection=[cs_sold_date_sk, cs_bill_addr_sk, cs_item_sk, cs_ext_sales_price]                                                             |
|               |                               Projection: date_dim.d_date_sk                                                                                                                                       |
|               |                                 BytesProcessedNode                                                                                                                                                 |
|               |                                   Filter: date_dim.d_year = Int32(1999) AND date_dim.d_moy = Int32(4)                                                                                              |
|               |                                     TableScan: date_dim projection=[d_date_sk, d_year, d_moy]                                                                                                      |
|               |                           Projection: customer_address.ca_address_sk                                                                                                                               |
|               |                             BytesProcessedNode                                                                                                                                                     |
|               |                               Filter: customer_address.ca_gmt_offset = Decimal128(Some(-500),5,2)                                                                                                  |
|               |                                 TableScan: customer_address projection=[ca_address_sk, ca_gmt_offset]                                                                                              |
|               |                       BytesProcessedNode                                                                                                                                                           |
|               |                         TableScan: item projection=[i_item_sk, i_manufact_id]                                                                                                                      |
|               |                   SubqueryAlias: __correlated_sq_2                                                                                                                                                 |
|               |                     Projection: item.i_manufact_id                                                                                                                                                 |
|               |                       BytesProcessedNode                                                                                                                                                           |
|               |                         Filter: item.i_category = LargeUtf8("Books")                                                                                                                               |
|               |                           TableScan: item projection=[i_category, i_manufact_id]                                                                                                                   |
|               |           SubqueryAlias: ws                                                                                                                                                                        |
|               |             Projection: item.i_manufact_id, sum(web_sales.ws_ext_sales_price) AS total_sales                                                                                                       |
|               |               Aggregate: groupBy=[[item.i_manufact_id]], aggr=[[sum(web_sales.ws_ext_sales_price)]]                                                                                                |
|               |                 LeftSemi Join: item.i_manufact_id = __correlated_sq_3.i_manufact_id                                                                                                                |
|               |                   Projection: web_sales.ws_ext_sales_price, item.i_manufact_id                                                                                                                     |
|               |                     Inner Join: web_sales.ws_item_sk = item.i_item_sk                                                                                                                              |
|               |                       Projection: web_sales.ws_item_sk, web_sales.ws_ext_sales_price                                                                                                               |
|               |                         Inner Join: web_sales.ws_bill_addr_sk = customer_address.ca_address_sk                                                                                                     |
|               |                           Projection: web_sales.ws_item_sk, web_sales.ws_bill_addr_sk, web_sales.ws_ext_sales_price                                                                                |
|               |                             Inner Join: web_sales.ws_sold_date_sk = date_dim.d_date_sk                                                                                                             |
|               |                               BytesProcessedNode                                                                                                                                                   |
|               |                                 TableScan: web_sales projection=[ws_sold_date_sk, ws_item_sk, ws_bill_addr_sk, ws_ext_sales_price]                                                                 |
|               |                               Projection: date_dim.d_date_sk                                                                                                                                       |
|               |                                 BytesProcessedNode                                                                                                                                                 |
|               |                                   Filter: date_dim.d_year = Int32(1999) AND date_dim.d_moy = Int32(4)                                                                                              |
|               |                                     TableScan: date_dim projection=[d_date_sk, d_year, d_moy]                                                                                                      |
|               |                           Projection: customer_address.ca_address_sk                                                                                                                               |
|               |                             BytesProcessedNode                                                                                                                                                     |
|               |                               Filter: customer_address.ca_gmt_offset = Decimal128(Some(-500),5,2)                                                                                                  |
|               |                                 TableScan: customer_address projection=[ca_address_sk, ca_gmt_offset]                                                                                              |
|               |                       BytesProcessedNode                                                                                                                                                           |
|               |                         TableScan: item projection=[i_item_sk, i_manufact_id]                                                                                                                      |
|               |                   SubqueryAlias: __correlated_sq_3                                                                                                                                                 |
|               |                     Projection: item.i_manufact_id                                                                                                                                                 |
|               |                       BytesProcessedNode                                                                                                                                                           |
|               |                         Filter: item.i_category = LargeUtf8("Books")                                                                                                                               |
|               |                           TableScan: item projection=[i_category, i_manufact_id]                                                                                                                   |
| physical_plan | SortPreservingMergeExec: [total_sales@1 ASC NULLS LAST], fetch=100                                                                                                                                 |
|               |   SortExec: TopK(fetch=100), expr=[total_sales@1 ASC NULLS LAST], preserve_partitioning=[true]                                                                                                     |
|               |     ProjectionExec: expr=[i_manufact_id@0 as i_manufact_id, sum(tmp1.total_sales)@1 as total_sales]                                                                                                |
|               |       AggregateExec: mode=SinglePartitioned, gby=[i_manufact_id@0 as i_manufact_id], aggr=[sum(tmp1.total_sales)]                                                                                  |
|               |         InterleaveExec                                                                                                                                                                             |
|               |           ProjectionExec: expr=[i_manufact_id@0 as i_manufact_id, sum(store_sales.ss_ext_sales_price)@1 as total_sales]                                                                            |
|               |             AggregateExec: mode=SinglePartitioned, gby=[i_manufact_id@1 as i_manufact_id], aggr=[sum(store_sales.ss_ext_sales_price)]                                                              |
|               |               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                          |
|               |                 HashJoinExec: mode=Partitioned, join_type=LeftSemi, on=[(i_manufact_id@1, i_manufact_id@0)]                                                                                        |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                      |
|               |                     RepartitionExec: partitioning=Hash([i_manufact_id@1], 4), input_partitions=4                                                                                                   |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                  |
|               |                         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_item_sk@0, i_item_sk@0)], projection=[ss_ext_sales_price@1, i_manufact_id@3]                                      |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                              |
|               |                             RepartitionExec: partitioning=Hash([ss_item_sk@0], 4), input_partitions=4                                                                                              |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                          |
|               |                                 HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_addr_sk@1, ca_address_sk@0)], projection=[ss_item_sk@0, ss_ext_sales_price@2]                             |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                      |
|               |                                     RepartitionExec: partitioning=Hash([ss_addr_sk@1], 4), input_partitions=4                                                                                      |
|               |                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                  |
|               |                                         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_sold_date_sk@0, d_date_sk@0)], projection=[ss_item_sk@1, ss_addr_sk@2, ss_ext_sales_price@3]      |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                              |
|               |                                             RepartitionExec: partitioning=Hash([ss_sold_date_sk@0], 4), input_partitions=4                                                                         |
|               |                                               BytesProcessedExec                                                                                                                                   |
|               |                                                 SchemaCastScanExec                                                                                                                                 |
|               |                                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                             |
|               |                                                     MemoryExec: partitions=1, partition_sizes=[352]                                                                                                |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                              |
|               |                                             RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                               |
|               |                                               ProjectionExec: expr=[d_date_sk@0 as d_date_sk]                                                                                                      |
|               |                                                 BytesProcessedExec                                                                                                                                 |
|               |                                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                      |
|               |                                                     FilterExec: d_year@1 = 1999 AND d_moy@2 = 4                                                                                                    |
|               |                                                       SchemaCastScanExec                                                                                                                           |
|               |                                                         RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                       |
|               |                                                           MemoryExec: partitions=1, partition_sizes=[9]                                                                                            |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                      |
|               |                                     RepartitionExec: partitioning=Hash([ca_address_sk@0], 4), input_partitions=4                                                                                   |
|               |                                       ProjectionExec: expr=[ca_address_sk@0 as ca_address_sk]                                                                                                      |
|               |                                         BytesProcessedExec                                                                                                                                         |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                              |
|               |                                             FilterExec: ca_gmt_offset@1 = Some(-500),5,2                                                                                                           |
|               |                                               SchemaCastScanExec                                                                                                                                   |
|               |                                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                               |
|               |                                                   MemoryExec: partitions=1, partition_sizes=[7]                                                                                                    |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                              |
|               |                             RepartitionExec: partitioning=Hash([i_item_sk@0], 4), input_partitions=4                                                                                               |
|               |                               BytesProcessedExec                                                                                                                                                   |
|               |                                 SchemaCastScanExec                                                                                                                                                 |
|               |                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                             |
|               |                                     MemoryExec: partitions=1, partition_sizes=[3]                                                                                                                  |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                      |
|               |                     RepartitionExec: partitioning=Hash([i_manufact_id@0], 4), input_partitions=4                                                                                                   |
|               |                       ProjectionExec: expr=[i_manufact_id@1 as i_manufact_id]                                                                                                                      |
|               |                         BytesProcessedExec                                                                                                                                                         |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                              |
|               |                             FilterExec: i_category@0 = Books                                                                                                                                       |
|               |                               SchemaCastScanExec                                                                                                                                                   |
|               |                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                               |
|               |                                   MemoryExec: partitions=1, partition_sizes=[3]                                                                                                                    |
|               |           ProjectionExec: expr=[i_manufact_id@0 as i_manufact_id, sum(catalog_sales.cs_ext_sales_price)@1 as total_sales]                                                                          |
|               |             AggregateExec: mode=SinglePartitioned, gby=[i_manufact_id@1 as i_manufact_id], aggr=[sum(catalog_sales.cs_ext_sales_price)]                                                            |
|               |               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                          |
|               |                 HashJoinExec: mode=Partitioned, join_type=LeftSemi, on=[(i_manufact_id@1, i_manufact_id@0)]                                                                                        |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                      |
|               |                     RepartitionExec: partitioning=Hash([i_manufact_id@1], 4), input_partitions=4                                                                                                   |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                  |
|               |                         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(cs_item_sk@0, i_item_sk@0)], projection=[cs_ext_sales_price@1, i_manufact_id@3]                                      |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                              |
|               |                             RepartitionExec: partitioning=Hash([cs_item_sk@0], 4), input_partitions=4                                                                                              |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                          |
|               |                                 HashJoinExec: mode=Partitioned, join_type=Inner, on=[(cs_bill_addr_sk@0, ca_address_sk@0)], projection=[cs_item_sk@1, cs_ext_sales_price@2]                        |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                      |
|               |                                     RepartitionExec: partitioning=Hash([cs_bill_addr_sk@0], 4), input_partitions=4                                                                                 |
|               |                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                  |
|               |                                         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(cs_sold_date_sk@0, d_date_sk@0)], projection=[cs_bill_addr_sk@1, cs_item_sk@2, cs_ext_sales_price@3] |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                              |
|               |                                             RepartitionExec: partitioning=Hash([cs_sold_date_sk@0], 4), input_partitions=4                                                                         |
|               |                                               BytesProcessedExec                                                                                                                                   |
|               |                                                 SchemaCastScanExec                                                                                                                                 |
|               |                                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                             |
|               |                                                     MemoryExec: partitions=1, partition_sizes=[176]                                                                                                |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                              |
|               |                                             RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                               |
|               |                                               ProjectionExec: expr=[d_date_sk@0 as d_date_sk]                                                                                                      |
|               |                                                 BytesProcessedExec                                                                                                                                 |
|               |                                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                      |
|               |                                                     FilterExec: d_year@1 = 1999 AND d_moy@2 = 4                                                                                                    |
|               |                                                       SchemaCastScanExec                                                                                                                           |
|               |                                                         RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                       |
|               |                                                           MemoryExec: partitions=1, partition_sizes=[9]                                                                                            |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                      |
|               |                                     RepartitionExec: partitioning=Hash([ca_address_sk@0], 4), input_partitions=4                                                                                   |
|               |                                       ProjectionExec: expr=[ca_address_sk@0 as ca_address_sk]                                                                                                      |
|               |                                         BytesProcessedExec                                                                                                                                         |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                              |
|               |                                             FilterExec: ca_gmt_offset@1 = Some(-500),5,2                                                                                                           |
|               |                                               SchemaCastScanExec                                                                                                                                   |
|               |                                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                               |
|               |                                                   MemoryExec: partitions=1, partition_sizes=[7]                                                                                                    |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                              |
|               |                             RepartitionExec: partitioning=Hash([i_item_sk@0], 4), input_partitions=4                                                                                               |
|               |                               BytesProcessedExec                                                                                                                                                   |
|               |                                 SchemaCastScanExec                                                                                                                                                 |
|               |                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                             |
|               |                                     MemoryExec: partitions=1, partition_sizes=[3]                                                                                                                  |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                      |
|               |                     RepartitionExec: partitioning=Hash([i_manufact_id@0], 4), input_partitions=4                                                                                                   |
|               |                       ProjectionExec: expr=[i_manufact_id@1 as i_manufact_id]                                                                                                                      |
|               |                         BytesProcessedExec                                                                                                                                                         |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                              |
|               |                             FilterExec: i_category@0 = Books                                                                                                                                       |
|               |                               SchemaCastScanExec                                                                                                                                                   |
|               |                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                               |
|               |                                   MemoryExec: partitions=1, partition_sizes=[3]                                                                                                                    |
|               |           ProjectionExec: expr=[i_manufact_id@0 as i_manufact_id, sum(web_sales.ws_ext_sales_price)@1 as total_sales]                                                                              |
|               |             AggregateExec: mode=SinglePartitioned, gby=[i_manufact_id@1 as i_manufact_id], aggr=[sum(web_sales.ws_ext_sales_price)]                                                                |
|               |               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                          |
|               |                 HashJoinExec: mode=Partitioned, join_type=LeftSemi, on=[(i_manufact_id@1, i_manufact_id@0)]                                                                                        |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                      |
|               |                     RepartitionExec: partitioning=Hash([i_manufact_id@1], 4), input_partitions=4                                                                                                   |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                  |
|               |                         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ws_item_sk@0, i_item_sk@0)], projection=[ws_ext_sales_price@1, i_manufact_id@3]                                      |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                              |
|               |                             RepartitionExec: partitioning=Hash([ws_item_sk@0], 4), input_partitions=4                                                                                              |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                          |
|               |                                 HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ws_bill_addr_sk@1, ca_address_sk@0)], projection=[ws_item_sk@0, ws_ext_sales_price@2]                        |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                      |
|               |                                     RepartitionExec: partitioning=Hash([ws_bill_addr_sk@1], 4), input_partitions=4                                                                                 |
|               |                                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                  |
|               |                                         HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ws_sold_date_sk@0, d_date_sk@0)], projection=[ws_item_sk@1, ws_bill_addr_sk@2, ws_ext_sales_price@3] |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                              |
|               |                                             RepartitionExec: partitioning=Hash([ws_sold_date_sk@0], 4), input_partitions=4                                                                         |
|               |                                               BytesProcessedExec                                                                                                                                   |
|               |                                                 SchemaCastScanExec                                                                                                                                 |
|               |                                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                             |
|               |                                                     MemoryExec: partitions=1, partition_sizes=[88]                                                                                                 |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                              |
|               |                                             RepartitionExec: partitioning=Hash([d_date_sk@0], 4), input_partitions=4                                                                               |
|               |                                               ProjectionExec: expr=[d_date_sk@0 as d_date_sk]                                                                                                      |
|               |                                                 BytesProcessedExec                                                                                                                                 |
|               |                                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                      |
|               |                                                     FilterExec: d_year@1 = 1999 AND d_moy@2 = 4                                                                                                    |
|               |                                                       SchemaCastScanExec                                                                                                                           |
|               |                                                         RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                       |
|               |                                                           MemoryExec: partitions=1, partition_sizes=[9]                                                                                            |
|               |                                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                      |
|               |                                     RepartitionExec: partitioning=Hash([ca_address_sk@0], 4), input_partitions=4                                                                                   |
|               |                                       ProjectionExec: expr=[ca_address_sk@0 as ca_address_sk]                                                                                                      |
|               |                                         BytesProcessedExec                                                                                                                                         |
|               |                                           CoalesceBatchesExec: target_batch_size=8192                                                                                                              |
|               |                                             FilterExec: ca_gmt_offset@1 = Some(-500),5,2                                                                                                           |
|               |                                               SchemaCastScanExec                                                                                                                                   |
|               |                                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                               |
|               |                                                   MemoryExec: partitions=1, partition_sizes=[7]                                                                                                    |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                              |
|               |                             RepartitionExec: partitioning=Hash([i_item_sk@0], 4), input_partitions=4                                                                                               |
|               |                               BytesProcessedExec                                                                                                                                                   |
|               |                                 SchemaCastScanExec                                                                                                                                                 |
|               |                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                             |
|               |                                     MemoryExec: partitions=1, partition_sizes=[3]                                                                                                                  |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                      |
|               |                     RepartitionExec: partitioning=Hash([i_manufact_id@0], 4), input_partitions=4                                                                                                   |
|               |                       ProjectionExec: expr=[i_manufact_id@1 as i_manufact_id]                                                                                                                      |
|               |                         BytesProcessedExec                                                                                                                                                         |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                              |
|               |                             FilterExec: i_category@0 = Books                                                                                                                                       |
|               |                               SchemaCastScanExec                                                                                                                                                   |
|               |                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                               |
|               |                                   MemoryExec: partitions=1, partition_sizes=[3]                                                                                                                    |
|               |                                                                                                                                                                                                    |
+---------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
