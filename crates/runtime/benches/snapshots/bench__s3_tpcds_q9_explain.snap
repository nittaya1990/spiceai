---
source: crates/runtime/benches/bench.rs
description: "Query: select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 31002\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 588\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 2456\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 21645\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 20553\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1\n;\n"
snapshot_kind: text
---
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Projection: CASE WHEN __scalar_sq_1.count(*) > Int64(31002) THEN __scalar_sq_2.avg(store_sales.ss_ext_discount_amt) ELSE __scalar_sq_3.avg(store_sales.ss_net_profit) END AS bucket1, CASE WHEN __scalar_sq_4.count(*) > Int64(588) THEN __scalar_sq_5.avg(store_sales.ss_ext_discount_amt) ELSE __scalar_sq_6.avg(store_sales.ss_net_profit) END AS bucket2, CASE WHEN __scalar_sq_7.count(*) > Int64(2456) THEN __scalar_sq_8.avg(store_sales.ss_ext_discount_amt) ELSE __scalar_sq_9.avg(store_sales.ss_net_profit) END AS bucket3, CASE WHEN __scalar_sq_10.count(*) > Int64(21645) THEN __scalar_sq_11.avg(store_sales.ss_ext_discount_amt) ELSE __scalar_sq_12.avg(store_sales.ss_net_profit) END AS bucket4, CASE WHEN __scalar_sq_13.count(*) > Int64(20553) THEN __scalar_sq_14.avg(store_sales.ss_ext_discount_amt) ELSE __scalar_sq_15.avg(store_sales.ss_net_profit) END AS bucket5 |
|               |   Left Join:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |     Left Join:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |       Left Join:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |         Left Join:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |           Left Join:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |             Left Join:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |               Left Join:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                 Left Join:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                   Left Join:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                     Left Join:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                       Left Join:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                         Left Join:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                           Left Join:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                             Left Join:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                               Left Join:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                 BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                   TableScan: reason projection=[], full_filters=[reason.r_reason_sk = Int32(1)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                 SubqueryAlias: __scalar_sq_1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                   Aggregate: groupBy=[[]], aggr=[[count(Int64(1)) AS count(*)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                     BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                       TableScan: store_sales projection=[], full_filters=[store_sales.ss_quantity >= Int32(1), store_sales.ss_quantity <= Int32(20)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                               SubqueryAlias: __scalar_sq_2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                 Aggregate: groupBy=[[]], aggr=[[avg(store_sales.ss_ext_discount_amt)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                   BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                     TableScan: store_sales projection=[ss_ext_discount_amt], full_filters=[store_sales.ss_quantity >= Int32(1), store_sales.ss_quantity <= Int32(20)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                             SubqueryAlias: __scalar_sq_3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                               Aggregate: groupBy=[[]], aggr=[[avg(store_sales.ss_net_profit)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                 BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                   TableScan: store_sales projection=[ss_net_profit], full_filters=[store_sales.ss_quantity >= Int32(1), store_sales.ss_quantity <= Int32(20)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                           SubqueryAlias: __scalar_sq_4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                             Aggregate: groupBy=[[]], aggr=[[count(Int64(1)) AS count(*)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                 TableScan: store_sales projection=[], full_filters=[store_sales.ss_quantity >= Int32(21), store_sales.ss_quantity <= Int32(40)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                         SubqueryAlias: __scalar_sq_5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                           Aggregate: groupBy=[[]], aggr=[[avg(store_sales.ss_ext_discount_amt)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                             BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                               TableScan: store_sales projection=[ss_ext_discount_amt], full_filters=[store_sales.ss_quantity >= Int32(21), store_sales.ss_quantity <= Int32(40)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                       SubqueryAlias: __scalar_sq_6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                         Aggregate: groupBy=[[]], aggr=[[avg(store_sales.ss_net_profit)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                           BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                             TableScan: store_sales projection=[ss_net_profit], full_filters=[store_sales.ss_quantity >= Int32(21), store_sales.ss_quantity <= Int32(40)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                     SubqueryAlias: __scalar_sq_7                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                       Aggregate: groupBy=[[]], aggr=[[count(Int64(1)) AS count(*)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                         BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                           TableScan: store_sales projection=[], full_filters=[store_sales.ss_quantity >= Int32(41), store_sales.ss_quantity <= Int32(60)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                   SubqueryAlias: __scalar_sq_8                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                     Aggregate: groupBy=[[]], aggr=[[avg(store_sales.ss_ext_discount_amt)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                       BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                         TableScan: store_sales projection=[ss_ext_discount_amt], full_filters=[store_sales.ss_quantity >= Int32(41), store_sales.ss_quantity <= Int32(60)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                 SubqueryAlias: __scalar_sq_9                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                   Aggregate: groupBy=[[]], aggr=[[avg(store_sales.ss_net_profit)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                     BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                       TableScan: store_sales projection=[ss_net_profit], full_filters=[store_sales.ss_quantity >= Int32(41), store_sales.ss_quantity <= Int32(60)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |               SubqueryAlias: __scalar_sq_10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                 Aggregate: groupBy=[[]], aggr=[[count(Int64(1)) AS count(*)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                   BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                     TableScan: store_sales projection=[], full_filters=[store_sales.ss_quantity >= Int32(61), store_sales.ss_quantity <= Int32(80)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |             SubqueryAlias: __scalar_sq_11                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |               Aggregate: groupBy=[[]], aggr=[[avg(store_sales.ss_ext_discount_amt)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                 BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                   TableScan: store_sales projection=[ss_ext_discount_amt], full_filters=[store_sales.ss_quantity >= Int32(61), store_sales.ss_quantity <= Int32(80)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |           SubqueryAlias: __scalar_sq_12                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |             Aggregate: groupBy=[[]], aggr=[[avg(store_sales.ss_net_profit)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                 TableScan: store_sales projection=[ss_net_profit], full_filters=[store_sales.ss_quantity >= Int32(61), store_sales.ss_quantity <= Int32(80)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |         SubqueryAlias: __scalar_sq_13                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |           Aggregate: groupBy=[[]], aggr=[[count(Int64(1)) AS count(*)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |             BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |               TableScan: store_sales projection=[], full_filters=[store_sales.ss_quantity >= Int32(81), store_sales.ss_quantity <= Int32(100)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |       SubqueryAlias: __scalar_sq_14                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |         Aggregate: groupBy=[[]], aggr=[[avg(store_sales.ss_ext_discount_amt)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |           BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |             TableScan: store_sales projection=[ss_ext_discount_amt], full_filters=[store_sales.ss_quantity >= Int32(81), store_sales.ss_quantity <= Int32(100)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |     SubqueryAlias: __scalar_sq_15                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |       Aggregate: groupBy=[[]], aggr=[[avg(store_sales.ss_net_profit)]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |         BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |           TableScan: store_sales projection=[ss_net_profit], full_filters=[store_sales.ss_quantity >= Int32(81), store_sales.ss_quantity <= Int32(100)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| physical_plan | ProjectionExec: expr=[CASE WHEN count(*)@0 > 31002 THEN avg(store_sales.ss_ext_discount_amt)@1 ELSE avg(store_sales.ss_net_profit)@2 END as bucket1, CASE WHEN count(*)@3 > 588 THEN avg(store_sales.ss_ext_discount_amt)@4 ELSE avg(store_sales.ss_net_profit)@5 END as bucket2, CASE WHEN count(*)@6 > 2456 THEN avg(store_sales.ss_ext_discount_amt)@7 ELSE avg(store_sales.ss_net_profit)@8 END as bucket3, CASE WHEN count(*)@9 > 21645 THEN avg(store_sales.ss_ext_discount_amt)@10 ELSE avg(store_sales.ss_net_profit)@11 END as bucket4, CASE WHEN count(*)@12 > 20553 THEN avg(store_sales.ss_ext_discount_amt)@13 ELSE avg(store_sales.ss_net_profit)@14 END as bucket5]                                                                                                                                                                                                              |
|               |   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |     NestedLoopJoinExec: join_type=Left                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |       NestedLoopJoinExec: join_type=Left                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |         NestedLoopJoinExec: join_type=Left                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |           NestedLoopJoinExec: join_type=Left                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |             NestedLoopJoinExec: join_type=Left                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |               NestedLoopJoinExec: join_type=Left                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                 NestedLoopJoinExec: join_type=Left                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                   NestedLoopJoinExec: join_type=Left                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                     NestedLoopJoinExec: join_type=Left                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                       NestedLoopJoinExec: join_type=Left                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                         NestedLoopJoinExec: join_type=Left                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                           NestedLoopJoinExec: join_type=Left                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                             NestedLoopJoinExec: join_type=Left                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                               NestedLoopJoinExec: join_type=Left                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                 NestedLoopJoinExec: join_type=Left                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                   BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                     ParquetExec: file_groups={1 group: [[tpcds_sf1/reason/reason.parquet]]}, predicate=r_reason_sk@0 = 1, pruning_predicate=CASE WHEN r_reason_sk_null_count@2 = r_reason_sk_row_count@3 THEN false ELSE r_reason_sk_min@0 <= 1 AND 1 <= r_reason_sk_max@1 END, required_guarantees=[N]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                   AggregateExec: mode=Final, gby=[], aggr=[count(*)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                     CoalescePartitionsExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                       AggregateExec: mode=Partial, gby=[], aggr=[count(*)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                         BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                           ParquetExec: file_groups={4 groups: [[tpcds_sf1/store_sales/store_sales.parquet:0..38551918], [tpcds_sf1/store_sales/store_sales.parquet:38551918..77103836], [tpcds_sf1/store_sales/store_sales.parquet:77103836..115655754], [tpcds_sf1/store_sales/store_sales.parquet:115655754..154207672]]}, predicate=ss_quantity@10 >= 1 AND ss_quantity@10 <= 20, pruning_predicate=CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_max@0 >= 1 END AND CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_min@3 <= 20 END, required_guarantees=[N]                                                                                                                                                                                                                             |
|               |                                 AggregateExec: mode=Final, gby=[], aggr=[avg(store_sales.ss_ext_discount_amt)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                   CoalescePartitionsExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                     AggregateExec: mode=Partial, gby=[], aggr=[avg(store_sales.ss_ext_discount_amt)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                       BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                                         ParquetExec: file_groups={4 groups: [[tpcds_sf1/store_sales/store_sales.parquet:0..38551918], [tpcds_sf1/store_sales/store_sales.parquet:38551918..77103836], [tpcds_sf1/store_sales/store_sales.parquet:77103836..115655754], [tpcds_sf1/store_sales/store_sales.parquet:115655754..154207672]]}, projection=[ss_ext_discount_amt], predicate=ss_quantity@10 >= 1 AND ss_quantity@10 <= 20, pruning_predicate=CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_max@0 >= 1 END AND CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_min@3 <= 20 END, required_guarantees=[N]                                                                                                                                                                                             |
|               |                               AggregateExec: mode=Final, gby=[], aggr=[avg(store_sales.ss_net_profit)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                 CoalescePartitionsExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                   AggregateExec: mode=Partial, gby=[], aggr=[avg(store_sales.ss_net_profit)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                     BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                                       ParquetExec: file_groups={4 groups: [[tpcds_sf1/store_sales/store_sales.parquet:0..38551918], [tpcds_sf1/store_sales/store_sales.parquet:38551918..77103836], [tpcds_sf1/store_sales/store_sales.parquet:77103836..115655754], [tpcds_sf1/store_sales/store_sales.parquet:115655754..154207672]]}, projection=[ss_net_profit], predicate=ss_quantity@10 >= 1 AND ss_quantity@10 <= 20, pruning_predicate=CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_max@0 >= 1 END AND CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_min@3 <= 20 END, required_guarantees=[N]                                                                                                                                                                                                     |
|               |                             AggregateExec: mode=Final, gby=[], aggr=[count(*)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                               CoalescePartitionsExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                 AggregateExec: mode=Partial, gby=[], aggr=[count(*)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                   BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                                     ParquetExec: file_groups={4 groups: [[tpcds_sf1/store_sales/store_sales.parquet:0..38551918], [tpcds_sf1/store_sales/store_sales.parquet:38551918..77103836], [tpcds_sf1/store_sales/store_sales.parquet:77103836..115655754], [tpcds_sf1/store_sales/store_sales.parquet:115655754..154207672]]}, predicate=ss_quantity@10 >= 21 AND ss_quantity@10 <= 40, pruning_predicate=CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_max@0 >= 21 END AND CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_min@3 <= 40 END, required_guarantees=[N]                                                                                                                                                                                                                                 |
|               |                           AggregateExec: mode=Final, gby=[], aggr=[avg(store_sales.ss_ext_discount_amt)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                             CoalescePartitionsExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                               AggregateExec: mode=Partial, gby=[], aggr=[avg(store_sales.ss_ext_discount_amt)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                 BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                                   ParquetExec: file_groups={4 groups: [[tpcds_sf1/store_sales/store_sales.parquet:0..38551918], [tpcds_sf1/store_sales/store_sales.parquet:38551918..77103836], [tpcds_sf1/store_sales/store_sales.parquet:77103836..115655754], [tpcds_sf1/store_sales/store_sales.parquet:115655754..154207672]]}, projection=[ss_ext_discount_amt], predicate=ss_quantity@10 >= 21 AND ss_quantity@10 <= 40, pruning_predicate=CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_max@0 >= 21 END AND CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_min@3 <= 40 END, required_guarantees=[N]                                                                                                                                                                                                 |
|               |                         AggregateExec: mode=Final, gby=[], aggr=[avg(store_sales.ss_net_profit)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                           CoalescePartitionsExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                             AggregateExec: mode=Partial, gby=[], aggr=[avg(store_sales.ss_net_profit)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                               BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                 ParquetExec: file_groups={4 groups: [[tpcds_sf1/store_sales/store_sales.parquet:0..38551918], [tpcds_sf1/store_sales/store_sales.parquet:38551918..77103836], [tpcds_sf1/store_sales/store_sales.parquet:77103836..115655754], [tpcds_sf1/store_sales/store_sales.parquet:115655754..154207672]]}, projection=[ss_net_profit], predicate=ss_quantity@10 >= 21 AND ss_quantity@10 <= 40, pruning_predicate=CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_max@0 >= 21 END AND CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_min@3 <= 40 END, required_guarantees=[N]                                                                                                                                                                                                         |
|               |                       AggregateExec: mode=Final, gby=[], aggr=[count(*)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                         CoalescePartitionsExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                           AggregateExec: mode=Partial, gby=[], aggr=[count(*)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                             BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                               ParquetExec: file_groups={4 groups: [[tpcds_sf1/store_sales/store_sales.parquet:0..38551918], [tpcds_sf1/store_sales/store_sales.parquet:38551918..77103836], [tpcds_sf1/store_sales/store_sales.parquet:77103836..115655754], [tpcds_sf1/store_sales/store_sales.parquet:115655754..154207672]]}, predicate=ss_quantity@10 >= 41 AND ss_quantity@10 <= 60, pruning_predicate=CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_max@0 >= 41 END AND CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_min@3 <= 60 END, required_guarantees=[N]                                                                                                                                                                                                                                       |
|               |                     AggregateExec: mode=Final, gby=[], aggr=[avg(store_sales.ss_ext_discount_amt)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                       CoalescePartitionsExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                         AggregateExec: mode=Partial, gby=[], aggr=[avg(store_sales.ss_ext_discount_amt)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                           BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                             ParquetExec: file_groups={4 groups: [[tpcds_sf1/store_sales/store_sales.parquet:0..38551918], [tpcds_sf1/store_sales/store_sales.parquet:38551918..77103836], [tpcds_sf1/store_sales/store_sales.parquet:77103836..115655754], [tpcds_sf1/store_sales/store_sales.parquet:115655754..154207672]]}, projection=[ss_ext_discount_amt], predicate=ss_quantity@10 >= 41 AND ss_quantity@10 <= 60, pruning_predicate=CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_max@0 >= 41 END AND CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_min@3 <= 60 END, required_guarantees=[N]                                                                                                                                                                                                       |
|               |                   AggregateExec: mode=Final, gby=[], aggr=[avg(store_sales.ss_net_profit)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                     CoalescePartitionsExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                       AggregateExec: mode=Partial, gby=[], aggr=[avg(store_sales.ss_net_profit)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                         BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                           ParquetExec: file_groups={4 groups: [[tpcds_sf1/store_sales/store_sales.parquet:0..38551918], [tpcds_sf1/store_sales/store_sales.parquet:38551918..77103836], [tpcds_sf1/store_sales/store_sales.parquet:77103836..115655754], [tpcds_sf1/store_sales/store_sales.parquet:115655754..154207672]]}, projection=[ss_net_profit], predicate=ss_quantity@10 >= 41 AND ss_quantity@10 <= 60, pruning_predicate=CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_max@0 >= 41 END AND CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_min@3 <= 60 END, required_guarantees=[N]                                                                                                                                                                                                               |
|               |                 AggregateExec: mode=Final, gby=[], aggr=[count(*)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                   CoalescePartitionsExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                     AggregateExec: mode=Partial, gby=[], aggr=[count(*)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                       BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                         ParquetExec: file_groups={4 groups: [[tpcds_sf1/store_sales/store_sales.parquet:0..38551918], [tpcds_sf1/store_sales/store_sales.parquet:38551918..77103836], [tpcds_sf1/store_sales/store_sales.parquet:77103836..115655754], [tpcds_sf1/store_sales/store_sales.parquet:115655754..154207672]]}, predicate=ss_quantity@10 >= 61 AND ss_quantity@10 <= 80, pruning_predicate=CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_max@0 >= 61 END AND CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_min@3 <= 80 END, required_guarantees=[N]                                                                                                                                                                                                                                             |
|               |               AggregateExec: mode=Final, gby=[], aggr=[avg(store_sales.ss_ext_discount_amt)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                 CoalescePartitionsExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                   AggregateExec: mode=Partial, gby=[], aggr=[avg(store_sales.ss_ext_discount_amt)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                     BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                       ParquetExec: file_groups={4 groups: [[tpcds_sf1/store_sales/store_sales.parquet:0..38551918], [tpcds_sf1/store_sales/store_sales.parquet:38551918..77103836], [tpcds_sf1/store_sales/store_sales.parquet:77103836..115655754], [tpcds_sf1/store_sales/store_sales.parquet:115655754..154207672]]}, projection=[ss_ext_discount_amt], predicate=ss_quantity@10 >= 61 AND ss_quantity@10 <= 80, pruning_predicate=CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_max@0 >= 61 END AND CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_min@3 <= 80 END, required_guarantees=[N]                                                                                                                                                                                                             |
|               |             AggregateExec: mode=Final, gby=[], aggr=[avg(store_sales.ss_net_profit)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |               CoalescePartitionsExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                 AggregateExec: mode=Partial, gby=[], aggr=[avg(store_sales.ss_net_profit)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                   BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                     ParquetExec: file_groups={4 groups: [[tpcds_sf1/store_sales/store_sales.parquet:0..38551918], [tpcds_sf1/store_sales/store_sales.parquet:38551918..77103836], [tpcds_sf1/store_sales/store_sales.parquet:77103836..115655754], [tpcds_sf1/store_sales/store_sales.parquet:115655754..154207672]]}, projection=[ss_net_profit], predicate=ss_quantity@10 >= 61 AND ss_quantity@10 <= 80, pruning_predicate=CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_max@0 >= 61 END AND CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_min@3 <= 80 END, required_guarantees=[N]                                                                                                                                                                                                                     |
|               |           AggregateExec: mode=Final, gby=[], aggr=[count(*)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |             CoalescePartitionsExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |               AggregateExec: mode=Partial, gby=[], aggr=[count(*)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                 BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                   ParquetExec: file_groups={4 groups: [[tpcds_sf1/store_sales/store_sales.parquet:0..38551918], [tpcds_sf1/store_sales/store_sales.parquet:38551918..77103836], [tpcds_sf1/store_sales/store_sales.parquet:77103836..115655754], [tpcds_sf1/store_sales/store_sales.parquet:115655754..154207672]]}, predicate=ss_quantity@10 >= 81 AND ss_quantity@10 <= 100, pruning_predicate=CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_max@0 >= 81 END AND CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_min@3 <= 100 END, required_guarantees=[N]                                                                                                                                                                                                                                                 |
|               |         AggregateExec: mode=Final, gby=[], aggr=[avg(store_sales.ss_ext_discount_amt)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |           CoalescePartitionsExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |             AggregateExec: mode=Partial, gby=[], aggr=[avg(store_sales.ss_ext_discount_amt)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |               BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                 ParquetExec: file_groups={4 groups: [[tpcds_sf1/store_sales/store_sales.parquet:0..38551918], [tpcds_sf1/store_sales/store_sales.parquet:38551918..77103836], [tpcds_sf1/store_sales/store_sales.parquet:77103836..115655754], [tpcds_sf1/store_sales/store_sales.parquet:115655754..154207672]]}, projection=[ss_ext_discount_amt], predicate=ss_quantity@10 >= 81 AND ss_quantity@10 <= 100, pruning_predicate=CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_max@0 >= 81 END AND CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_min@3 <= 100 END, required_guarantees=[N]                                                                                                                                                                                                                 |
|               |       AggregateExec: mode=Final, gby=[], aggr=[avg(store_sales.ss_net_profit)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |         CoalescePartitionsExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |           AggregateExec: mode=Partial, gby=[], aggr=[avg(store_sales.ss_net_profit)]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |             BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |               ParquetExec: file_groups={4 groups: [[tpcds_sf1/store_sales/store_sales.parquet:0..38551918], [tpcds_sf1/store_sales/store_sales.parquet:38551918..77103836], [tpcds_sf1/store_sales/store_sales.parquet:77103836..115655754], [tpcds_sf1/store_sales/store_sales.parquet:115655754..154207672]]}, projection=[ss_net_profit], predicate=ss_quantity@10 >= 81 AND ss_quantity@10 <= 100, pruning_predicate=CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_max@0 >= 81 END AND CASE WHEN ss_quantity_null_count@1 = ss_quantity_row_count@2 THEN false ELSE ss_quantity_min@3 <= 100 END, required_guarantees=[N]                                                                                                                                                                                                                         |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+---------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
