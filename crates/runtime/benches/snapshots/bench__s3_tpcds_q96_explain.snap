---
source: crates/runtime/benches/bench.rs
description: "Query: select  count(*)\nfrom store_sales\n    ,household_demographics\n    ,time_dim, store\nwhere ss_sold_time_sk = time_dim.t_time_sk\n    and ss_hdemo_sk = household_demographics.hd_demo_sk\n    and ss_store_sk = s_store_sk\n    and time_dim.t_hour = 8\n    and time_dim.t_minute >= 30\n    and household_demographics.hd_dep_count = 5\n    and store.s_store_name = 'ese'\norder by count(*)\n LIMIT 100;\n"
snapshot_kind: text
---
+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Sort: count(*) ASC NULLS LAST, fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |   Aggregate: groupBy=[[]], aggr=[[count(Int64(1)) AS count(*)]]                                                                                                                                                                                                                                                                                                                                                                                           |
|               |     Projection:                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |       Inner Join: store_sales.ss_store_sk = store.s_store_sk                                                                                                                                                                                                                                                                                                                                                                                              |
|               |         Projection: store_sales.ss_store_sk                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |           Inner Join: store_sales.ss_sold_time_sk = time_dim.t_time_sk                                                                                                                                                                                                                                                                                                                                                                                    |
|               |             Projection: store_sales.ss_sold_time_sk, store_sales.ss_store_sk                                                                                                                                                                                                                                                                                                                                                                              |
|               |               Inner Join: store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk                                                                                                                                                                                                                                                                                                                                                                     |
|               |                 BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                   TableScan: store_sales projection=[ss_sold_time_sk, ss_hdemo_sk, ss_store_sk]                                                                                                                                                                                                                                                                                                                                                           |
|               |                 BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                   TableScan: household_demographics projection=[hd_demo_sk], full_filters=[household_demographics.hd_dep_count = Int32(5)]                                                                                                                                                                                                                                                                                                                |
|               |             BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |               TableScan: time_dim projection=[t_time_sk], full_filters=[time_dim.t_hour = Int32(8), time_dim.t_minute >= Int32(30)]                                                                                                                                                                                                                                                                                                                       |
|               |         BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |           TableScan: store projection=[s_store_sk], full_filters=[store.s_store_name = LargeUtf8("ese")]                                                                                                                                                                                                                                                                                                                                                  |
| physical_plan | SortExec: TopK(fetch=100), expr=[count(*)@0 ASC NULLS LAST], preserve_partitioning=[false]                                                                                                                                                                                                                                                                                                                                                                |
|               |   AggregateExec: mode=Final, gby=[], aggr=[count(*)]                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |     CoalescePartitionsExec                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |       AggregateExec: mode=Partial, gby=[], aggr=[count(*)]                                                                                                                                                                                                                                                                                                                                                                                                |
|               |         ProjectionExec: expr=[]                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |             HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_store_sk@0, s_store_sk@0)]                                                                                                                                                                                                                                                                                                                                                           |
|               |               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                 RepartitionExec: partitioning=Hash([ss_store_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                     HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_sold_time_sk@0, t_time_sk@0)], projection=[ss_store_sk@1]                                                                                                                                                                                                                                                                                                                    |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                         RepartitionExec: partitioning=Hash([ss_sold_time_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                    |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                             HashJoinExec: mode=Partitioned, join_type=Inner, on=[(ss_hdemo_sk@1, hd_demo_sk@0)], projection=[ss_sold_time_sk@0, ss_store_sk@2]                                                                                                                                                                                                                                                                                            |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                 RepartitionExec: partitioning=Hash([ss_hdemo_sk@1], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                |
|               |                                   BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                                     ParquetExec: file_groups={4 groups: [[tpcds_sf1/store_sales/store_sales.parquet:0..38551918], [tpcds_sf1/store_sales/store_sales.parquet:38551918..77103836], [tpcds_sf1/store_sales/store_sales.parquet:77103836..115655754], [tpcds_sf1/store_sales/store_sales.parquet:115655754..154207672]]}, projection=[ss_sold_time_sk, ss_hdemo_sk, ss_store_sk]                                                             |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                 RepartitionExec: partitioning=Hash([hd_demo_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                 |
|               |                                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                    |
|               |                                     BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                       ParquetExec: file_groups={1 group: [[tpcds_sf1/household_demographics/household_demographics.parquet]]}, projection=[hd_demo_sk], predicate=hd_dep_count@3 = 5, pruning_predicate=CASE WHEN hd_dep_count_null_count@2 = hd_dep_count_row_count@3 THEN false ELSE hd_dep_count_min@0 <= 5 AND 5 <= hd_dep_count_max@1 END, required_guarantees=[N]                                                 |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                         RepartitionExec: partitioning=Hash([t_time_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                          |
|               |                           RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                            |
|               |                             BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                               ParquetExec: file_groups={1 group: [[tpcds_sf1/time_dim/time_dim.parquet]]}, projection=[t_time_sk], predicate=t_hour@3 = 8 AND t_minute@4 >= 30, pruning_predicate=CASE WHEN t_hour_null_count@2 = t_hour_row_count@3 THEN false ELSE t_hour_min@0 <= 8 AND 8 <= t_hour_max@1 END AND CASE WHEN t_minute_null_count@5 = t_minute_row_count@6 THEN false ELSE t_minute_max@4 >= 30 END, required_guarantees=[N] |
|               |               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                 RepartitionExec: partitioning=Hash([s_store_sk@0], 4), input_partitions=4                                                                                                                                                                                                                                                                                                                                                                 |
|               |                   RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                    |
|               |                     BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                       ParquetExec: file_groups={1 group: [[tpcds_sf1/store/store.parquet]]}, projection=[s_store_sk], predicate=s_store_name@5 = ese, pruning_predicate=CASE WHEN s_store_name_null_count@2 = s_store_name_row_count@3 THEN false ELSE s_store_name_min@0 <= ese AND ese <= s_store_name_max@1 END, required_guarantees=[N]                                                                                           |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
+---------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
